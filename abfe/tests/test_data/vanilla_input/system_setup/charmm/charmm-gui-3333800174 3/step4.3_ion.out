1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.119.1.el7.x86_64(x86_64)      
                 Created on 12/4/24 at 17:54:56 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOBID=3333800174
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOBID=3333800174
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10947): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "468"
 Parameter: NAT <- "468"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "468"
 Parameter: NAT -> "468"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""468"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "468" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "485"
 Parameter: NAT <- "485"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "485"
 Parameter: NAT -> "485"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""485"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "485" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "488"
 Parameter: NAT <- "488"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "488"
 Parameter: NAT -> "488"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""488"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "488" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "554"
 Parameter: NAT <- "554"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "554"
 Parameter: NAT -> "554"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""554"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "554" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., “Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides,” Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "585"
 Parameter: NAT <- "585"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "585"
 Parameter: NAT -> "585"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""585"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "585" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14758): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14779): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  5023): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_oxidized.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_oxidized.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_oxidized.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR OXIDIZED PHOSPHOLIPID
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR OXIDIZED PHOSPHOLIPIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. “Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix” J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. “Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data”
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_pdbreader.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_pdbreader.psf::
 OPNLGU> Unit 10 opened for READONLY access to step1_pdbreader.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOB
 TITLE>  * READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
 TITLE>  *  DATE:    12/ 4/24     13:51:56      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      305
         Number of atoms         =     4833   Number of groups     =     1486
         Number of bonds         =     4892   Number of angles     =     8857
         Number of dihedrals     =    12960   Number of impropers  =      793
         Number of cross-terms   =      303   Number of autogens   =        0
         Number of HB acceptors  =      398   Number of HB donors  =      500
         Number of NB exclusions =        0   Total charge =   11.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CALC TOPAREA = 1091.38288
 TITLE> * CALC BOTAREA = 1220.82615
 TITLE> * CALC XMAX = 24.1553916
 TITLE> * CALC XMIN = -26.2720975
 TITLE> * CALC YMAX = 19.5919037
 TITLE> * CALC YMIN = -19.9713309
 TITLE> * CALC ZMAX = 37.0665964
 TITLE> * CALC ZMIN = -42.966645
 TITLE> *  DATE:    12/ 4/24     13:53: 7      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>   4833 atoms have been selected out of   4833
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 62.3546605
 Parameter: A <- "62.3546605"
  
 CHARMM>     SET B        = 62.3546605
 Parameter: B <- "62.3546605"
  
 CHARMM>     SET C        = 125.033241
 Parameter: C <- "125.033241"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = -2.9500243
 Parameter: ZCEN <- "-2.9500243"
  
 CHARMM>     SET NLIPTOP  = 41
 Parameter: NLIPTOP <- "41"
  
 CHARMM>     SET NLIPBOT  = 39
 Parameter: NLIPBOT <- "39"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 45.466645
 Parameter: WATBOXZ <- "45.466645"
  
 CHARMM>     SET NCHARGE  = 11
 Parameter: NCHARGE <- "11"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:    12/ 4/24     17:54:12      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      385
         Number of atoms         =    15553   Number of groups     =     4206
         Number of bonds         =    15532   Number of angles     =    29337
         Number of dihedrals     =    41440   Number of impropers  =      953
         Number of cross-terms   =      303   Number of autogens   =        0
         Number of HB acceptors  =      398   Number of HB donors  =      500
         Number of NB exclusions =        0   Total charge =   11.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 A RESIDUE OFFSET OF 305 WILL BE USED.
 INFO: A subset of total atoms will be read.

 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:    12/ 4/24     17:54:12      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  15553
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     15553 SELECTED ATOMS:
    XMIN =  -35.349631 XMAX =   37.100444 XAVE =    1.465557
    YMIN =  -35.194714 YMAX =   37.854526 YAVE =    0.101267
    ZMIN =  -43.460900 ZMAX =   37.066596 ZAVE =   -0.812431
    WMIN =    0.000000 WMAX =    0.054616 WAVE =    0.000044
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "37.1004444"
 RDCMND substituted energy or value "?XMIN" to "-35.3496312"
Evaluating: INT((37.1004444--35.3496312+5.0)/0.5)+1
 Parameter: XDIM <- "155"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "37.854526"
 RDCMND substituted energy or value "?YMIN" to "-35.1947142"
Evaluating: INT((37.854526--35.1947142+5.0)/0.5)+1
 Parameter: YDIM <- "157"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "37.0665964"
 RDCMND substituted energy or value "?ZMIN" to "-43.4609"
Evaluating: INT((37.0665964--43.4609+5.0)/0.5)+1
 Parameter: ZDIM <- "172"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "155"
 Parameter: YDIM -> "157"
 Parameter: ZDIM -> "172"
Evaluating: 155*157*172
 Parameter: SPACE <- "4185620"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "4185620" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "4185620"
 SELRPN>  15553 atoms have been selected out of  15553
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -38.0896 XMAX=     39.8404 NX= 155
   YMIN=    -37.9347 YMAX=     40.5945 NY= 156
   ZMIN=    -46.2166 ZMAX=     40.1666 NZ= 172


 A TOTAL OF     9367   VACUUM POINTS WERE FOUND
 A TOTAL OF  1609190 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  2540403 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  4149593 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  204544.860215
 TOTAL SELECTED  VOLUME =  527456.621118
 TOTAL FREE      VOLUME =    1190.643557
 FRACTIONAL FREE VOLUME =       0.578725
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "204544.86"
 Parameter: SYSVOL <- "204544.86"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "62.3546605"
 Parameter: B -> "62.3546605"
 Parameter: C -> "125.033241"
 Parameter: SYSVOL -> "204544.86"
Evaluating: (62.3546605*62.3546605*125.033241)-204544.86
 Parameter: VOLUMN <- "281597.345"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  15553
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  15553
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  15553
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = POT
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "POT"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "11"
Evaluating: INT(11)
 Parameter: NCHARGE <- "11"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "11"
Evaluating: 11
 Parameter: CGTOT <- "11"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "11"
 Parameter: POSCHARGE -> "1"
 Comparing "11" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "11"
 Parameter: NEGCHARGE -> "1"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(11)/1)
 Parameter: NNEG <- "11"
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "11"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "11"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(11+0*1-11*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "11"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "11"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "11"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(11+0*1-11*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "281597.345"
 Parameter: NEGVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*281597.345)*1
 Parameter: NPOS <- "25"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "11"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "281597.345"
 Parameter: POSVAL -> "1"
Evaluating: 11+INT(0.15*6.021*0.0001*281597.345)*1
 Parameter: NNEG <- "36"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "25" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "36" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "25" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "POT"
 Parameter: NPOS -> "25"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   3 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      410
         Number of atoms         =    15578   Number of groups     =     4231
         Number of bonds         =    15532   Number of angles     =    29337
         Number of dihedrals     =    41440   Number of impropers  =      953
         Number of cross-terms   =      303   Number of autogens   =        0
         Number of HB acceptors  =      398   Number of HB donors  =      500
         Number of NB exclusions =        0   Total charge =   36.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     25 atoms have been selected out of  15578
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>     25 atoms have been selected out of  15578
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "36" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "36"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   4 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =      446
         Number of atoms         =    15614   Number of groups     =     4267
         Number of bonds         =    15532   Number of angles     =    29337
         Number of dihedrals     =    41440   Number of impropers  =      953
         Number of cross-terms   =      303   Number of autogens   =        0
         Number of HB acceptors  =      398   Number of HB donors  =      500
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     36 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     36 atoms have been selected out of  15614
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>     61 atoms have been selected out of  15614
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>     61 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "25"
 Parameter: NNEG -> "36"
Evaluating: 25+36
 Parameter: NION <- "61"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "25"
 Parameter: NPOSTOT <- "25"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "36"
 Parameter: NNEGTOT <- "36"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "61"
 Parameter: NIONTOT <- "61"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "61" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "62.3546605"
 Parameter: B -> "62.3546605"
 Parameter: C -> "125.033241"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =   62.35466 B    =   62.35466 C     =  125.03324
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOBID=3333800174
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "-2.9500243"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000 -2.950024
 RESIDUE  382 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  383 OPERATED ON BY TRANSFORMATION N1Z0Z0R1
 RESIDUE  384 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  385 OPERATED ON BY TRANSFORMATION N1N1Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       57.64
    2  N1Z0N1R1 has       0       0       0       51.78
    3  N1P1N1R1 has       0       0       0       55.31
    4  Z0N1N1R1 has       0       0       0       53.58
    5  Z0Z0N1R1 has       0       0       0       44.51
    6  Z0P1N1R1 has       0       0       0       46.86
    7  N1N1Z0R1 has     947     235      10        0.00
    8  N1Z0Z0R1 has    3907     984      56        0.00
    9  N1P1Z0R1 has     615     150       9        0.00
   10  Z0N1Z0R1 has    3560     879      44        0.00
   12  N1N1P1R1 has       0       0       0       48.99
   13  N1Z0P1R1 has       0       0       0       46.25
   14  N1P1P1R1 has       0       0       0       55.90
 Total of24643 atoms and 6515 groups and  565 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  15553 atoms have been selected out of  15614
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "1" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.181501559"
Evaluating: 62.3546605*(0.181501559-0.5)
 Parameter: XPOS <- "-19.8598622"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.223769017"
Evaluating: 62.3546605*(0.223769017-0.5)
 Parameter: YPOS <- "-17.2242892"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.200366554"
Evaluating: 125.033241*(0.200366554-0.5)+-2.9500243
 Parameter: ZPOS <- "-40.4141652"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.4141652" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.8598622"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.8598622-0
 Parameter: XTRAN <- "-19.8598622"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.2242892"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.2242892-0
 Parameter: YTRAN <- "-17.2242892"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.4141652"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.4141652-0
 Parameter: ZTRAN <- "-40.4141652"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.8598622"
 Parameter: YTRAN -> "-17.2242892"
 Parameter: ZTRAN -> "-40.4141652"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -19.859862  -17.224289  -40.414165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.37989266"
Evaluating: 0.37989266*360.0
 Parameter: XPHI <- "136.761358"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127514509"
Evaluating: 0.127514509*360.0
 Parameter: YPHI <- "45.9052232"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137483385"
Evaluating: 0.137483385*360.0
 Parameter: ZPHI <- "49.4940186"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.8598622"
 Parameter: YPOS -> "-17.2242892"
 Parameter: ZPOS -> "-40.4141652"
 Parameter: XPHI -> "136.761358"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.728507    0.685039
    0.000000   -0.685039   -0.728507

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  136.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.8598622"
 Parameter: YPOS -> "-17.2242892"
 Parameter: ZPOS -> "-40.4141652"
 Parameter: YPHI -> "45.9052232"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.695847    0.000000   -0.718190
    0.000000    1.000000    0.000000
    0.718190    0.000000    0.695847

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.8598622"
 Parameter: YPOS -> "-17.2242892"
 Parameter: ZPOS -> "-40.4141652"
 Parameter: ZPHI -> "49.4940186"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.649527    0.760338    0.000000
   -0.760338    0.649527    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.859862 XMAX =  -19.859862 XAVE =  -19.859862
    YMIN =  -17.224289 YMAX =  -17.224289 YAVE =  -17.224289
    ZMIN =  -40.414165 ZMAX =  -40.414165 ZAVE =  -40.414165
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.8598622"
Evaluating: -19.8598622+3.5
 Parameter: XMAX <- "-16.3598622"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.2242892"
Evaluating: -17.2242892+3.5
 Parameter: YMAX <- "-13.7242892"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.4141652"
Evaluating: -40.4141652+3.5
 Parameter: ZMAX <- "-36.9141652"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.8598622"
Evaluating: -19.8598622-3.5
 Parameter: XMIN <- "-23.3598622"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.2242892"
Evaluating: -17.2242892-3.5
 Parameter: YMIN <- "-20.7242892"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.4141652"
Evaluating: -40.4141652-3.5
 Parameter: ZMIN <- "-43.9141652"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.3598622"
 Parameter: XMIN -> "-23.3598622"
 Parameter: YMAX -> "-13.7242892"
 Parameter: YMIN -> "-20.7242892"
 Parameter: ZMAX -> "-36.9141652"
 Parameter: ZMIN -> "-43.9141652"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "2" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "2" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.395477206"
Evaluating: 62.3546605*(0.395477206-0.5)
 Parameter: XPOS <- "-6.51748333"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.254745889"
Evaluating: 62.3546605*(0.254745889-0.5)
 Parameter: YPOS <- "-15.2927368"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.645713616"
Evaluating: 125.033241*(0.645713616-0.5)+-2.9500243
 Parameter: ZPOS <- "15.2690214"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.2690214" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.2690214" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.51748333"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.51748333-0
 Parameter: XTRAN <- "-6.51748333"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.2927368"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.2927368-0
 Parameter: YTRAN <- "-15.2927368"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.2690214"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.2690214-0
 Parameter: ZTRAN <- "15.2690214"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.51748333"
 Parameter: YTRAN -> "-15.2927368"
 Parameter: ZTRAN -> "15.2690214"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -6.517483  -15.292737   15.269021
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612769632"
Evaluating: 0.612769632*360.0
 Parameter: XPHI <- "220.597068"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101519023"
Evaluating: 0.101519023*360.0
 Parameter: YPHI <- "36.5468483"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158744252"
Evaluating: 0.158744252*360.0
 Parameter: ZPHI <- "57.1479307"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.51748333"
 Parameter: YPOS -> "-15.2927368"
 Parameter: ZPOS -> "15.2690214"
 Parameter: XPHI -> "220.597068"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.759305   -0.650735
    0.000000    0.650735   -0.759305

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  139.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.51748333"
 Parameter: YPOS -> "-15.2927368"
 Parameter: ZPOS -> "15.2690214"
 Parameter: YPHI -> "36.5468483"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.803370    0.000000   -0.595480
    0.000000    1.000000    0.000000
    0.595480    0.000000    0.803370

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.51748333"
 Parameter: YPOS -> "-15.2927368"
 Parameter: ZPOS -> "15.2690214"
 Parameter: ZPHI -> "57.1479307"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.542472    0.840074    0.000000
   -0.840074    0.542472    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   57.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.517483 XMAX =   -6.517483 XAVE =   -6.517483
    YMIN =  -15.292737 YMAX =  -15.292737 YAVE =  -15.292737
    ZMIN =   15.269021 ZMAX =   15.269021 ZAVE =   15.269021
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.51748333"
Evaluating: -6.51748333+3.5
 Parameter: XMAX <- "-3.01748333"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.2927368"
Evaluating: -15.2927368+3.5
 Parameter: YMAX <- "-11.7927368"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.2690214"
Evaluating: 15.2690214+3.5
 Parameter: ZMAX <- "18.7690214"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.51748333"
Evaluating: -6.51748333-3.5
 Parameter: XMIN <- "-10.0174833"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.2927368"
Evaluating: -15.2927368-3.5
 Parameter: YMIN <- "-18.7927368"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.2690214"
Evaluating: 15.2690214-3.5
 Parameter: ZMIN <- "11.7690214"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.01748333"
 Parameter: XMIN -> "-10.0174833"
 Parameter: YMAX -> "-11.7927368"
 Parameter: YMIN -> "-18.7927368"
 Parameter: ZMAX -> "18.7690214"
 Parameter: ZMIN -> "11.7690214"
 SELRPN>     23 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      8 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15555 POS      POT      2        POT     -4969 MEMB     POPC     2        C12           3.1558
15555 POS      POT      2        POT     -4980 MEMB     POPC     2        C15           3.4963
15555 POS      POT      2        POT     -4984 MEMB     POPC     2        C11           3.1833
15555 POS      POT      2        POT     -5012 MEMB     POPC     2        C23           3.6433
15555 POS      POT      2        POT     -5015 MEMB     POPC     2        C24           2.7974
15555 POS      POT      2        POT     -5018 MEMB     POPC     2        C25           3.5752
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "2" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.73030306"
Evaluating: 62.3546605*(0.73030306-0.5)
 Parameter: XPOS <- "14.3604691"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.121451142"
Evaluating: 62.3546605*(0.121451142-0.5)
 Parameter: YPOS <- "-23.6042855"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.138119956"
Evaluating: 125.033241*(0.138119956-0.5)+-2.9500243
 Parameter: ZPOS <- "-48.1970591"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.1970591" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.517483 XMAX =   -6.517483 XAVE =   -6.517483
    YMIN =  -15.292737 YMAX =  -15.292737 YAVE =  -15.292737
    ZMIN =   15.269021 ZMAX =   15.269021 ZAVE =   15.269021
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.3604691"
 RDCMND substituted energy or value "?XAVE" to "-6.51748333"
Evaluating: 14.3604691--6.51748333
 Parameter: XTRAN <- "20.8779524"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.6042855"
 RDCMND substituted energy or value "?YAVE" to "-15.2927368"
Evaluating: -23.6042855--15.2927368
 Parameter: YTRAN <- "-8.3115487"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.1970591"
 RDCMND substituted energy or value "?ZAVE" to "15.2690214"
Evaluating: -48.1970591-15.2690214
 Parameter: ZTRAN <- "-63.4660805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.8779524"
 Parameter: YTRAN -> "-8.3115487"
 Parameter: ZTRAN -> "-63.4660805"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    20.877952   -8.311549  -63.466080
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.981342978"
Evaluating: 0.981342978*360.0
 Parameter: XPHI <- "353.283472"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503710355"
Evaluating: 0.503710355*360.0
 Parameter: YPHI <- "181.335728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.775225172"
Evaluating: 0.775225172*360.0
 Parameter: ZPHI <- "279.081062"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.3604691"
 Parameter: YPOS -> "-23.6042855"
 Parameter: ZPOS -> "-48.1970591"
 Parameter: XPHI -> "353.283472"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.993137   -0.116957
    0.000000    0.116957    0.993137

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    6.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.3604691"
 Parameter: YPOS -> "-23.6042855"
 Parameter: ZPOS -> "-48.1970591"
 Parameter: YPHI -> "181.335728"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.999728    0.000000    0.023311
    0.000000    1.000000    0.000000
   -0.023311    0.000000   -0.999728

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  178.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.3604691"
 Parameter: YPOS -> "-23.6042855"
 Parameter: ZPOS -> "-48.1970591"
 Parameter: ZPHI -> "279.081062"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.157832   -0.987466    0.000000
    0.987466    0.157832    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.360469 XMAX =   14.360469 XAVE =   14.360469
    YMIN =  -23.604285 YMAX =  -23.604285 YAVE =  -23.604285
    ZMIN =  -48.197059 ZMAX =  -48.197059 ZAVE =  -48.197059
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.3604691"
Evaluating: 14.3604691+3.5
 Parameter: XMAX <- "17.8604691"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.6042855"
Evaluating: -23.6042855+3.5
 Parameter: YMAX <- "-20.1042855"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.1970591"
Evaluating: -48.1970591+3.5
 Parameter: ZMAX <- "-44.6970591"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.3604691"
Evaluating: 14.3604691-3.5
 Parameter: XMIN <- "10.8604691"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.6042855"
Evaluating: -23.6042855-3.5
 Parameter: YMIN <- "-27.1042855"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.1970591"
Evaluating: -48.1970591-3.5
 Parameter: ZMIN <- "-51.6970591"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.8604691"
 Parameter: XMIN -> "10.8604691"
 Parameter: YMAX -> "-20.1042855"
 Parameter: YMIN -> "-27.1042855"
 Parameter: ZMAX -> "-44.6970591"
 Parameter: ZMIN -> "-51.6970591"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "3" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "3" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.4912837"
Evaluating: 62.3546605*(0.4912837-0.5)
 Parameter: XPOS <- "-0.543501927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.222376244"
Evaluating: 62.3546605*(0.222376244-0.5)
 Parameter: YPOS <- "-17.3111351"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "6.139512207E-02"
Evaluating: 125.033241*(6.139512207E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-57.7902137"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.7902137" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.543501927"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.543501927-0
 Parameter: XTRAN <- "-0.543501927"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.3111351"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.3111351-0
 Parameter: YTRAN <- "-17.3111351"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.7902137"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.7902137-0
 Parameter: ZTRAN <- "-57.7902137"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.543501927"
 Parameter: YTRAN -> "-17.3111351"
 Parameter: ZTRAN -> "-57.7902137"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -0.543502  -17.311135  -57.790214
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.18738869"
Evaluating: 0.18738869*360.0
 Parameter: XPHI <- "67.4599284"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.273121037"
Evaluating: 0.273121037*360.0
 Parameter: YPHI <- "98.3235733"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.922052286"
Evaluating: 0.922052286*360.0
 Parameter: ZPHI <- "331.938823"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.543501927"
 Parameter: YPOS -> "-17.3111351"
 Parameter: ZPOS -> "-57.7902137"
 Parameter: XPHI -> "67.4599284"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.383329    0.923612
    0.000000   -0.923612    0.383329

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   67.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.543501927"
 Parameter: YPOS -> "-17.3111351"
 Parameter: ZPOS -> "-57.7902137"
 Parameter: YPHI -> "98.3235733"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.144763    0.000000   -0.989466
    0.000000    1.000000    0.000000
    0.989466    0.000000   -0.144763

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.543501927"
 Parameter: YPOS -> "-17.3111351"
 Parameter: ZPOS -> "-57.7902137"
 Parameter: ZPHI -> "331.938823"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.882446   -0.470414    0.000000
    0.470414    0.882446    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.543502 XMAX =   -0.543502 XAVE =   -0.543502
    YMIN =  -17.311135 YMAX =  -17.311135 YAVE =  -17.311135
    ZMIN =  -57.790214 ZMAX =  -57.790214 ZAVE =  -57.790214
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.543501927"
Evaluating: -0.543501927+3.5
 Parameter: XMAX <- "2.95649807"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.3111351"
Evaluating: -17.3111351+3.5
 Parameter: YMAX <- "-13.8111351"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.7902137"
Evaluating: -57.7902137+3.5
 Parameter: ZMAX <- "-54.2902137"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.543501927"
Evaluating: -0.543501927-3.5
 Parameter: XMIN <- "-4.04350193"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.3111351"
Evaluating: -17.3111351-3.5
 Parameter: YMIN <- "-20.8111351"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.7902137"
Evaluating: -57.7902137-3.5
 Parameter: ZMIN <- "-61.2902137"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.95649807"
 Parameter: XMIN -> "-4.04350193"
 Parameter: YMAX -> "-13.8111351"
 Parameter: YMIN -> "-20.8111351"
 Parameter: ZMAX -> "-54.2902137"
 Parameter: ZMIN -> "-61.2902137"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "4" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "4" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.163928111"
Evaluating: 62.3546605*(0.163928111-0.5)
 Parameter: XPOS <- "-20.9556485"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.31977668"
Evaluating: 62.3546605*(0.31977668-0.5)
 Parameter: YPOS <- "-11.2377639"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "7.536057461E-02"
Evaluating: 125.033241*(7.536057461E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-56.0440679"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.0440679" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.9556485"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.9556485-0
 Parameter: XTRAN <- "-20.9556485"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.2377639"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.2377639-0
 Parameter: YTRAN <- "-11.2377639"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.0440679"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.0440679-0
 Parameter: ZTRAN <- "-56.0440679"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.9556485"
 Parameter: YTRAN -> "-11.2377639"
 Parameter: ZTRAN -> "-56.0440679"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -20.955648  -11.237764  -56.044068
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380189627"
Evaluating: 0.380189627*360.0
 Parameter: XPHI <- "136.868266"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854869123"
Evaluating: 0.854869123*360.0
 Parameter: YPHI <- "307.752884"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.586953654E-02"
Evaluating: 8.586953654E-02*360.0
 Parameter: ZPHI <- "30.9130332"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.9556485"
 Parameter: YPOS -> "-11.2377639"
 Parameter: ZPOS -> "-56.0440679"
 Parameter: XPHI -> "136.868266"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.729784    0.683678
    0.000000   -0.683678   -0.729784

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  136.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.9556485"
 Parameter: YPOS -> "-11.2377639"
 Parameter: ZPOS -> "-56.0440679"
 Parameter: YPHI -> "307.752884"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.612257    0.000000    0.790659
    0.000000    1.000000    0.000000
   -0.790659    0.000000    0.612257

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   52.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.9556485"
 Parameter: YPOS -> "-11.2377639"
 Parameter: ZPOS -> "-56.0440679"
 Parameter: ZPHI -> "30.9130332"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.857948    0.513736    0.000000
   -0.513736    0.857948    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.955648 XMAX =  -20.955648 XAVE =  -20.955648
    YMIN =  -11.237764 YMAX =  -11.237764 YAVE =  -11.237764
    ZMIN =  -56.044068 ZMAX =  -56.044068 ZAVE =  -56.044068
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.9556485"
Evaluating: -20.9556485+3.5
 Parameter: XMAX <- "-17.4556485"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.2377639"
Evaluating: -11.2377639+3.5
 Parameter: YMAX <- "-7.7377639"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.0440679"
Evaluating: -56.0440679+3.5
 Parameter: ZMAX <- "-52.5440679"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.9556485"
Evaluating: -20.9556485-3.5
 Parameter: XMIN <- "-24.4556485"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.2377639"
Evaluating: -11.2377639-3.5
 Parameter: YMIN <- "-14.7377639"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.0440679"
Evaluating: -56.0440679-3.5
 Parameter: ZMIN <- "-59.5440679"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.4556485"
 Parameter: XMIN -> "-24.4556485"
 Parameter: YMAX -> "-7.7377639"
 Parameter: YMIN -> "-14.7377639"
 Parameter: ZMAX -> "-52.5440679"
 Parameter: ZMIN -> "-59.5440679"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "5" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "5" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.463278836"
Evaluating: 62.3546605*(0.463278836-0.5)
 Parameter: XPOS <- "-2.28973571"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.947726666"
Evaluating: 62.3546605*(0.947726666-0.5)
 Parameter: YPOS <- "27.9178443"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.103917853"
Evaluating: 125.033241*(0.103917853-0.5)+-2.9500243
 Parameter: ZPOS <- "-52.4734588"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.4734588" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.28973571"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.28973571-0
 Parameter: XTRAN <- "-2.28973571"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.9178443"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.9178443-0
 Parameter: YTRAN <- "27.9178443"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.4734588"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.4734588-0
 Parameter: ZTRAN <- "-52.4734588"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.28973571"
 Parameter: YTRAN -> "27.9178443"
 Parameter: ZTRAN -> "-52.4734588"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -2.289736   27.917844  -52.473459
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318388888"
Evaluating: 0.318388888*360.0
 Parameter: XPHI <- "114.62"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755681121"
Evaluating: 0.755681121*360.0
 Parameter: YPHI <- "272.045204"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.417025324"
Evaluating: 0.417025324*360.0
 Parameter: ZPHI <- "150.129117"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.28973571"
 Parameter: YPOS -> "27.9178443"
 Parameter: ZPOS -> "-52.4734588"
 Parameter: XPHI -> "114.62"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.416598    0.909091
    0.000000   -0.909091   -0.416598

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.28973571"
 Parameter: YPOS -> "27.9178443"
 Parameter: ZPOS -> "-52.4734588"
 Parameter: YPHI -> "272.045204"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.035688    0.000000    0.999363
    0.000000    1.000000    0.000000
   -0.999363    0.000000    0.035688

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   87.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.28973571"
 Parameter: YPOS -> "27.9178443"
 Parameter: ZPOS -> "-52.4734588"
 Parameter: ZPHI -> "150.129117"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.867150    0.498047    0.000000
   -0.498047   -0.867150    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.289736 XMAX =   -2.289736 XAVE =   -2.289736
    YMIN =   27.917844 YMAX =   27.917844 YAVE =   27.917844
    ZMIN =  -52.473459 ZMAX =  -52.473459 ZAVE =  -52.473459
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.28973571"
Evaluating: -2.28973571+3.5
 Parameter: XMAX <- "1.21026429"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.9178443"
Evaluating: 27.9178443+3.5
 Parameter: YMAX <- "31.4178443"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.4734588"
Evaluating: -52.4734588+3.5
 Parameter: ZMAX <- "-48.9734588"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.28973571"
Evaluating: -2.28973571-3.5
 Parameter: XMIN <- "-5.78973571"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.9178443"
Evaluating: 27.9178443-3.5
 Parameter: YMIN <- "24.4178443"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.4734588"
Evaluating: -52.4734588-3.5
 Parameter: ZMIN <- "-55.9734588"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.21026429"
 Parameter: XMIN -> "-5.78973571"
 Parameter: YMAX -> "31.4178443"
 Parameter: YMIN -> "24.4178443"
 Parameter: ZMAX -> "-48.9734588"
 Parameter: ZMIN -> "-55.9734588"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "6" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "6" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.294879501"
Evaluating: 62.3546605*(0.294879501-0.5)
 Parameter: XPOS <- "-12.7902191"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.110323209"
Evaluating: 62.3546605*(0.110323209-0.5)
 Parameter: YPOS <- "-24.298164"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.20758843"
Evaluating: 125.033241*(0.20758843-0.5)+-2.9500243
 Parameter: ZPOS <- "-39.5111906"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.5111906" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.7902191"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.7902191-0
 Parameter: XTRAN <- "-12.7902191"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.298164"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.298164-0
 Parameter: YTRAN <- "-24.298164"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.5111906"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.5111906-0
 Parameter: ZTRAN <- "-39.5111906"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.7902191"
 Parameter: YTRAN -> "-24.298164"
 Parameter: ZTRAN -> "-39.5111906"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -12.790219  -24.298164  -39.511191
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898143778"
Evaluating: 0.898143778*360.0
 Parameter: XPHI <- "323.33176"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.053029685E-02"
Evaluating: 1.053029685E-02*360.0
 Parameter: YPHI <- "3.79090687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.580007007"
Evaluating: 0.580007007*360.0
 Parameter: ZPHI <- "208.802523"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.7902191"
 Parameter: YPOS -> "-24.298164"
 Parameter: ZPOS -> "-39.5111906"
 Parameter: XPHI -> "323.33176"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.802107   -0.597181
    0.000000    0.597181    0.802107

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.7902191"
 Parameter: YPOS -> "-24.298164"
 Parameter: ZPOS -> "-39.5111906"
 Parameter: YPHI -> "3.79090687"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.997812    0.000000   -0.066116
    0.000000    1.000000    0.000000
    0.066116    0.000000    0.997812

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    3.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.7902191"
 Parameter: YPOS -> "-24.298164"
 Parameter: ZPOS -> "-39.5111906"
 Parameter: ZPHI -> "208.802523"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.876285   -0.481792    0.000000
    0.481792   -0.876285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  151.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.790219 XMAX =  -12.790219 XAVE =  -12.790219
    YMIN =  -24.298164 YMAX =  -24.298164 YAVE =  -24.298164
    ZMIN =  -39.511191 ZMAX =  -39.511191 ZAVE =  -39.511191
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.7902191"
Evaluating: -12.7902191+3.5
 Parameter: XMAX <- "-9.2902191"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.298164"
Evaluating: -24.298164+3.5
 Parameter: YMAX <- "-20.798164"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.5111906"
Evaluating: -39.5111906+3.5
 Parameter: ZMAX <- "-36.0111906"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.7902191"
Evaluating: -12.7902191-3.5
 Parameter: XMIN <- "-16.2902191"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.298164"
Evaluating: -24.298164-3.5
 Parameter: YMIN <- "-27.798164"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.5111906"
Evaluating: -39.5111906-3.5
 Parameter: ZMIN <- "-43.0111906"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.2902191"
 Parameter: XMIN -> "-16.2902191"
 Parameter: YMAX -> "-20.798164"
 Parameter: YMIN -> "-27.798164"
 Parameter: ZMAX -> "-36.0111906"
 Parameter: ZMIN -> "-43.0111906"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "7" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "7" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "6.013235962E-02"
Evaluating: 62.3546605*(6.013235962E-02-0.5)
 Parameter: XPOS <- "-27.4277974"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.242520653"
Evaluating: 62.3546605*(0.242520653-0.5)
 Parameter: YPOS <- "-16.0550373"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.545875925"
Evaluating: 125.033241*(0.545875925-0.5)+-2.9500243
 Parameter: ZPOS <- "2.78599129"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.78599129" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.78599129" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "7" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.992455887"
Evaluating: 62.3546605*(0.992455887-0.5)
 Parameter: XPOS <- "30.7069196"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.154956672"
Evaluating: 62.3546605*(0.154956672-0.5)
 Parameter: YPOS <- "-21.5150596"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.998250502"
Evaluating: 125.033241*(0.998250502-0.5)+-2.9500243
 Parameter: ZPOS <- "59.3478508"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.3478508" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.3478508" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.7069196"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.7069196-0
 Parameter: XTRAN <- "30.7069196"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.5150596"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.5150596-0
 Parameter: YTRAN <- "-21.5150596"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.3478508"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.3478508-0
 Parameter: ZTRAN <- "59.3478508"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.7069196"
 Parameter: YTRAN -> "-21.5150596"
 Parameter: ZTRAN -> "59.3478508"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    30.706920  -21.515060   59.347851
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.286546477E-02"
Evaluating: 3.286546477E-02*360.0
 Parameter: XPHI <- "11.8315673"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.557067172"
Evaluating: 0.557067172*360.0
 Parameter: YPHI <- "200.544182"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.377661196"
Evaluating: 0.377661196*360.0
 Parameter: ZPHI <- "135.958031"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.7069196"
 Parameter: YPOS -> "-21.5150596"
 Parameter: ZPOS -> "59.3478508"
 Parameter: XPHI -> "11.8315673"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.978755    0.205035
    0.000000   -0.205035    0.978755

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.7069196"
 Parameter: YPOS -> "-21.5150596"
 Parameter: ZPOS -> "59.3478508"
 Parameter: YPHI -> "200.544182"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.936402    0.000000    0.350930
    0.000000    1.000000    0.000000
   -0.350930    0.000000   -0.936402

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  159.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.7069196"
 Parameter: YPOS -> "-21.5150596"
 Parameter: ZPOS -> "59.3478508"
 Parameter: ZPHI -> "135.958031"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.718831    0.695185    0.000000
   -0.695185   -0.718831    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.706920 XMAX =   30.706920 XAVE =   30.706920
    YMIN =  -21.515060 YMAX =  -21.515060 YAVE =  -21.515060
    ZMIN =   59.347851 ZMAX =   59.347851 ZAVE =   59.347851
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.7069196"
Evaluating: 30.7069196+3.5
 Parameter: XMAX <- "34.2069196"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.5150596"
Evaluating: -21.5150596+3.5
 Parameter: YMAX <- "-18.0150596"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.3478508"
Evaluating: 59.3478508+3.5
 Parameter: ZMAX <- "62.8478508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.7069196"
Evaluating: 30.7069196-3.5
 Parameter: XMIN <- "27.2069196"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.5150596"
Evaluating: -21.5150596-3.5
 Parameter: YMIN <- "-25.0150596"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.3478508"
Evaluating: 59.3478508-3.5
 Parameter: ZMIN <- "55.8478508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.2069196"
 Parameter: XMIN -> "27.2069196"
 Parameter: YMAX -> "-18.0150596"
 Parameter: YMIN -> "-25.0150596"
 Parameter: ZMAX -> "62.8478508"
 Parameter: ZMIN -> "55.8478508"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "8" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "8" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.629094502"
Evaluating: 62.3546605*(0.629094502-0.5)
 Parameter: XPOS <- "8.04964384"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.647198961"
Evaluating: 62.3546605*(0.647198961-0.5)
 Parameter: YPOS <- "9.17854124"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.299459084"
Evaluating: 125.033241*(0.299459084-0.5)+-2.9500243
 Parameter: ZPOS <- "-28.024305"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.024305" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.04964384"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.04964384-0
 Parameter: XTRAN <- "8.04964384"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.17854124"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.17854124-0
 Parameter: YTRAN <- "9.17854124"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.024305"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.024305-0
 Parameter: ZTRAN <- "-28.024305"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.04964384"
 Parameter: YTRAN -> "9.17854124"
 Parameter: ZTRAN -> "-28.024305"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     8.049644    9.178541  -28.024305
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.185350795"
Evaluating: 0.185350795*360.0
 Parameter: XPHI <- "66.7262862"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533998671"
Evaluating: 0.533998671*360.0
 Parameter: YPHI <- "192.239522"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201573558"
Evaluating: 0.201573558*360.0
 Parameter: ZPHI <- "72.5664809"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.04964384"
 Parameter: YPOS -> "9.17854124"
 Parameter: ZPOS -> "-28.024305"
 Parameter: XPHI -> "66.7262862"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.395124    0.918628
    0.000000   -0.918628    0.395124

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.04964384"
 Parameter: YPOS -> "9.17854124"
 Parameter: ZPOS -> "-28.024305"
 Parameter: YPHI -> "192.239522"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.977270    0.000000    0.211999
    0.000000    1.000000    0.000000
   -0.211999    0.000000   -0.977270

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.04964384"
 Parameter: YPOS -> "9.17854124"
 Parameter: ZPOS -> "-28.024305"
 Parameter: ZPHI -> "72.5664809"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.299599    0.954065    0.000000
   -0.954065    0.299599    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.049644 XMAX =    8.049644 XAVE =    8.049644
    YMIN =    9.178541 YMAX =    9.178541 YAVE =    9.178541
    ZMIN =  -28.024305 ZMAX =  -28.024305 ZAVE =  -28.024305
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.04964384"
Evaluating: 8.04964384+3.5
 Parameter: XMAX <- "11.5496438"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.17854124"
Evaluating: 9.17854124+3.5
 Parameter: YMAX <- "12.6785412"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.024305"
Evaluating: -28.024305+3.5
 Parameter: ZMAX <- "-24.524305"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.04964384"
Evaluating: 8.04964384-3.5
 Parameter: XMIN <- "4.54964384"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.17854124"
Evaluating: 9.17854124-3.5
 Parameter: YMIN <- "5.67854124"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.024305"
Evaluating: -28.024305-3.5
 Parameter: ZMIN <- "-31.524305"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.5496438"
 Parameter: XMIN -> "4.54964384"
 Parameter: YMAX -> "12.6785412"
 Parameter: YMIN -> "5.67854124"
 Parameter: ZMAX -> "-24.524305"
 Parameter: ZMIN -> "-31.524305"
 SELRPN>     23 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      7 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15561 POS      POT      8        POT     -3211 PROA     LEU      208      CB            2.7857
15561 POS      POT      8        POT     -3214 PROA     LEU      208      CG            2.0797
15561 POS      POT      8        POT     -3216 PROA     LEU      208      CD1           1.2477
15561 POS      POT      8        POT     -3220 PROA     LEU      208      CD2           2.4138
15561 POS      POT      8        POT     -3225 PROA     LEU      208      O             4.7998
15561 POS      POT      8        POT     -3451 PROA     ARG      222      O             5.0370
15561 POS      POT      8        POT     -3503 PROA     GLN      226      CG            3.7016
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "8" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.742501855"
Evaluating: 62.3546605*(0.742501855-0.5)
 Parameter: XPOS <- "15.1211208"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.744318919"
Evaluating: 62.3546605*(0.744318919-0.5)
 Parameter: YPOS <- "15.2344232"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.972813666"
Evaluating: 125.033241*(0.972813666-0.5)+-2.9500243
 Parameter: ZPOS <- "56.1674007"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.1674007" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.1674007" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.049644 XMAX =    8.049644 XAVE =    8.049644
    YMIN =    9.178541 YMAX =    9.178541 YAVE =    9.178541
    ZMIN =  -28.024305 ZMAX =  -28.024305 ZAVE =  -28.024305
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.1211208"
 RDCMND substituted energy or value "?XAVE" to "8.04964384"
Evaluating: 15.1211208-8.04964384
 Parameter: XTRAN <- "7.07147696"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.2344232"
 RDCMND substituted energy or value "?YAVE" to "9.17854124"
Evaluating: 15.2344232-9.17854124
 Parameter: YTRAN <- "6.05588196"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.1674007"
 RDCMND substituted energy or value "?ZAVE" to "-28.024305"
Evaluating: 56.1674007--28.024305
 Parameter: ZTRAN <- "84.1917057"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.07147696"
 Parameter: YTRAN -> "6.05588196"
 Parameter: ZTRAN -> "84.1917057"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     7.071477    6.055882   84.191706
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242891222"
Evaluating: 0.242891222*360.0
 Parameter: XPHI <- "87.4408399"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.72155249"
Evaluating: 0.72155249*360.0
 Parameter: YPHI <- "259.758896"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.915322056E-02"
Evaluating: 4.915322056E-02*360.0
 Parameter: ZPHI <- "17.6951594"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.1211208"
 Parameter: YPOS -> "15.2344232"
 Parameter: ZPOS -> "56.1674007"
 Parameter: XPHI -> "87.4408399"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.044651    0.999003
    0.000000   -0.999003    0.044651

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.1211208"
 Parameter: YPOS -> "15.2344232"
 Parameter: ZPOS -> "56.1674007"
 Parameter: YPHI -> "259.758896"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.177791    0.000000    0.984068
    0.000000    1.000000    0.000000
   -0.984068    0.000000   -0.177791

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.1211208"
 Parameter: YPOS -> "15.2344232"
 Parameter: ZPOS -> "56.1674007"
 Parameter: ZPHI -> "17.6951594"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.952687    0.303953    0.000000
   -0.303953    0.952687    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.121121 XMAX =   15.121121 XAVE =   15.121121
    YMIN =   15.234423 YMAX =   15.234423 YAVE =   15.234423
    ZMIN =   56.167401 ZMAX =   56.167401 ZAVE =   56.167401
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.1211208"
Evaluating: 15.1211208+3.5
 Parameter: XMAX <- "18.6211208"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.2344232"
Evaluating: 15.2344232+3.5
 Parameter: YMAX <- "18.7344232"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.1674007"
Evaluating: 56.1674007+3.5
 Parameter: ZMAX <- "59.6674007"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.1211208"
Evaluating: 15.1211208-3.5
 Parameter: XMIN <- "11.6211208"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.2344232"
Evaluating: 15.2344232-3.5
 Parameter: YMIN <- "11.7344232"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.1674007"
Evaluating: 56.1674007-3.5
 Parameter: ZMIN <- "52.6674007"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.6211208"
 Parameter: XMIN -> "11.6211208"
 Parameter: YMAX -> "18.7344232"
 Parameter: YMIN -> "11.7344232"
 Parameter: ZMAX -> "59.6674007"
 Parameter: ZMIN -> "52.6674007"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "9" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "9" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.40193281"
Evaluating: 62.3546605*(0.40193281-0.5)
 Parameter: XPOS <- "-6.11494634"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.644615552"
Evaluating: 62.3546605*(0.644615552-0.5)
 Parameter: YPOS <- "9.01745365"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.609621219"
Evaluating: 125.033241*(0.609621219-0.5)+-2.9500243
 Parameter: ZPOS <- "10.756272"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.756272" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.756272" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "9" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.931995454"
Evaluating: 62.3546605*(0.931995454-0.5)
 Parameter: XPOS <- "26.9369299"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.984681091"
Evaluating: 62.3546605*(0.984681091-0.5)
 Parameter: YPOS <- "30.2221249"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.666555349"
Evaluating: 125.033241*(0.666555349-0.5)+-2.9500243
 Parameter: ZPOS <- "17.8749308"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.8749308" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.8749308" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.9369299"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.9369299-0
 Parameter: XTRAN <- "26.9369299"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.2221249"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.2221249-0
 Parameter: YTRAN <- "30.2221249"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.8749308"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.8749308-0
 Parameter: ZTRAN <- "17.8749308"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.9369299"
 Parameter: YTRAN -> "30.2221249"
 Parameter: ZTRAN -> "17.8749308"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    26.936930   30.222125   17.874931
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383926124"
Evaluating: 0.383926124*360.0
 Parameter: XPHI <- "138.213405"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.55785792"
Evaluating: 0.55785792*360.0
 Parameter: YPHI <- "200.828851"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460389507"
Evaluating: 0.460389507*360.0
 Parameter: ZPHI <- "165.740223"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.9369299"
 Parameter: YPOS -> "30.2221249"
 Parameter: ZPOS -> "17.8749308"
 Parameter: XPHI -> "138.213405"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.745632    0.666358
    0.000000   -0.666358   -0.745632

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.9369299"
 Parameter: YPOS -> "30.2221249"
 Parameter: ZPOS -> "17.8749308"
 Parameter: YPHI -> "200.828851"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.934647    0.000000    0.355578
    0.000000    1.000000    0.000000
   -0.355578    0.000000   -0.934647

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  159.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.9369299"
 Parameter: YPOS -> "30.2221249"
 Parameter: ZPOS -> "17.8749308"
 Parameter: ZPHI -> "165.740223"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.969189    0.246319    0.000000
   -0.246319   -0.969189    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.936930 XMAX =   26.936930 XAVE =   26.936930
    YMIN =   30.222125 YMAX =   30.222125 YAVE =   30.222125
    ZMIN =   17.874931 ZMAX =   17.874931 ZAVE =   17.874931
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.9369299"
Evaluating: 26.9369299+3.5
 Parameter: XMAX <- "30.4369299"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.2221249"
Evaluating: 30.2221249+3.5
 Parameter: YMAX <- "33.7221249"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.8749308"
Evaluating: 17.8749308+3.5
 Parameter: ZMAX <- "21.3749308"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.9369299"
Evaluating: 26.9369299-3.5
 Parameter: XMIN <- "23.4369299"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.2221249"
Evaluating: 30.2221249-3.5
 Parameter: YMIN <- "26.7221249"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.8749308"
Evaluating: 17.8749308-3.5
 Parameter: ZMIN <- "14.3749308"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.4369299"
 Parameter: XMIN -> "23.4369299"
 Parameter: YMAX -> "33.7221249"
 Parameter: YMIN -> "26.7221249"
 Parameter: ZMAX -> "21.3749308"
 Parameter: ZMIN -> "14.3749308"
 SELRPN>      4 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      2 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15562 POS      POT      9        POT     -9276 MEMB     POPC     34       O13           2.7546
15562 POS      POT      9        POT     -9947 MEMB     POPC     39       O14           3.6061
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "9" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.317943857"
Evaluating: 62.3546605*(0.317943857-0.5)
 Parameter: XPOS <- "-11.352049"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.150569136"
Evaluating: 62.3546605*(0.150569136-0.5)
 Parameter: YPOS <- "-21.7886429"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "1.250690001E-02"
Evaluating: 125.033241*(1.250690001E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-63.9028666"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-63.9028666" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.936930 XMAX =   26.936930 XAVE =   26.936930
    YMIN =   30.222125 YMAX =   30.222125 YAVE =   30.222125
    ZMIN =   17.874931 ZMAX =   17.874931 ZAVE =   17.874931
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.352049"
 RDCMND substituted energy or value "?XAVE" to "26.9369299"
Evaluating: -11.352049-26.9369299
 Parameter: XTRAN <- "-38.2889789"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.7886429"
 RDCMND substituted energy or value "?YAVE" to "30.2221249"
Evaluating: -21.7886429-30.2221249
 Parameter: YTRAN <- "-52.0107678"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.9028666"
 RDCMND substituted energy or value "?ZAVE" to "17.8749308"
Evaluating: -63.9028666-17.8749308
 Parameter: ZTRAN <- "-81.7777974"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.2889789"
 Parameter: YTRAN -> "-52.0107678"
 Parameter: ZTRAN -> "-81.7777974"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -38.288979  -52.010768  -81.777797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.754371518"
Evaluating: 0.754371518*360.0
 Parameter: XPHI <- "271.573746"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.088239789E-02"
Evaluating: 6.088239789E-02*360.0
 Parameter: YPHI <- "21.9176632"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193589454"
Evaluating: 0.193589454*360.0
 Parameter: ZPHI <- "69.6922034"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.352049"
 Parameter: YPOS -> "-21.7886429"
 Parameter: ZPOS -> "-63.9028666"
 Parameter: XPHI -> "271.573746"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.027464   -0.999623
    0.000000    0.999623    0.027464

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   88.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.352049"
 Parameter: YPOS -> "-21.7886429"
 Parameter: ZPOS -> "-63.9028666"
 Parameter: YPHI -> "21.9176632"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.927721    0.000000   -0.373274
    0.000000    1.000000    0.000000
    0.373274    0.000000    0.927721

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.352049"
 Parameter: YPOS -> "-21.7886429"
 Parameter: ZPOS -> "-63.9028666"
 Parameter: ZPHI -> "69.6922034"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.347063    0.937842    0.000000
   -0.937842    0.347063    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.352049 XMAX =  -11.352049 XAVE =  -11.352049
    YMIN =  -21.788643 YMAX =  -21.788643 YAVE =  -21.788643
    ZMIN =  -63.902867 ZMAX =  -63.902867 ZAVE =  -63.902867
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.352049"
Evaluating: -11.352049+3.5
 Parameter: XMAX <- "-7.852049"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.7886429"
Evaluating: -21.7886429+3.5
 Parameter: YMAX <- "-18.2886429"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.9028666"
Evaluating: -63.9028666+3.5
 Parameter: ZMAX <- "-60.4028666"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.352049"
Evaluating: -11.352049-3.5
 Parameter: XMIN <- "-14.852049"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.7886429"
Evaluating: -21.7886429-3.5
 Parameter: YMIN <- "-25.2886429"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.9028666"
Evaluating: -63.9028666-3.5
 Parameter: ZMIN <- "-67.4028666"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.852049"
 Parameter: XMIN -> "-14.852049"
 Parameter: YMAX -> "-18.2886429"
 Parameter: YMIN -> "-25.2886429"
 Parameter: ZMAX -> "-60.4028666"
 Parameter: ZMIN -> "-67.4028666"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "10" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "10" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.840666953"
Evaluating: 62.3546605*(0.840666953-0.5)
 Parameter: XPOS <- "21.2421722"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.131841275"
Evaluating: 62.3546605*(0.131841275-0.5)
 Parameter: YPOS <- "-22.9564123"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.919859057"
Evaluating: 125.033241*(0.919859057-0.5)+-2.9500243
 Parameter: ZPOS <- "49.5463144"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.5463144" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.5463144" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.2421722"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.2421722-0
 Parameter: XTRAN <- "21.2421722"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.9564123"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.9564123-0
 Parameter: YTRAN <- "-22.9564123"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.5463144"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.5463144-0
 Parameter: ZTRAN <- "49.5463144"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.2421722"
 Parameter: YTRAN -> "-22.9564123"
 Parameter: ZTRAN -> "49.5463144"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    21.242172  -22.956412   49.546314
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903650414"
Evaluating: 0.903650414*360.0
 Parameter: XPHI <- "325.314149"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97926483"
Evaluating: 0.97926483*360.0
 Parameter: YPHI <- "352.535339"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257041424"
Evaluating: 0.257041424*360.0
 Parameter: ZPHI <- "92.5349126"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.2421722"
 Parameter: YPOS -> "-22.9564123"
 Parameter: ZPOS -> "49.5463144"
 Parameter: XPHI -> "325.314149"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.822285   -0.569076
    0.000000    0.569076    0.822285

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.2421722"
 Parameter: YPOS -> "-22.9564123"
 Parameter: ZPOS -> "49.5463144"
 Parameter: YPHI -> "352.535339"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.991525    0.000000    0.129915
    0.000000    1.000000    0.000000
   -0.129915    0.000000    0.991525

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.2421722"
 Parameter: YPOS -> "-22.9564123"
 Parameter: ZPOS -> "49.5463144"
 Parameter: ZPHI -> "92.5349126"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.044228    0.999021    0.000000
   -0.999021   -0.044228    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.242172 XMAX =   21.242172 XAVE =   21.242172
    YMIN =  -22.956412 YMAX =  -22.956412 YAVE =  -22.956412
    ZMIN =   49.546314 ZMAX =   49.546314 ZAVE =   49.546314
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.2421722"
Evaluating: 21.2421722+3.5
 Parameter: XMAX <- "24.7421722"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.9564123"
Evaluating: -22.9564123+3.5
 Parameter: YMAX <- "-19.4564123"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.5463144"
Evaluating: 49.5463144+3.5
 Parameter: ZMAX <- "53.0463144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.2421722"
Evaluating: 21.2421722-3.5
 Parameter: XMIN <- "17.7421722"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.9564123"
Evaluating: -22.9564123-3.5
 Parameter: YMIN <- "-26.4564123"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.5463144"
Evaluating: 49.5463144-3.5
 Parameter: ZMIN <- "46.0463144"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.7421722"
 Parameter: XMIN -> "17.7421722"
 Parameter: YMAX -> "-19.4564123"
 Parameter: YMIN -> "-26.4564123"
 Parameter: ZMAX -> "53.0463144"
 Parameter: ZMIN -> "46.0463144"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "11" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "11" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.927782871"
Evaluating: 62.3546605*(0.927782871-0.5)
 Parameter: XPOS <- "26.6742557"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.945247501"
Evaluating: 62.3546605*(0.945247501-0.5)
 Parameter: YPOS <- "27.7632568"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.537502639"
Evaluating: 125.033241*(0.537502639-0.5)+-2.9500243
 Parameter: ZPOS <- "1.7390522"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.7390522" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.7390522" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "11" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.618696442"
Evaluating: 62.3546605*(0.618696442-0.5)
 Parameter: XPOS <- "7.40127634"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.807129686"
Evaluating: 62.3546605*(0.807129686-0.5)
 Parameter: YPOS <- "19.1509673"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.792811175"
Evaluating: 125.033241*(0.792811175-0.5)+-2.9500243
 Parameter: ZPOS <- "33.6611059"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.6611059" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.6611059" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.40127634"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.40127634-0
 Parameter: XTRAN <- "7.40127634"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.1509673"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.1509673-0
 Parameter: YTRAN <- "19.1509673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.6611059"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.6611059-0
 Parameter: ZTRAN <- "33.6611059"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.40127634"
 Parameter: YTRAN -> "19.1509673"
 Parameter: ZTRAN -> "33.6611059"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     7.401276   19.150967   33.661106
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59261367"
Evaluating: 0.59261367*360.0
 Parameter: XPHI <- "213.340921"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.434321132"
Evaluating: 0.434321132*360.0
 Parameter: YPHI <- "156.355608"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.804994152"
Evaluating: 0.804994152*360.0
 Parameter: ZPHI <- "289.797895"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.40127634"
 Parameter: YPOS -> "19.1509673"
 Parameter: ZPOS -> "33.6611059"
 Parameter: XPHI -> "213.340921"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.835415   -0.549620
    0.000000    0.549620   -0.835415

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  146.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.40127634"
 Parameter: YPOS -> "19.1509673"
 Parameter: ZPOS -> "33.6611059"
 Parameter: YPHI -> "156.355608"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.916052    0.000000   -0.401059
    0.000000    1.000000    0.000000
    0.401059    0.000000   -0.916052

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.40127634"
 Parameter: YPOS -> "19.1509673"
 Parameter: ZPOS -> "33.6611059"
 Parameter: ZPHI -> "289.797895"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.338703   -0.940893    0.000000
    0.940893    0.338703    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.401276 XMAX =    7.401276 XAVE =    7.401276
    YMIN =   19.150967 YMAX =   19.150967 YAVE =   19.150967
    ZMIN =   33.661106 ZMAX =   33.661106 ZAVE =   33.661106
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.40127634"
Evaluating: 7.40127634+3.5
 Parameter: XMAX <- "10.9012763"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.1509673"
Evaluating: 19.1509673+3.5
 Parameter: YMAX <- "22.6509673"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.6611059"
Evaluating: 33.6611059+3.5
 Parameter: ZMAX <- "37.1611059"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.40127634"
Evaluating: 7.40127634-3.5
 Parameter: XMIN <- "3.90127634"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.1509673"
Evaluating: 19.1509673-3.5
 Parameter: YMIN <- "15.6509673"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.6611059"
Evaluating: 33.6611059-3.5
 Parameter: ZMIN <- "30.1611059"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.9012763"
 Parameter: XMIN -> "3.90127634"
 Parameter: YMAX -> "22.6509673"
 Parameter: YMIN -> "15.6509673"
 Parameter: ZMAX -> "37.1611059"
 Parameter: ZMIN -> "30.1611059"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "12" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "12" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.372835393"
Evaluating: 62.3546605*(0.372835393-0.5)
 Parameter: XPOS <- "-7.9293059"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.276898683"
Evaluating: 62.3546605*(0.276898683-0.5)
 Parameter: YPOS <- "-13.9114069"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.125941772"
Evaluating: 125.033241*(0.125941772-0.5)+-2.9500243
 Parameter: ZPOS <- "-49.7197369"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.7197369" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.9293059"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.9293059-0
 Parameter: XTRAN <- "-7.9293059"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.9114069"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.9114069-0
 Parameter: YTRAN <- "-13.9114069"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.7197369"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -49.7197369-0
 Parameter: ZTRAN <- "-49.7197369"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.9293059"
 Parameter: YTRAN -> "-13.9114069"
 Parameter: ZTRAN -> "-49.7197369"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -7.929306  -13.911407  -49.719737
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393446436"
Evaluating: 0.393446436*360.0
 Parameter: XPHI <- "141.640717"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223933575"
Evaluating: 0.223933575*360.0
 Parameter: YPHI <- "80.616087"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127807905"
Evaluating: 0.127807905*360.0
 Parameter: ZPHI <- "46.0108458"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.9293059"
 Parameter: YPOS -> "-13.9114069"
 Parameter: ZPOS -> "-49.7197369"
 Parameter: XPHI -> "141.640717"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.784135    0.620591
    0.000000   -0.620591   -0.784135

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.9293059"
 Parameter: YPOS -> "-13.9114069"
 Parameter: ZPOS -> "-49.7197369"
 Parameter: YPHI -> "80.616087"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.163049    0.000000   -0.986618
    0.000000    1.000000    0.000000
    0.986618    0.000000    0.163049

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.9293059"
 Parameter: YPOS -> "-13.9114069"
 Parameter: ZPOS -> "-49.7197369"
 Parameter: ZPHI -> "46.0108458"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.694522    0.719471    0.000000
   -0.719471    0.694522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.929306 XMAX =   -7.929306 XAVE =   -7.929306
    YMIN =  -13.911407 YMAX =  -13.911407 YAVE =  -13.911407
    ZMIN =  -49.719737 ZMAX =  -49.719737 ZAVE =  -49.719737
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.9293059"
Evaluating: -7.9293059+3.5
 Parameter: XMAX <- "-4.4293059"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.9114069"
Evaluating: -13.9114069+3.5
 Parameter: YMAX <- "-10.4114069"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.7197369"
Evaluating: -49.7197369+3.5
 Parameter: ZMAX <- "-46.2197369"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.9293059"
Evaluating: -7.9293059-3.5
 Parameter: XMIN <- "-11.4293059"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.9114069"
Evaluating: -13.9114069-3.5
 Parameter: YMIN <- "-17.4114069"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.7197369"
Evaluating: -49.7197369-3.5
 Parameter: ZMIN <- "-53.2197369"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.4293059"
 Parameter: XMIN -> "-11.4293059"
 Parameter: YMAX -> "-10.4114069"
 Parameter: YMIN -> "-17.4114069"
 Parameter: ZMAX -> "-46.2197369"
 Parameter: ZMIN -> "-53.2197369"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "13" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "13" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.953846562"
Evaluating: 62.3546605*(0.953846562-0.5)
 Parameter: XPOS <- "28.2994483"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.61425421"
Evaluating: 62.3546605*(0.61425421-0.5)
 Parameter: YPOS <- "7.12428248"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.118199288"
Evaluating: 125.033241*(0.118199288-0.5)+-2.9500243
 Parameter: ZPOS <- "-50.6878047"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.6878047" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.2994483"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.2994483-0
 Parameter: XTRAN <- "28.2994483"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.12428248"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.12428248-0
 Parameter: YTRAN <- "7.12428248"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.6878047"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.6878047-0
 Parameter: ZTRAN <- "-50.6878047"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.2994483"
 Parameter: YTRAN -> "7.12428248"
 Parameter: ZTRAN -> "-50.6878047"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    28.299448    7.124282  -50.687805
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.953742945"
Evaluating: 0.953742945*360.0
 Parameter: XPHI <- "343.34746"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793534029"
Evaluating: 0.793534029*360.0
 Parameter: YPHI <- "285.67225"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950134492"
Evaluating: 0.950134492*360.0
 Parameter: ZPHI <- "342.048417"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.2994483"
 Parameter: YPOS -> "7.12428248"
 Parameter: ZPOS -> "-50.6878047"
 Parameter: XPHI -> "343.34746"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.958060   -0.286567
    0.000000    0.286567    0.958060

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.2994483"
 Parameter: YPOS -> "7.12428248"
 Parameter: ZPOS -> "-50.6878047"
 Parameter: YPHI -> "285.67225"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.270134    0.000000    0.962823
    0.000000    1.000000    0.000000
   -0.962823    0.000000    0.270134

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.2994483"
 Parameter: YPOS -> "7.12428248"
 Parameter: ZPOS -> "-50.6878047"
 Parameter: ZPHI -> "342.048417"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.951317   -0.308213    0.000000
    0.308213    0.951317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.299448 XMAX =   28.299448 XAVE =   28.299448
    YMIN =    7.124282 YMAX =    7.124282 YAVE =    7.124282
    ZMIN =  -50.687805 ZMAX =  -50.687805 ZAVE =  -50.687805
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.2994483"
Evaluating: 28.2994483+3.5
 Parameter: XMAX <- "31.7994483"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.12428248"
Evaluating: 7.12428248+3.5
 Parameter: YMAX <- "10.6242825"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.6878047"
Evaluating: -50.6878047+3.5
 Parameter: ZMAX <- "-47.1878047"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.2994483"
Evaluating: 28.2994483-3.5
 Parameter: XMIN <- "24.7994483"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.12428248"
Evaluating: 7.12428248-3.5
 Parameter: YMIN <- "3.62428248"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.6878047"
Evaluating: -50.6878047-3.5
 Parameter: ZMIN <- "-54.1878047"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.7994483"
 Parameter: XMIN -> "24.7994483"
 Parameter: YMAX -> "10.6242825"
 Parameter: YMIN -> "3.62428248"
 Parameter: ZMAX -> "-47.1878047"
 Parameter: ZMIN -> "-54.1878047"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "14" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "14" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.292051357"
Evaluating: 62.3546605*(0.292051357-0.5)
 Parameter: XPOS <- "-12.966567"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.532182246"
Evaluating: 62.3546605*(0.532182246-0.5)
 Parameter: YPOS <- "2.00671302"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.534771679"
Evaluating: 125.033241*(0.534771679-0.5)+-2.9500243
 Parameter: ZPOS <- "1.39759142"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.39759142" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.39759142" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "14" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.827244234"
Evaluating: 62.3546605*(0.827244234-0.5)
 Parameter: XPOS <- "20.4052031"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "3.693414014E-03"
Evaluating: 62.3546605*(3.693414014E-03-0.5)
 Parameter: YPOS <- "-30.9470287"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.757244504"
Evaluating: 125.033241*(0.757244504-0.5)+-2.9500243
 Parameter: ZPOS <- "29.2140898"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.2140898" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.2140898" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.4052031"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.4052031-0
 Parameter: XTRAN <- "20.4052031"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.9470287"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.9470287-0
 Parameter: YTRAN <- "-30.9470287"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.2140898"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.2140898-0
 Parameter: ZTRAN <- "29.2140898"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.4052031"
 Parameter: YTRAN -> "-30.9470287"
 Parameter: ZTRAN -> "29.2140898"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    20.405203  -30.947029   29.214090
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190542246"
Evaluating: 0.190542246*360.0
 Parameter: XPHI <- "68.5952086"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748998375"
Evaluating: 0.748998375*360.0
 Parameter: YPHI <- "269.639415"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923975243"
Evaluating: 0.923975243*360.0
 Parameter: ZPHI <- "332.631087"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.4052031"
 Parameter: YPOS -> "-30.9470287"
 Parameter: ZPOS -> "29.2140898"
 Parameter: XPHI -> "68.5952086"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.364955    0.931025
    0.000000   -0.931025    0.364955

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.4052031"
 Parameter: YPOS -> "-30.9470287"
 Parameter: ZPOS -> "29.2140898"
 Parameter: YPHI -> "269.639415"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.006293    0.000000    0.999980
    0.000000    1.000000    0.000000
   -0.999980    0.000000   -0.006293

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   90.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.4052031"
 Parameter: YPOS -> "-30.9470287"
 Parameter: ZPOS -> "29.2140898"
 Parameter: ZPHI -> "332.631087"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.888065   -0.459718    0.000000
    0.459718    0.888065    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   27.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.405203 XMAX =   20.405203 XAVE =   20.405203
    YMIN =  -30.947029 YMAX =  -30.947029 YAVE =  -30.947029
    ZMIN =   29.214090 ZMAX =   29.214090 ZAVE =   29.214090
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.4052031"
Evaluating: 20.4052031+3.5
 Parameter: XMAX <- "23.9052031"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.9470287"
Evaluating: -30.9470287+3.5
 Parameter: YMAX <- "-27.4470287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.2140898"
Evaluating: 29.2140898+3.5
 Parameter: ZMAX <- "32.7140898"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.4052031"
Evaluating: 20.4052031-3.5
 Parameter: XMIN <- "16.9052031"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.9470287"
Evaluating: -30.9470287-3.5
 Parameter: YMIN <- "-34.4470287"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.2140898"
Evaluating: 29.2140898-3.5
 Parameter: ZMIN <- "25.7140898"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.9052031"
 Parameter: XMIN -> "16.9052031"
 Parameter: YMAX -> "-27.4470287"
 Parameter: YMIN -> "-34.4470287"
 Parameter: ZMAX -> "32.7140898"
 Parameter: ZMIN -> "25.7140898"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "15" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "15" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.993030522"
Evaluating: 62.3546605*(0.993030522-0.5)
 Parameter: XPOS <- "30.7427508"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.123745495"
Evaluating: 62.3546605*(0.123745495-0.5)
 Parameter: YPOS <- "-23.4612219"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.265086543"
Evaluating: 125.033241*(0.265086543-0.5)+-2.9500243
 Parameter: ZPOS <- "-32.3220152"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.3220152" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.7427508"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.7427508-0
 Parameter: XTRAN <- "30.7427508"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.4612219"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.4612219-0
 Parameter: YTRAN <- "-23.4612219"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.3220152"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.3220152-0
 Parameter: ZTRAN <- "-32.3220152"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.7427508"
 Parameter: YTRAN -> "-23.4612219"
 Parameter: ZTRAN -> "-32.3220152"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    30.742751  -23.461222  -32.322015
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666448258"
Evaluating: 0.666448258*360.0
 Parameter: XPHI <- "239.921373"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.40583989"
Evaluating: 0.40583989*360.0
 Parameter: YPHI <- "146.10236"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491774649"
Evaluating: 0.491774649*360.0
 Parameter: ZPHI <- "177.038874"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.7427508"
 Parameter: YPOS -> "-23.4612219"
 Parameter: ZPOS -> "-32.3220152"
 Parameter: XPHI -> "239.921373"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.501188   -0.865338
    0.000000    0.865338   -0.501188

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  120.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.7427508"
 Parameter: YPOS -> "-23.4612219"
 Parameter: ZPOS -> "-32.3220152"
 Parameter: YPHI -> "146.10236"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.830035    0.000000   -0.557711
    0.000000    1.000000    0.000000
    0.557711    0.000000   -0.830035

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.7427508"
 Parameter: YPOS -> "-23.4612219"
 Parameter: ZPOS -> "-32.3220152"
 Parameter: ZPHI -> "177.038874"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.998665    0.051658    0.000000
   -0.051658   -0.998665    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  177.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.742751 XMAX =   30.742751 XAVE =   30.742751
    YMIN =  -23.461222 YMAX =  -23.461222 YAVE =  -23.461222
    ZMIN =  -32.322015 ZMAX =  -32.322015 ZAVE =  -32.322015
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.7427508"
Evaluating: 30.7427508+3.5
 Parameter: XMAX <- "34.2427508"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.4612219"
Evaluating: -23.4612219+3.5
 Parameter: YMAX <- "-19.9612219"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.3220152"
Evaluating: -32.3220152+3.5
 Parameter: ZMAX <- "-28.8220152"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.7427508"
Evaluating: 30.7427508-3.5
 Parameter: XMIN <- "27.2427508"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.4612219"
Evaluating: -23.4612219-3.5
 Parameter: YMIN <- "-26.9612219"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.3220152"
Evaluating: -32.3220152-3.5
 Parameter: ZMIN <- "-35.8220152"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.2427508"
 Parameter: XMIN -> "27.2427508"
 Parameter: YMAX -> "-19.9612219"
 Parameter: YMIN -> "-26.9612219"
 Parameter: ZMAX -> "-28.8220152"
 Parameter: ZMIN -> "-35.8220152"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "16" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "16" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.989017312"
Evaluating: 62.3546605*(0.989017312-0.5)
 Parameter: XPOS <- "30.4925085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.616308305"
Evaluating: 62.3546605*(0.616308305-0.5)
 Parameter: YPOS <- "7.25236487"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.440514762"
Evaluating: 125.033241*(0.440514762-0.5)+-2.9500243
 Parameter: ZPOS <- "-10.3876564"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.3876564" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.3876564" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "16" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.448928549"
Evaluating: 62.3546605*(0.448928549-0.5)
 Parameter: XPOS <- "-3.18454299"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.385788408"
Evaluating: 62.3546605*(0.385788408-0.5)
 Parameter: YPOS <- "-7.12162504"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.323814613"
Evaluating: 125.033241*(0.323814613-0.5)+-2.9500243
 Parameter: ZPOS <- "-24.9790543"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.9790543" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.18454299"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.18454299-0
 Parameter: XTRAN <- "-3.18454299"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.12162504"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.12162504-0
 Parameter: YTRAN <- "-7.12162504"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.9790543"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.9790543-0
 Parameter: ZTRAN <- "-24.9790543"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.18454299"
 Parameter: YTRAN -> "-7.12162504"
 Parameter: ZTRAN -> "-24.9790543"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -3.184543   -7.121625  -24.979054
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.715326466"
Evaluating: 0.715326466*360.0
 Parameter: XPHI <- "257.517528"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.319894785"
Evaluating: 0.319894785*360.0
 Parameter: YPHI <- "115.162123"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.651246245"
Evaluating: 0.651246245*360.0
 Parameter: ZPHI <- "234.448648"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.18454299"
 Parameter: YPOS -> "-7.12162504"
 Parameter: ZPOS -> "-24.9790543"
 Parameter: XPHI -> "257.517528"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.216141   -0.976362
    0.000000    0.976362   -0.216141

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  102.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.18454299"
 Parameter: YPOS -> "-7.12162504"
 Parameter: ZPOS -> "-24.9790543"
 Parameter: YPHI -> "115.162123"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.425181    0.000000   -0.905108
    0.000000    1.000000    0.000000
    0.905108    0.000000   -0.425181

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.18454299"
 Parameter: YPOS -> "-7.12162504"
 Parameter: ZPOS -> "-24.9790543"
 Parameter: ZPHI -> "234.448648"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.581432   -0.813595    0.000000
    0.813595   -0.581432    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.184543 XMAX =   -3.184543 XAVE =   -3.184543
    YMIN =   -7.121625 YMAX =   -7.121625 YAVE =   -7.121625
    ZMIN =  -24.979054 ZMAX =  -24.979054 ZAVE =  -24.979054
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.18454299"
Evaluating: -3.18454299+3.5
 Parameter: XMAX <- "0.31545701"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.12162504"
Evaluating: -7.12162504+3.5
 Parameter: YMAX <- "-3.62162504"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.9790543"
Evaluating: -24.9790543+3.5
 Parameter: ZMAX <- "-21.4790543"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.18454299"
Evaluating: -3.18454299-3.5
 Parameter: XMIN <- "-6.68454299"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.12162504"
Evaluating: -7.12162504-3.5
 Parameter: YMIN <- "-10.621625"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.9790543"
Evaluating: -24.9790543-3.5
 Parameter: ZMIN <- "-28.4790543"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.31545701"
 Parameter: XMIN -> "-6.68454299"
 Parameter: YMAX -> "-3.62162504"
 Parameter: YMIN -> "-10.621625"
 Parameter: ZMAX -> "-21.4790543"
 Parameter: ZMIN -> "-28.4790543"
 SELRPN>     14 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      6 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15569 POS      POT      16       POT     - 541 PROA     SER      35       O             3.8174
15569 POS      POT      16       POT     - 544 PROA     ASN      36       CA            3.5350
15569 POS      POT      16       POT     - 554 PROA     ASN      36       C             3.4018
15569 POS      POT      16       POT     - 555 PROA     ASN      36       O             2.9086
15569 POS      POT      16       POT     - 596 PROA     ASN      39       CB            3.3694
15569 POS      POT      16       POT     - 601 PROA     ASN      39       ND2           3.5868
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "16" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.358802992"
Evaluating: 62.3546605*(0.358802992-0.5)
 Parameter: XPOS <- "-8.8042915"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.487993116"
Evaluating: 62.3546605*(0.487993116-0.5)
 Parameter: YPOS <- "-0.748685175"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.289053862"
Evaluating: 125.033241*(0.289053862-0.5)+-2.9500243
 Parameter: ZPOS <- "-29.3253036"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.3253036" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.184543 XMAX =   -3.184543 XAVE =   -3.184543
    YMIN =   -7.121625 YMAX =   -7.121625 YAVE =   -7.121625
    ZMIN =  -24.979054 ZMAX =  -24.979054 ZAVE =  -24.979054
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.8042915"
 RDCMND substituted energy or value "?XAVE" to "-3.18454299"
Evaluating: -8.8042915--3.18454299
 Parameter: XTRAN <- "-5.61974851"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.748685175"
 RDCMND substituted energy or value "?YAVE" to "-7.12162504"
Evaluating: -0.748685175--7.12162504
 Parameter: YTRAN <- "6.37293986"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.3253036"
 RDCMND substituted energy or value "?ZAVE" to "-24.9790543"
Evaluating: -29.3253036--24.9790543
 Parameter: ZTRAN <- "-4.3462493"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.61974851"
 Parameter: YTRAN -> "6.37293986"
 Parameter: ZTRAN -> "-4.3462493"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -5.619749    6.372940   -4.346249
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766649324"
Evaluating: 0.766649324*360.0
 Parameter: XPHI <- "275.993757"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369778332"
Evaluating: 0.369778332*360.0
 Parameter: YPHI <- "133.1202"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.298596524"
Evaluating: 0.298596524*360.0
 Parameter: ZPHI <- "107.494749"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.8042915"
 Parameter: YPOS -> "-0.748685175"
 Parameter: ZPOS -> "-29.3253036"
 Parameter: XPHI -> "275.993757"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.104420   -0.994533
    0.000000    0.994533    0.104420

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   84.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.8042915"
 Parameter: YPOS -> "-0.748685175"
 Parameter: ZPOS -> "-29.3253036"
 Parameter: YPHI -> "133.1202"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.683531    0.000000   -0.729921
    0.000000    1.000000    0.000000
    0.729921    0.000000   -0.683531

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.8042915"
 Parameter: YPOS -> "-0.748685175"
 Parameter: ZPOS -> "-29.3253036"
 Parameter: ZPHI -> "107.494749"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.300618    0.953745    0.000000
   -0.953745   -0.300618    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.804292 XMAX =   -8.804292 XAVE =   -8.804292
    YMIN =   -0.748685 YMAX =   -0.748685 YAVE =   -0.748685
    ZMIN =  -29.325304 ZMAX =  -29.325304 ZAVE =  -29.325304
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.8042915"
Evaluating: -8.8042915+3.5
 Parameter: XMAX <- "-5.3042915"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.748685178"
Evaluating: -0.748685178+3.5
 Parameter: YMAX <- "2.75131482"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.3253036"
Evaluating: -29.3253036+3.5
 Parameter: ZMAX <- "-25.8253036"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.8042915"
Evaluating: -8.8042915-3.5
 Parameter: XMIN <- "-12.3042915"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.748685178"
Evaluating: -0.748685178-3.5
 Parameter: YMIN <- "-4.24868518"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.3253036"
Evaluating: -29.3253036-3.5
 Parameter: ZMIN <- "-32.8253036"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.3042915"
 Parameter: XMIN -> "-12.3042915"
 Parameter: YMAX -> "2.75131482"
 Parameter: YMIN -> "-4.24868518"
 Parameter: ZMAX -> "-25.8253036"
 Parameter: ZMIN -> "-32.8253036"
 SELRPN>      6 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      3 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15569 POS      POT      16       POT     - 551 PROA     ASN      36       ND2           3.8835
15569 POS      POT      16       POT     -4615 PROA     GLU      294      OE1           2.8716
15569 POS      POT      16       POT     -4673 PROA     GLN      297      CD            5.5818
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "16" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.798023248"
Evaluating: 62.3546605*(0.798023248-0.5)
 Parameter: XPOS <- "18.5831385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.748844269"
Evaluating: 62.3546605*(0.748844269-0.5)
 Parameter: YPOS <- "15.5165999"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.535553436"
Evaluating: 125.033241*(0.535553436-0.5)+-2.9500243
 Parameter: ZPOS <- "1.49533703"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.49533703" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.49533703" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "16" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.626316859"
Evaluating: 62.3546605*(0.626316859-0.5)
 Parameter: XPOS <- "7.87644486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.215201687"
Evaluating: 62.3546605*(0.215201687-0.5)
 Parameter: YPOS <- "-17.7585021"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.930833377"
Evaluating: 125.033241*(0.930833377-0.5)+-2.9500243
 Parameter: ZPOS <- "50.9184692"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.9184692" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.9184692" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.804292 XMAX =   -8.804292 XAVE =   -8.804292
    YMIN =   -0.748685 YMAX =   -0.748685 YAVE =   -0.748685
    ZMIN =  -29.325304 ZMAX =  -29.325304 ZAVE =  -29.325304
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.87644486"
 RDCMND substituted energy or value "?XAVE" to "-8.8042915"
Evaluating: 7.87644486--8.8042915
 Parameter: XTRAN <- "16.6807364"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.7585021"
 RDCMND substituted energy or value "?YAVE" to "-0.748685178"
Evaluating: -17.7585021--0.748685178
 Parameter: YTRAN <- "-17.0098169"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.9184692"
 RDCMND substituted energy or value "?ZAVE" to "-29.3253036"
Evaluating: 50.9184692--29.3253036
 Parameter: ZTRAN <- "80.2437728"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.6807364"
 Parameter: YTRAN -> "-17.0098169"
 Parameter: ZTRAN -> "80.2437728"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    16.680736  -17.009817   80.243773
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325399453"
Evaluating: 0.325399453*360.0
 Parameter: XPHI <- "117.143803"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.222747072"
Evaluating: 0.222747072*360.0
 Parameter: YPHI <- "80.1889459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946579144"
Evaluating: 0.946579144*360.0
 Parameter: ZPHI <- "340.768492"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.87644486"
 Parameter: YPOS -> "-17.7585021"
 Parameter: ZPOS -> "50.9184692"
 Parameter: XPHI -> "117.143803"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.456225    0.889864
    0.000000   -0.889864   -0.456225

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.87644486"
 Parameter: YPOS -> "-17.7585021"
 Parameter: ZPOS -> "50.9184692"
 Parameter: YPHI -> "80.1889459"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.170400    0.000000   -0.985375
    0.000000    1.000000    0.000000
    0.985375    0.000000    0.170400

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.87644486"
 Parameter: YPOS -> "-17.7585021"
 Parameter: ZPOS -> "50.9184692"
 Parameter: ZPHI -> "340.768492"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.944195   -0.329386    0.000000
    0.329386    0.944195    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.876445 XMAX =    7.876445 XAVE =    7.876445
    YMIN =  -17.758502 YMAX =  -17.758502 YAVE =  -17.758502
    ZMIN =   50.918469 ZMAX =   50.918469 ZAVE =   50.918469
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.87644489"
Evaluating: 7.87644489+3.5
 Parameter: XMAX <- "11.3764449"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.7585021"
Evaluating: -17.7585021+3.5
 Parameter: YMAX <- "-14.2585021"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.9184692"
Evaluating: 50.9184692+3.5
 Parameter: ZMAX <- "54.4184692"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.87644489"
Evaluating: 7.87644489-3.5
 Parameter: XMIN <- "4.37644489"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.7585021"
Evaluating: -17.7585021-3.5
 Parameter: YMIN <- "-21.2585021"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.9184692"
Evaluating: 50.9184692-3.5
 Parameter: ZMIN <- "47.4184692"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.3764449"
 Parameter: XMIN -> "4.37644489"
 Parameter: YMAX -> "-14.2585021"
 Parameter: YMIN -> "-21.2585021"
 Parameter: ZMAX -> "54.4184692"
 Parameter: ZMIN -> "47.4184692"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "17" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "17" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.846414494"
Evaluating: 62.3546605*(0.846414494-0.5)
 Parameter: XPOS <- "21.6005582"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.760637781"
Evaluating: 62.3546605*(0.760637781-0.5)
 Parameter: YPOS <- "16.2519803"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.517109052"
Evaluating: 125.033241*(0.517109052-0.5)+-2.9500243
 Parameter: ZPOS <- "-0.810824078"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.810824078" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.810824078" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "17" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.238938516"
Evaluating: 62.3546605*(0.238938516-0.5)
 Parameter: XPOS <- "-16.2784002"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.118580317"
Evaluating: 62.3546605*(0.118580317-0.5)
 Parameter: YPOS <- "-23.7832948"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.551984587"
Evaluating: 125.033241*(0.551984587-0.5)+-2.9500243
 Parameter: ZPOS <- "3.54977709"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.54977709" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.54977709" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "17" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.329910592"
Evaluating: 62.3546605*(0.329910592-0.5)
 Parameter: XPOS <- "-10.6058673"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.552388537"
Evaluating: 62.3546605*(0.552388537-0.5)
 Parameter: YPOS <- "3.26666944"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.908601688"
Evaluating: 125.033241*(0.908601688-0.5)+-2.9500243
 Parameter: ZPOS <- "48.138769"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.138769" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.138769" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.6058673"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.6058673-0
 Parameter: XTRAN <- "-10.6058673"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.26666944"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.26666944-0
 Parameter: YTRAN <- "3.26666944"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.138769"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.138769-0
 Parameter: ZTRAN <- "48.138769"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.6058673"
 Parameter: YTRAN -> "3.26666944"
 Parameter: ZTRAN -> "48.138769"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -10.605867    3.266669   48.138769
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.162314928"
Evaluating: 0.162314928*360.0
 Parameter: XPHI <- "58.4333741"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515673986"
Evaluating: 0.515673986*360.0
 Parameter: YPHI <- "185.642635"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875333933"
Evaluating: 0.875333933*360.0
 Parameter: ZPHI <- "315.120216"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.6058673"
 Parameter: YPOS -> "3.26666944"
 Parameter: ZPOS -> "48.138769"
 Parameter: XPHI -> "58.4333741"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.523490    0.852032
    0.000000   -0.852032    0.523490

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   58.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.6058673"
 Parameter: YPOS -> "3.26666944"
 Parameter: ZPOS -> "48.138769"
 Parameter: YPHI -> "185.642635"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.995155    0.000000    0.098323
    0.000000    1.000000    0.000000
   -0.098323    0.000000   -0.995155

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.6058673"
 Parameter: YPOS -> "3.26666944"
 Parameter: ZPOS -> "48.138769"
 Parameter: ZPHI -> "315.120216"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.708589   -0.705622    0.000000
    0.705622    0.708589    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.605867 XMAX =  -10.605867 XAVE =  -10.605867
    YMIN =    3.266669 YMAX =    3.266669 YAVE =    3.266669
    ZMIN =   48.138769 ZMAX =   48.138769 ZAVE =   48.138769
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.6058673"
Evaluating: -10.6058673+3.5
 Parameter: XMAX <- "-7.1058673"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.26666944"
Evaluating: 3.26666944+3.5
 Parameter: YMAX <- "6.76666944"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.138769"
Evaluating: 48.138769+3.5
 Parameter: ZMAX <- "51.638769"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.6058673"
Evaluating: -10.6058673-3.5
 Parameter: XMIN <- "-14.1058673"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.26666944"
Evaluating: 3.26666944-3.5
 Parameter: YMIN <- "-0.23333056"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.138769"
Evaluating: 48.138769-3.5
 Parameter: ZMIN <- "44.638769"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.1058673"
 Parameter: XMIN -> "-14.1058673"
 Parameter: YMAX -> "6.76666944"
 Parameter: YMIN -> "-0.23333056"
 Parameter: ZMAX -> "51.638769"
 Parameter: ZMIN -> "44.638769"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "18" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "18" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.420923188"
Evaluating: 62.3546605*(0.420923188-0.5)
 Parameter: XPOS <- "-4.93080777"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.575845036"
Evaluating: 62.3546605*(0.575845036-0.5)
 Parameter: YPOS <- "4.72929147"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.363724004"
Evaluating: 125.033241*(0.363724004-0.5)+-2.9500243
 Parameter: ZPOS <- "-19.9890538"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.9890538" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.93080777"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.93080777-0
 Parameter: XTRAN <- "-4.93080777"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.72929147"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.72929147-0
 Parameter: YTRAN <- "4.72929147"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.9890538"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.9890538-0
 Parameter: ZTRAN <- "-19.9890538"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.93080777"
 Parameter: YTRAN -> "4.72929147"
 Parameter: ZTRAN -> "-19.9890538"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -4.930808    4.729291  -19.989054
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.85474935"
Evaluating: 0.85474935*360.0
 Parameter: XPHI <- "307.709766"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800971057"
Evaluating: 0.800971057*360.0
 Parameter: YPHI <- "288.349581"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.146277144"
Evaluating: 0.146277144*360.0
 Parameter: ZPHI <- "52.6597718"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.93080777"
 Parameter: YPOS -> "4.72929147"
 Parameter: ZPOS -> "-19.9890538"
 Parameter: XPHI -> "307.709766"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.611662   -0.791119
    0.000000    0.791119    0.611662

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.93080777"
 Parameter: YPOS -> "4.72929147"
 Parameter: ZPOS -> "-19.9890538"
 Parameter: YPHI -> "288.349581"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.314814    0.000000    0.949153
    0.000000    1.000000    0.000000
   -0.949153    0.000000    0.314814

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.93080777"
 Parameter: YPOS -> "4.72929147"
 Parameter: ZPOS -> "-19.9890538"
 Parameter: ZPHI -> "52.6597718"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.606547    0.795048    0.000000
   -0.795048    0.606547    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   52.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.930808 XMAX =   -4.930808 XAVE =   -4.930808
    YMIN =    4.729291 YMAX =    4.729291 YAVE =    4.729291
    ZMIN =  -19.989054 ZMAX =  -19.989054 ZAVE =  -19.989054
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.93080777"
Evaluating: -4.93080777+3.5
 Parameter: XMAX <- "-1.43080777"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.72929147"
Evaluating: 4.72929147+3.5
 Parameter: YMAX <- "8.22929147"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.9890538"
Evaluating: -19.9890538+3.5
 Parameter: ZMAX <- "-16.4890538"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.93080777"
Evaluating: -4.93080777-3.5
 Parameter: XMIN <- "-8.43080777"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.72929147"
Evaluating: 4.72929147-3.5
 Parameter: YMIN <- "1.22929147"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.9890538"
Evaluating: -19.9890538-3.5
 Parameter: ZMIN <- "-23.4890538"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.43080777"
 Parameter: XMIN -> "-8.43080777"
 Parameter: YMAX -> "8.22929147"
 Parameter: YMIN -> "1.22929147"
 Parameter: ZMAX -> "-16.4890538"
 Parameter: ZMIN -> "-23.4890538"
 SELRPN>     29 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>     15 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15571 POS      POT      18       POT     -3576 PROA     HSD      230      CE1           4.7567
15571 POS      POT      18       POT     -3578 PROA     HSD      230      NE2           4.2044
15571 POS      POT      18       POT     -4537 PROA     ARG      291      N             4.4414
15571 POS      POT      18       POT     -4539 PROA     ARG      291      CA            3.5842
15571 POS      POT      18       POT     -4541 PROA     ARG      291      CB            4.0349
15571 POS      POT      18       POT     -4559 PROA     ARG      291      C             2.1691
15571 POS      POT      18       POT     -4560 PROA     ARG      291      O             2.0374
15571 POS      POT      18       POT     -4561 PROA     ILE      292      N             1.9369
15571 POS      POT      18       POT     -4563 PROA     ILE      292      CA            1.5838
15571 POS      POT      18       POT     -4565 PROA     ILE      292      CB            1.7381
15571 POS      POT      18       POT     -4567 PROA     ILE      292      CG2           2.9414
15571 POS      POT      18       POT     -4571 PROA     ILE      292      CG1           1.5672
15571 POS      POT      18       POT     -4574 PROA     ILE      292      CD            3.0937
15571 POS      POT      18       POT     -4578 PROA     ILE      292      C             3.1614
15571 POS      POT      18       POT     -4580 PROA     ARG      293      N             3.8881
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        15
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "18" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.412379941"
Evaluating: 62.3546605*(0.412379941-0.5)
 Parameter: XPOS <- "-5.46351903"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.327136973"
Evaluating: 62.3546605*(0.327136973-0.5)
 Parameter: YPOS <- "-10.7788154"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.637405422"
Evaluating: 125.033241*(0.637405422-0.5)+-2.9500243
 Parameter: ZPOS <- "14.2302209"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.2302209" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.2302209" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "18" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.12340705"
Evaluating: 62.3546605*(0.12340705-0.5)
 Parameter: XPOS <- "-23.4823255"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.466687141"
Evaluating: 62.3546605*(0.466687141-0.5)
 Parameter: YPOS <- "-2.07721201"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "4.928281368E-02"
Evaluating: 125.033241*(4.928281368E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-59.3046549"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.3046549" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.930808 XMAX =   -4.930808 XAVE =   -4.930808
    YMIN =    4.729291 YMAX =    4.729291 YAVE =    4.729291
    ZMIN =  -19.989054 ZMAX =  -19.989054 ZAVE =  -19.989054
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.4823255"
 RDCMND substituted energy or value "?XAVE" to "-4.93080777"
Evaluating: -23.4823255--4.93080777
 Parameter: XTRAN <- "-18.5515177"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.07721201"
 RDCMND substituted energy or value "?YAVE" to "4.72929147"
Evaluating: -2.07721201-4.72929147
 Parameter: YTRAN <- "-6.80650348"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.3046549"
 RDCMND substituted energy or value "?ZAVE" to "-19.9890538"
Evaluating: -59.3046549--19.9890538
 Parameter: ZTRAN <- "-39.3156011"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.5515177"
 Parameter: YTRAN -> "-6.80650348"
 Parameter: ZTRAN -> "-39.3156011"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -18.551518   -6.806503  -39.315601
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.304751264"
Evaluating: 0.304751264*360.0
 Parameter: XPHI <- "109.710455"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.81334845"
Evaluating: 0.81334845*360.0
 Parameter: YPHI <- "292.805442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67301991"
Evaluating: 0.67301991*360.0
 Parameter: ZPHI <- "242.287168"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.4823255"
 Parameter: YPOS -> "-2.07721201"
 Parameter: ZPOS -> "-59.3046549"
 Parameter: XPHI -> "109.710455"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.337267    0.941409
    0.000000   -0.941409   -0.337267

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  109.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.4823255"
 Parameter: YPOS -> "-2.07721201"
 Parameter: ZPOS -> "-59.3046549"
 Parameter: YPHI -> "292.805442"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.387603    0.000000    0.921826
    0.000000    1.000000    0.000000
   -0.921826    0.000000    0.387603

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.4823255"
 Parameter: YPOS -> "-2.07721201"
 Parameter: ZPOS -> "-59.3046549"
 Parameter: ZPHI -> "242.287168"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.465040   -0.885289    0.000000
    0.885289   -0.465040    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.482326 XMAX =  -23.482326 XAVE =  -23.482326
    YMIN =   -2.077212 YMAX =   -2.077212 YAVE =   -2.077212
    ZMIN =  -59.304655 ZMAX =  -59.304655 ZAVE =  -59.304655
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.4823255"
Evaluating: -23.4823255+3.5
 Parameter: XMAX <- "-19.9823255"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.077212"
Evaluating: -2.077212+3.5
 Parameter: YMAX <- "1.422788"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.3046549"
Evaluating: -59.3046549+3.5
 Parameter: ZMAX <- "-55.8046549"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.4823255"
Evaluating: -23.4823255-3.5
 Parameter: XMIN <- "-26.9823255"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.077212"
Evaluating: -2.077212-3.5
 Parameter: YMIN <- "-5.577212"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.3046549"
Evaluating: -59.3046549-3.5
 Parameter: ZMIN <- "-62.8046549"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.9823255"
 Parameter: XMIN -> "-26.9823255"
 Parameter: YMAX -> "1.422788"
 Parameter: YMIN -> "-5.577212"
 Parameter: ZMAX -> "-55.8046549"
 Parameter: ZMIN -> "-62.8046549"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "19" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "19" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "9.901043336E-02"
Evaluating: 62.3546605*(9.901043336E-02-0.5)
 Parameter: XPOS <- "-25.0035683"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.381380818"
Evaluating: 62.3546605*(0.381380818-0.5)
 Parameter: YPOS <- "-7.39645882"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.332255452"
Evaluating: 125.033241*(0.332255452-0.5)+-2.9500243
 Parameter: ZPOS <- "-23.9236688"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9236688" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.0035683"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.0035683-0
 Parameter: XTRAN <- "-25.0035683"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.39645882"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.39645882-0
 Parameter: YTRAN <- "-7.39645882"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9236688"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.9236688-0
 Parameter: ZTRAN <- "-23.9236688"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.0035683"
 Parameter: YTRAN -> "-7.39645882"
 Parameter: ZTRAN -> "-23.9236688"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -25.003568   -7.396459  -23.923669
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286075864"
Evaluating: 0.286075864*360.0
 Parameter: XPHI <- "102.987311"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877557624"
Evaluating: 0.877557624*360.0
 Parameter: YPHI <- "315.920745"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.357677157"
Evaluating: 0.357677157*360.0
 Parameter: ZPHI <- "128.763777"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.0035683"
 Parameter: YPOS -> "-7.39645882"
 Parameter: ZPOS -> "-23.9236688"
 Parameter: XPHI -> "102.987311"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.224735    0.974420
    0.000000   -0.974420   -0.224735

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.0035683"
 Parameter: YPOS -> "-7.39645882"
 Parameter: ZPOS -> "-23.9236688"
 Parameter: YPHI -> "315.920745"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.718378    0.000000    0.695653
    0.000000    1.000000    0.000000
   -0.695653    0.000000    0.718378

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.0035683"
 Parameter: YPOS -> "-7.39645882"
 Parameter: ZPOS -> "-23.9236688"
 Parameter: ZPHI -> "128.763777"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.626111    0.779734    0.000000
   -0.779734   -0.626111    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  128.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.003568 XMAX =  -25.003568 XAVE =  -25.003568
    YMIN =   -7.396459 YMAX =   -7.396459 YAVE =   -7.396459
    ZMIN =  -23.923669 ZMAX =  -23.923669 ZAVE =  -23.923669
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.0035683"
Evaluating: -25.0035683+3.5
 Parameter: XMAX <- "-21.5035683"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.39645882"
Evaluating: -7.39645882+3.5
 Parameter: YMAX <- "-3.89645882"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9236688"
Evaluating: -23.9236688+3.5
 Parameter: ZMAX <- "-20.4236688"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.0035683"
Evaluating: -25.0035683-3.5
 Parameter: XMIN <- "-28.5035683"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.39645882"
Evaluating: -7.39645882-3.5
 Parameter: YMIN <- "-10.8964588"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9236688"
Evaluating: -23.9236688-3.5
 Parameter: ZMIN <- "-27.4236688"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.5035683"
 Parameter: XMIN -> "-28.5035683"
 Parameter: YMAX -> "-3.89645882"
 Parameter: YMIN -> "-10.8964588"
 Parameter: ZMAX -> "-20.4236688"
 Parameter: ZMIN -> "-27.4236688"
 SELRPN>      3 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      1 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "20" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "20" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.354287102"
Evaluating: 62.3546605*(0.354287102-0.5)
 Parameter: XPOS <- "-9.08587829"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.455100601"
Evaluating: 62.3546605*(0.455100601-0.5)
 Parameter: YPOS <- "-2.79968678"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.554085937"
Evaluating: 125.033241*(0.554085937-0.5)+-2.9500243
 Parameter: ZPOS <- "3.8125157"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.8125157" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.8125157" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "20" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.637170948"
Evaluating: 62.3546605*(0.637170948-0.5)
 Parameter: XPOS <- "8.55324789"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.822747384"
Evaluating: 62.3546605*(0.822747384-0.5)
 Parameter: YPOS <- "20.1248036"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.670677688"
Evaluating: 125.033241*(0.670677688-0.5)+-2.9500243
 Parameter: ZPOS <- "18.3903602"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.3903602" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.3903602" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.55324789"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.55324789-0
 Parameter: XTRAN <- "8.55324789"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.1248036"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.1248036-0
 Parameter: YTRAN <- "20.1248036"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.3903602"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.3903602-0
 Parameter: ZTRAN <- "18.3903602"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.55324789"
 Parameter: YTRAN -> "20.1248036"
 Parameter: ZTRAN -> "18.3903602"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     8.553248   20.124804   18.390360
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486926173"
Evaluating: 0.486926173*360.0
 Parameter: XPHI <- "175.293422"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644935975"
Evaluating: 0.644935975*360.0
 Parameter: YPHI <- "232.176951"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.372415234"
Evaluating: 0.372415234*360.0
 Parameter: ZPHI <- "134.069484"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.55324789"
 Parameter: YPOS -> "20.1248036"
 Parameter: ZPOS -> "18.3903602"
 Parameter: XPHI -> "175.293422"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996628    0.082053
    0.000000   -0.082053   -0.996628

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.55324789"
 Parameter: YPOS -> "20.1248036"
 Parameter: ZPOS -> "18.3903602"
 Parameter: YPHI -> "232.176951"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.613225    0.000000    0.789908
    0.000000    1.000000    0.000000
   -0.789908    0.000000   -0.613225

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  127.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.55324789"
 Parameter: YPOS -> "20.1248036"
 Parameter: ZPOS -> "18.3903602"
 Parameter: ZPHI -> "134.069484"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.695530    0.718497    0.000000
   -0.718497   -0.695530    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  134.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.553248 XMAX =    8.553248 XAVE =    8.553248
    YMIN =   20.124804 YMAX =   20.124804 YAVE =   20.124804
    ZMIN =   18.390360 ZMAX =   18.390360 ZAVE =   18.390360
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.55324789"
Evaluating: 8.55324789+3.5
 Parameter: XMAX <- "12.0532479"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.1248036"
Evaluating: 20.1248036+3.5
 Parameter: YMAX <- "23.6248036"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.3903602"
Evaluating: 18.3903602+3.5
 Parameter: ZMAX <- "21.8903602"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.55324789"
Evaluating: 8.55324789-3.5
 Parameter: XMIN <- "5.05324789"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.1248036"
Evaluating: 20.1248036-3.5
 Parameter: YMIN <- "16.6248036"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.3903602"
Evaluating: 18.3903602-3.5
 Parameter: ZMIN <- "14.8903602"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.0532479"
 Parameter: XMIN -> "5.05324789"
 Parameter: YMAX -> "23.6248036"
 Parameter: YMIN -> "16.6248036"
 Parameter: ZMAX -> "21.8903602"
 Parameter: ZMIN -> "14.8903602"
 SELRPN>      7 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      1 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15573 POS      POT      20       POT     -4079 PROA     CYS      262      SG            3.2445
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "20" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.640252531"
Evaluating: 62.3546605*(0.640252531-0.5)
 Parameter: XPOS <- "8.74539895"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.530016292"
Evaluating: 62.3546605*(0.530016292-0.5)
 Parameter: YPOS <- "1.8716557"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.986176892"
Evaluating: 125.033241*(0.986176892-0.5)+-2.9500243
 Parameter: ZPOS <- "57.8382482"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.8382482" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.8382482" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.553248 XMAX =    8.553248 XAVE =    8.553248
    YMIN =   20.124804 YMAX =   20.124804 YAVE =   20.124804
    ZMIN =   18.390360 ZMAX =   18.390360 ZAVE =   18.390360
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.74539895"
 RDCMND substituted energy or value "?XAVE" to "8.55324789"
Evaluating: 8.74539895-8.55324789
 Parameter: XTRAN <- "0.19215106"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.8716557"
 RDCMND substituted energy or value "?YAVE" to "20.1248036"
Evaluating: 1.8716557-20.1248036
 Parameter: YTRAN <- "-18.2531479"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.8382482"
 RDCMND substituted energy or value "?ZAVE" to "18.3903602"
Evaluating: 57.8382482-18.3903602
 Parameter: ZTRAN <- "39.447888"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.19215106"
 Parameter: YTRAN -> "-18.2531479"
 Parameter: ZTRAN -> "39.447888"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     0.192151  -18.253148   39.447888
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.709870166"
Evaluating: 0.709870166*360.0
 Parameter: XPHI <- "255.55326"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474869983"
Evaluating: 0.474869983*360.0
 Parameter: YPHI <- "170.953194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64413616"
Evaluating: 0.64413616*360.0
 Parameter: ZPHI <- "231.889018"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.74539895"
 Parameter: YPOS -> "1.8716557"
 Parameter: ZPOS -> "57.8382482"
 Parameter: XPHI -> "255.55326"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.249480   -0.968380
    0.000000    0.968380   -0.249480

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  104.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.74539895"
 Parameter: YPOS -> "1.8716557"
 Parameter: ZPOS -> "57.8382482"
 Parameter: YPHI -> "170.953194"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.987560    0.000000   -0.157241
    0.000000    1.000000    0.000000
    0.157241    0.000000   -0.987560

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.74539895"
 Parameter: YPOS -> "1.8716557"
 Parameter: ZPOS -> "57.8382482"
 Parameter: ZPHI -> "231.889018"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.617187   -0.786817    0.000000
    0.786817   -0.617187    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.745399 XMAX =    8.745399 XAVE =    8.745399
    YMIN =    1.871656 YMAX =    1.871656 YAVE =    1.871656
    ZMIN =   57.838248 ZMAX =   57.838248 ZAVE =   57.838248
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.74539895"
Evaluating: 8.74539895+3.5
 Parameter: XMAX <- "12.245399"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.8716557"
Evaluating: 1.8716557+3.5
 Parameter: YMAX <- "5.3716557"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.8382482"
Evaluating: 57.8382482+3.5
 Parameter: ZMAX <- "61.3382482"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.74539895"
Evaluating: 8.74539895-3.5
 Parameter: XMIN <- "5.24539895"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.8716557"
Evaluating: 1.8716557-3.5
 Parameter: YMIN <- "-1.6283443"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.8382482"
Evaluating: 57.8382482-3.5
 Parameter: ZMIN <- "54.3382482"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.245399"
 Parameter: XMIN -> "5.24539895"
 Parameter: YMAX -> "5.3716557"
 Parameter: YMIN -> "-1.6283443"
 Parameter: ZMAX -> "61.3382482"
 Parameter: ZMIN -> "54.3382482"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "21" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "21" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "5.705206866E-02"
Evaluating: 62.3546605*(5.705206866E-02-0.5)
 Parameter: XPOS <- "-27.6198679"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.212909519"
Evaluating: 62.3546605*(0.212909519-0.5)
 Parameter: YPOS <- "-17.9014295"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.530264045"
Evaluating: 125.033241*(0.530264045-0.5)+-2.9500243
 Parameter: ZPOS <- "0.833987332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.833987332" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.833987332" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "21" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.71274381"
Evaluating: 62.3546605*(0.71274381-0.5)
 Parameter: XPOS <- "13.265568"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.886852332"
Evaluating: 62.3546605*(0.886852332-0.5)
 Parameter: YPOS <- "24.1220458"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.692466657"
Evaluating: 125.033241*(0.692466657-0.5)+-2.9500243
 Parameter: ZPOS <- "21.1147056"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.1147056" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.1147056" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.265568"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.265568-0
 Parameter: XTRAN <- "13.265568"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.1220458"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.1220458-0
 Parameter: YTRAN <- "24.1220458"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.1147056"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.1147056-0
 Parameter: ZTRAN <- "21.1147056"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.265568"
 Parameter: YTRAN -> "24.1220458"
 Parameter: ZTRAN -> "21.1147056"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    13.265568   24.122046   21.114706
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95285591"
Evaluating: 0.95285591*360.0
 Parameter: XPHI <- "343.028128"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.255356957"
Evaluating: 0.255356957*360.0
 Parameter: YPHI <- "91.9285045"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659647094"
Evaluating: 0.659647094*360.0
 Parameter: ZPHI <- "237.472954"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.265568"
 Parameter: YPOS -> "24.1220458"
 Parameter: ZPOS -> "21.1147056"
 Parameter: XPHI -> "343.028128"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.956448   -0.291902
    0.000000    0.291902    0.956448

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.265568"
 Parameter: YPOS -> "24.1220458"
 Parameter: ZPOS -> "21.1147056"
 Parameter: YPHI -> "91.9285045"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.033652    0.000000   -0.999434
    0.000000    1.000000    0.000000
    0.999434    0.000000   -0.033652

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.265568"
 Parameter: YPOS -> "24.1220458"
 Parameter: ZPOS -> "21.1147056"
 Parameter: ZPHI -> "237.472954"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.537698   -0.843138    0.000000
    0.843138   -0.537698    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.265568 XMAX =   13.265568 XAVE =   13.265568
    YMIN =   24.122046 YMAX =   24.122046 YAVE =   24.122046
    ZMIN =   21.114706 ZMAX =   21.114706 ZAVE =   21.114706
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.265568"
Evaluating: 13.265568+3.5
 Parameter: XMAX <- "16.765568"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.1220458"
Evaluating: 24.1220458+3.5
 Parameter: YMAX <- "27.6220458"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.1147056"
Evaluating: 21.1147056+3.5
 Parameter: ZMAX <- "24.6147056"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.265568"
Evaluating: 13.265568-3.5
 Parameter: XMIN <- "9.765568"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.1220458"
Evaluating: 24.1220458-3.5
 Parameter: YMIN <- "20.6220458"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.1147056"
Evaluating: 21.1147056-3.5
 Parameter: ZMIN <- "17.6147056"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.765568"
 Parameter: XMIN -> "9.765568"
 Parameter: YMAX -> "27.6220458"
 Parameter: YMIN -> "20.6220458"
 Parameter: ZMAX -> "24.6147056"
 Parameter: ZMIN -> "17.6147056"
 SELRPN>     20 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      7 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15574 POS      POT      21       POT     -6844 MEMB     POPC     16       N             2.7077
15574 POS      POT      21       POT     -6845 MEMB     POPC     16       C12           3.5156
15574 POS      POT      21       POT     -6848 MEMB     POPC     16       C13           2.8195
15574 POS      POT      21       POT     -6852 MEMB     POPC     16       C14           3.9340
15574 POS      POT      21       POT     -6856 MEMB     POPC     16       C15           1.6533
15574 POS      POT      21       POT     -6866 MEMB     POPC     16       O12           3.6756
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "21" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.210655323"
Evaluating: 62.3546605*(0.210655323-0.5)
 Parameter: XPOS <- "-18.0419891"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.21667322"
Evaluating: 62.3546605*(0.21667322-0.5)
 Parameter: YPOS <- "-17.6667452"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.424822159"
Evaluating: 125.033241*(0.424822159-0.5)+-2.9500243
 Parameter: ZPOS <- "-12.3497534"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.3497534" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.3497534" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "21" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "6.399015173E-02"
Evaluating: 62.3546605*(6.399015173E-02-0.5)
 Parameter: XPOS <- "-27.1872461"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.780636554"
Evaluating: 62.3546605*(0.780636554-0.5)
 Parameter: YPOS <- "17.498997"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "9.663327572E-03"
Evaluating: 125.033241*(9.663327572E-03-0.5)+-2.9500243
 Parameter: ZPOS <- "-64.2584076"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.2584076" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.265568 XMAX =   13.265568 XAVE =   13.265568
    YMIN =   24.122046 YMAX =   24.122046 YAVE =   24.122046
    ZMIN =   21.114706 ZMAX =   21.114706 ZAVE =   21.114706
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.1872461"
 RDCMND substituted energy or value "?XAVE" to "13.265568"
Evaluating: -27.1872461-13.265568
 Parameter: XTRAN <- "-40.4528141"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.498997"
 RDCMND substituted energy or value "?YAVE" to "24.1220458"
Evaluating: 17.498997-24.1220458
 Parameter: YTRAN <- "-6.6230488"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.2584076"
 RDCMND substituted energy or value "?ZAVE" to "21.1147056"
Evaluating: -64.2584076-21.1147056
 Parameter: ZTRAN <- "-85.3731132"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.4528141"
 Parameter: YTRAN -> "-6.6230488"
 Parameter: ZTRAN -> "-85.3731132"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -40.452814   -6.623049  -85.373113
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.618900239"
Evaluating: 0.618900239*360.0
 Parameter: XPHI <- "222.804086"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875038503"
Evaluating: 0.875038503*360.0
 Parameter: YPHI <- "315.013861"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.719737025"
Evaluating: 0.719737025*360.0
 Parameter: ZPHI <- "259.105329"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.1872461"
 Parameter: YPOS -> "17.498997"
 Parameter: ZPOS -> "-64.2584076"
 Parameter: XPHI -> "222.804086"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.733681   -0.679494
    0.000000    0.679494   -0.733681

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.1872461"
 Parameter: YPOS -> "17.498997"
 Parameter: ZPOS -> "-64.2584076"
 Parameter: YPHI -> "315.013861"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.707278    0.000000    0.706936
    0.000000    1.000000    0.000000
   -0.706936    0.000000    0.707278

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.1872461"
 Parameter: YPOS -> "17.498997"
 Parameter: ZPOS -> "-64.2584076"
 Parameter: ZPHI -> "259.105329"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.189004   -0.981976    0.000000
    0.981976   -0.189004    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.187246 XMAX =  -27.187246 XAVE =  -27.187246
    YMIN =   17.498997 YMAX =   17.498997 YAVE =   17.498997
    ZMIN =  -64.258408 ZMAX =  -64.258408 ZAVE =  -64.258408
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.1872461"
Evaluating: -27.1872461+3.5
 Parameter: XMAX <- "-23.6872461"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.498997"
Evaluating: 17.498997+3.5
 Parameter: YMAX <- "20.998997"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.2584076"
Evaluating: -64.2584076+3.5
 Parameter: ZMAX <- "-60.7584076"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.1872461"
Evaluating: -27.1872461-3.5
 Parameter: XMIN <- "-30.6872461"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.498997"
Evaluating: 17.498997-3.5
 Parameter: YMIN <- "13.998997"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.2584076"
Evaluating: -64.2584076-3.5
 Parameter: ZMIN <- "-67.7584076"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.6872461"
 Parameter: XMIN -> "-30.6872461"
 Parameter: YMAX -> "20.998997"
 Parameter: YMIN -> "13.998997"
 Parameter: ZMAX -> "-60.7584076"
 Parameter: ZMIN -> "-67.7584076"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "22" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "22" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.82778963"
Evaluating: 62.3546605*(0.82778963-0.5)
 Parameter: XPOS <- "20.4392111"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "3.145225603E-03"
Evaluating: 62.3546605*(3.145225603E-03-0.5)
 Parameter: YPOS <- "-30.9812108"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.677162116"
Evaluating: 125.033241*(0.677162116-0.5)+-2.9500243
 Parameter: ZPOS <- "19.2011292"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.2011292" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.2011292" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.4392111"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.4392111-0
 Parameter: XTRAN <- "20.4392111"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.9812108"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.9812108-0
 Parameter: YTRAN <- "-30.9812108"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.2011292"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.2011292-0
 Parameter: ZTRAN <- "19.2011292"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.4392111"
 Parameter: YTRAN -> "-30.9812108"
 Parameter: ZTRAN -> "19.2011292"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    20.439211  -30.981211   19.201129
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854272157"
Evaluating: 0.854272157*360.0
 Parameter: XPHI <- "307.537977"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.782213776"
Evaluating: 0.782213776*360.0
 Parameter: YPHI <- "281.596959"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.624412003"
Evaluating: 0.624412003*360.0
 Parameter: ZPHI <- "224.788321"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.4392111"
 Parameter: YPOS -> "-30.9812108"
 Parameter: ZPOS -> "19.2011292"
 Parameter: XPHI -> "307.537977"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.609287   -0.792950
    0.000000    0.792950    0.609287

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.4392111"
 Parameter: YPOS -> "-30.9812108"
 Parameter: ZPOS -> "19.2011292"
 Parameter: YPHI -> "281.596959"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.201026    0.000000    0.979586
    0.000000    1.000000    0.000000
   -0.979586    0.000000    0.201026

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.4392111"
 Parameter: YPOS -> "-30.9812108"
 Parameter: ZPOS -> "19.2011292"
 Parameter: ZPHI -> "224.788321"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.709714   -0.704490    0.000000
    0.704490   -0.709714    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  135.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.439211 XMAX =   20.439211 XAVE =   20.439211
    YMIN =  -30.981211 YMAX =  -30.981211 YAVE =  -30.981211
    ZMIN =   19.201129 ZMAX =   19.201129 ZAVE =   19.201129
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.4392111"
Evaluating: 20.4392111+3.5
 Parameter: XMAX <- "23.9392111"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.9812108"
Evaluating: -30.9812108+3.5
 Parameter: YMAX <- "-27.4812108"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.2011292"
Evaluating: 19.2011292+3.5
 Parameter: ZMAX <- "22.7011292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.4392111"
Evaluating: 20.4392111-3.5
 Parameter: XMIN <- "16.9392111"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.9812108"
Evaluating: -30.9812108-3.5
 Parameter: YMIN <- "-34.4812108"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.2011292"
Evaluating: 19.2011292-3.5
 Parameter: ZMIN <- "15.7011292"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.9392111"
 Parameter: XMIN -> "16.9392111"
 Parameter: YMAX -> "-27.4812108"
 Parameter: YMIN -> "-34.4812108"
 Parameter: ZMAX -> "22.7011292"
 Parameter: ZMIN -> "15.7011292"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "23" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "23" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.808379741"
Evaluating: 62.3546605*(0.808379741-0.5)
 Parameter: XPOS <- "19.2289141"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.759019035"
Evaluating: 62.3546605*(0.759019035-0.5)
 Parameter: YPOS <- "16.151044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.946074236"
Evaluating: 125.033241*(0.946074236-0.5)+-2.9500243
 Parameter: ZPOS <- "52.8240832"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.8240832" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.8240832" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.2289141"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.2289141-0
 Parameter: XTRAN <- "19.2289141"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.151044"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.151044-0
 Parameter: YTRAN <- "16.151044"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.8240832"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.8240832-0
 Parameter: ZTRAN <- "52.8240832"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.2289141"
 Parameter: YTRAN -> "16.151044"
 Parameter: ZTRAN -> "52.8240832"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    19.228914   16.151044   52.824083
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317182923"
Evaluating: 0.317182923*360.0
 Parameter: XPHI <- "114.185852"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223327508"
Evaluating: 0.223327508*360.0
 Parameter: YPHI <- "80.3979029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.286884096E-02"
Evaluating: 2.286884096E-02*360.0
 Parameter: ZPHI <- "8.23278275"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.2289141"
 Parameter: YPOS -> "16.151044"
 Parameter: ZPOS -> "52.8240832"
 Parameter: XPHI -> "114.185852"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.409698    0.912221
    0.000000   -0.912221   -0.409698

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.2289141"
 Parameter: YPOS -> "16.151044"
 Parameter: ZPOS -> "52.8240832"
 Parameter: YPHI -> "80.3979029"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.166805    0.000000   -0.985990
    0.000000    1.000000    0.000000
    0.985990    0.000000    0.166805

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.2289141"
 Parameter: YPOS -> "16.151044"
 Parameter: ZPOS -> "52.8240832"
 Parameter: ZPHI -> "8.23278275"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.989694    0.143195    0.000000
   -0.143195    0.989694    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.228914 XMAX =   19.228914 XAVE =   19.228914
    YMIN =   16.151044 YMAX =   16.151044 YAVE =   16.151044
    ZMIN =   52.824083 ZMAX =   52.824083 ZAVE =   52.824083
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.2289141"
Evaluating: 19.2289141+3.5
 Parameter: XMAX <- "22.7289141"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.151044"
Evaluating: 16.151044+3.5
 Parameter: YMAX <- "19.651044"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.8240832"
Evaluating: 52.8240832+3.5
 Parameter: ZMAX <- "56.3240832"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.2289141"
Evaluating: 19.2289141-3.5
 Parameter: XMIN <- "15.7289141"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.151044"
Evaluating: 16.151044-3.5
 Parameter: YMIN <- "12.651044"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.8240832"
Evaluating: 52.8240832-3.5
 Parameter: ZMIN <- "49.3240832"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.7289141"
 Parameter: XMIN -> "15.7289141"
 Parameter: YMAX -> "19.651044"
 Parameter: YMIN -> "12.651044"
 Parameter: ZMAX -> "56.3240832"
 Parameter: ZMIN -> "49.3240832"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "24" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "24" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.545039838"
Evaluating: 62.3546605*(0.545039838-0.5)
 Parameter: XPOS <- "2.80844381"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.329751163"
Evaluating: 62.3546605*(0.329751163-0.5)
 Parameter: YPOS <- "-10.6158084"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.221431721"
Evaluating: 125.033241*(0.221431721-0.5)+-2.9500243
 Parameter: ZPOS <- "-37.7803191"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.7803191" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.80844381"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.80844381-0
 Parameter: XTRAN <- "2.80844381"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.6158084"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.6158084-0
 Parameter: YTRAN <- "-10.6158084"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7803191"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.7803191-0
 Parameter: ZTRAN <- "-37.7803191"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.80844381"
 Parameter: YTRAN -> "-10.6158084"
 Parameter: ZTRAN -> "-37.7803191"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     2.808444  -10.615808  -37.780319
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.750630019"
Evaluating: 0.750630019*360.0
 Parameter: XPHI <- "270.226807"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.452423783E-02"
Evaluating: 1.452423783E-02*360.0
 Parameter: YPHI <- "5.22872562"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574251054"
Evaluating: 0.574251054*360.0
 Parameter: ZPHI <- "206.730379"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.80844381"
 Parameter: YPOS -> "-10.6158084"
 Parameter: ZPOS -> "-37.7803191"
 Parameter: XPHI -> "270.226807"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.003959   -0.999992
    0.000000    0.999992    0.003959

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.80844381"
 Parameter: YPOS -> "-10.6158084"
 Parameter: ZPOS -> "-37.7803191"
 Parameter: YPHI -> "5.22872562"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.995839    0.000000   -0.091132
    0.000000    1.000000    0.000000
    0.091132    0.000000    0.995839

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.80844381"
 Parameter: YPOS -> "-10.6158084"
 Parameter: ZPOS -> "-37.7803191"
 Parameter: ZPHI -> "206.730379"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.893133   -0.449793    0.000000
    0.449793   -0.893133    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  153.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.808444 XMAX =    2.808444 XAVE =    2.808444
    YMIN =  -10.615808 YMAX =  -10.615808 YAVE =  -10.615808
    ZMIN =  -37.780319 ZMAX =  -37.780319 ZAVE =  -37.780319
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.80844381"
Evaluating: 2.80844381+3.5
 Parameter: XMAX <- "6.30844381"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.6158084"
Evaluating: -10.6158084+3.5
 Parameter: YMAX <- "-7.1158084"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7803191"
Evaluating: -37.7803191+3.5
 Parameter: ZMAX <- "-34.2803191"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.80844381"
Evaluating: 2.80844381-3.5
 Parameter: XMIN <- "-0.69155619"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.6158084"
Evaluating: -10.6158084-3.5
 Parameter: YMIN <- "-14.1158084"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7803191"
Evaluating: -37.7803191-3.5
 Parameter: ZMIN <- "-41.2803191"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.30844381"
 Parameter: XMIN -> "-0.69155619"
 Parameter: YMAX -> "-7.1158084"
 Parameter: YMIN -> "-14.1158084"
 Parameter: ZMAX -> "-34.2803191"
 Parameter: ZMIN -> "-41.2803191"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "25" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "25" and "25".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.138105333"
Evaluating: 62.3546605*(0.138105333-0.5)
 Parameter: XPOS <- "-22.5658191"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.90003762"
Evaluating: 62.3546605*(0.90003762-0.5)
 Parameter: YPOS <- "24.94421"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.848668299"
Evaluating: 125.033241*(0.848668299-0.5)+-2.9500243
 Parameter: ZPOS <- "40.6451032"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.6451032" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.6451032" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.5658191"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.5658191-0
 Parameter: XTRAN <- "-22.5658191"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.94421"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.94421-0
 Parameter: YTRAN <- "24.94421"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.6451032"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.6451032-0
 Parameter: ZTRAN <- "40.6451032"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.5658191"
 Parameter: YTRAN -> "24.94421"
 Parameter: ZTRAN -> "40.6451032"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -22.565819   24.944210   40.645103
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.470943085"
Evaluating: 0.470943085*360.0
 Parameter: XPHI <- "169.539511"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674906561"
Evaluating: 0.674906561*360.0
 Parameter: YPHI <- "242.966362"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766585374"
Evaluating: 0.766585374*360.0
 Parameter: ZPHI <- "275.970735"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.5658191"
 Parameter: YPOS -> "24.94421"
 Parameter: ZPOS -> "40.6451032"
 Parameter: XPHI -> "169.539511"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.983380    0.181557
    0.000000   -0.181557   -0.983380

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  169.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.5658191"
 Parameter: YPOS -> "24.94421"
 Parameter: ZPOS -> "40.6451032"
 Parameter: YPHI -> "242.966362"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.454514    0.000000    0.890740
    0.000000    1.000000    0.000000
   -0.890740    0.000000   -0.454514

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.5658191"
 Parameter: YPOS -> "24.94421"
 Parameter: ZPOS -> "40.6451032"
 Parameter: ZPHI -> "275.970735"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.104020   -0.994575    0.000000
    0.994575    0.104020    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.565819 XMAX =  -22.565819 XAVE =  -22.565819
    YMIN =   24.944210 YMAX =   24.944210 YAVE =   24.944210
    ZMIN =   40.645103 ZMAX =   40.645103 ZAVE =   40.645103
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.5658191"
Evaluating: -22.5658191+3.5
 Parameter: XMAX <- "-19.0658191"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.94421"
Evaluating: 24.94421+3.5
 Parameter: YMAX <- "28.44421"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.6451032"
Evaluating: 40.6451032+3.5
 Parameter: ZMAX <- "44.1451032"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.5658191"
Evaluating: -22.5658191-3.5
 Parameter: XMIN <- "-26.0658191"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.94421"
Evaluating: 24.94421-3.5
 Parameter: YMIN <- "21.44421"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.6451032"
Evaluating: 40.6451032-3.5
 Parameter: ZMIN <- "37.1451032"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.0658191"
 Parameter: XMIN -> "-26.0658191"
 Parameter: YMAX -> "28.44421"
 Parameter: YMIN -> "21.44421"
 Parameter: ZMAX -> "44.1451032"
 Parameter: ZMIN -> "37.1451032"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "26" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "26" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "26"
 Parameter: NPOS -> "25"
Evaluating: 26-25
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.297300785"
Evaluating: 62.3546605*(0.297300785-0.5)
 Parameter: XPOS <- "-12.6392407"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.299809434"
Evaluating: 62.3546605*(0.299809434-0.5)
 Parameter: YPOS <- "-12.4828148"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.170335278"
Evaluating: 125.033241*(0.170335278-0.5)+-2.9500243
 Parameter: ZPOS <- "-44.1690729"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.1690729" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.6392407"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.6392407-0
 Parameter: XTRAN <- "-12.6392407"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.4828148"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.4828148-0
 Parameter: YTRAN <- "-12.4828148"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.1690729"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.1690729-0
 Parameter: ZTRAN <- "-44.1690729"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.6392407"
 Parameter: YTRAN -> "-12.4828148"
 Parameter: ZTRAN -> "-44.1690729"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -12.639241  -12.482815  -44.169073
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.197197305E-02"
Evaluating: 6.197197305E-02*360.0
 Parameter: XPHI <- "22.3099103"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.926801003E-02"
Evaluating: 2.926801003E-02*360.0
 Parameter: YPHI <- "10.5364836"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499199381"
Evaluating: 0.499199381*360.0
 Parameter: ZPHI <- "179.711777"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.6392407"
 Parameter: YPOS -> "-12.4828148"
 Parameter: ZPOS -> "-44.1690729"
 Parameter: XPHI -> "22.3099103"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.925144    0.379616
    0.000000   -0.379616    0.925144

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   22.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.6392407"
 Parameter: YPOS -> "-12.4828148"
 Parameter: ZPOS -> "-44.1690729"
 Parameter: YPHI -> "10.5364836"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.983139    0.000000   -0.182862
    0.000000    1.000000    0.000000
    0.182862    0.000000    0.983139

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   10.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.6392407"
 Parameter: YPOS -> "-12.4828148"
 Parameter: ZPOS -> "-44.1690729"
 Parameter: ZPHI -> "179.711777"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.999987    0.005030    0.000000
   -0.005030   -0.999987    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.639241 XMAX =  -12.639241 XAVE =  -12.639241
    YMIN =  -12.482815 YMAX =  -12.482815 YAVE =  -12.482815
    ZMIN =  -44.169073 ZMAX =  -44.169073 ZAVE =  -44.169073
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.6392407"
Evaluating: -12.6392407+3.5
 Parameter: XMAX <- "-9.1392407"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.4828148"
Evaluating: -12.4828148+3.5
 Parameter: YMAX <- "-8.9828148"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.1690729"
Evaluating: -44.1690729+3.5
 Parameter: ZMAX <- "-40.6690729"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.6392407"
Evaluating: -12.6392407-3.5
 Parameter: XMIN <- "-16.1392407"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.4828148"
Evaluating: -12.4828148-3.5
 Parameter: YMIN <- "-15.9828148"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.1690729"
Evaluating: -44.1690729-3.5
 Parameter: ZMIN <- "-47.6690729"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.1392407"
 Parameter: XMIN -> "-16.1392407"
 Parameter: YMAX -> "-8.9828148"
 Parameter: YMIN -> "-15.9828148"
 Parameter: ZMAX -> "-40.6690729"
 Parameter: ZMIN -> "-47.6690729"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "27" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "27" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "27"
 Parameter: NPOS -> "25"
Evaluating: 27-25
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.429504256"
Evaluating: 62.3546605*(0.429504256-0.5)
 Parameter: XPOS <- "-4.39573818"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.910149204"
Evaluating: 62.3546605*(0.910149204-0.5)
 Parameter: YPOS <- "25.5747144"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.929721303"
Evaluating: 125.033241*(0.929721303-0.5)+-2.9500243
 Parameter: ZPOS <- "50.7794229"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.7794229" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.7794229" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.39573818"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.39573818-0
 Parameter: XTRAN <- "-4.39573818"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.5747144"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.5747144-0
 Parameter: YTRAN <- "25.5747144"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.7794229"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 50.7794229-0
 Parameter: ZTRAN <- "50.7794229"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.39573818"
 Parameter: YTRAN -> "25.5747144"
 Parameter: ZTRAN -> "50.7794229"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -4.395738   25.574714   50.779423
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.170290315"
Evaluating: 0.170290315*360.0
 Parameter: XPHI <- "61.3045134"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.724197954"
Evaluating: 0.724197954*360.0
 Parameter: YPHI <- "260.711263"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371910456"
Evaluating: 0.371910456*360.0
 Parameter: ZPHI <- "133.887764"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.39573818"
 Parameter: YPOS -> "25.5747144"
 Parameter: ZPOS -> "50.7794229"
 Parameter: XPHI -> "61.3045134"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.480154    0.877184
    0.000000   -0.877184    0.480154

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.39573818"
 Parameter: YPOS -> "25.5747144"
 Parameter: ZPOS -> "50.7794229"
 Parameter: YPHI -> "260.711263"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.161410    0.000000    0.986887
    0.000000    1.000000    0.000000
   -0.986887    0.000000   -0.161410

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   99.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.39573818"
 Parameter: YPOS -> "25.5747144"
 Parameter: ZPOS -> "50.7794229"
 Parameter: ZPHI -> "133.887764"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.693248    0.720699    0.000000
   -0.720699   -0.693248    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  133.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.395738 XMAX =   -4.395738 XAVE =   -4.395738
    YMIN =   25.574714 YMAX =   25.574714 YAVE =   25.574714
    ZMIN =   50.779423 ZMAX =   50.779423 ZAVE =   50.779423
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.39573818"
Evaluating: -4.39573818+3.5
 Parameter: XMAX <- "-0.89573818"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.5747144"
Evaluating: 25.5747144+3.5
 Parameter: YMAX <- "29.0747144"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.7794229"
Evaluating: 50.7794229+3.5
 Parameter: ZMAX <- "54.2794229"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.39573818"
Evaluating: -4.39573818-3.5
 Parameter: XMIN <- "-7.89573818"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.5747144"
Evaluating: 25.5747144-3.5
 Parameter: YMIN <- "22.0747144"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.7794229"
Evaluating: 50.7794229-3.5
 Parameter: ZMIN <- "47.2794229"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.89573818"
 Parameter: XMIN -> "-7.89573818"
 Parameter: YMAX -> "29.0747144"
 Parameter: YMIN -> "22.0747144"
 Parameter: ZMAX -> "54.2794229"
 Parameter: ZMIN -> "47.2794229"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "28" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "28" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "28"
 Parameter: NPOS -> "25"
Evaluating: 28-25
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.414518517"
Evaluating: 62.3546605*(0.414518517-0.5)
 Parameter: XPOS <- "-5.33016885"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.706391406"
Evaluating: 62.3546605*(0.706391406-0.5)
 Parameter: YPOS <- "12.8694661"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "3.302499389E-02"
Evaluating: 125.033241*(3.302499389E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-61.3374228"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.3374228" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.33016885"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.33016885-0
 Parameter: XTRAN <- "-5.33016885"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.8694661"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.8694661-0
 Parameter: YTRAN <- "12.8694661"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.3374228"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.3374228-0
 Parameter: ZTRAN <- "-61.3374228"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.33016885"
 Parameter: YTRAN -> "12.8694661"
 Parameter: ZTRAN -> "-61.3374228"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -5.330169   12.869466  -61.337423
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28372373"
Evaluating: 0.28372373*360.0
 Parameter: XPHI <- "102.140543"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587083776"
Evaluating: 0.587083776*360.0
 Parameter: YPHI <- "211.350159"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.094774192E-02"
Evaluating: 2.094774192E-02*360.0
 Parameter: ZPHI <- "7.54118709"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.33016885"
 Parameter: YPOS -> "12.8694661"
 Parameter: ZPOS -> "-61.3374228"
 Parameter: XPHI -> "102.140543"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.210310    0.977635
    0.000000   -0.977635   -0.210310

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.33016885"
 Parameter: YPOS -> "12.8694661"
 Parameter: ZPOS -> "-61.3374228"
 Parameter: YPHI -> "211.350159"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.854004    0.000000    0.520267
    0.000000    1.000000    0.000000
   -0.520267    0.000000   -0.854004

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.33016885"
 Parameter: YPOS -> "12.8694661"
 Parameter: ZPOS -> "-61.3374228"
 Parameter: ZPHI -> "7.54118709"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.991351    0.131239    0.000000
   -0.131239    0.991351    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.330169 XMAX =   -5.330169 XAVE =   -5.330169
    YMIN =   12.869466 YMAX =   12.869466 YAVE =   12.869466
    ZMIN =  -61.337423 ZMAX =  -61.337423 ZAVE =  -61.337423
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.33016885"
Evaluating: -5.33016885+3.5
 Parameter: XMAX <- "-1.83016885"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.8694661"
Evaluating: 12.8694661+3.5
 Parameter: YMAX <- "16.3694661"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.3374228"
Evaluating: -61.3374228+3.5
 Parameter: ZMAX <- "-57.8374228"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.33016885"
Evaluating: -5.33016885-3.5
 Parameter: XMIN <- "-8.83016885"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.8694661"
Evaluating: 12.8694661-3.5
 Parameter: YMIN <- "9.3694661"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.3374228"
Evaluating: -61.3374228-3.5
 Parameter: ZMIN <- "-64.8374228"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.83016885"
 Parameter: XMIN -> "-8.83016885"
 Parameter: YMAX -> "16.3694661"
 Parameter: YMIN -> "9.3694661"
 Parameter: ZMAX -> "-57.8374228"
 Parameter: ZMIN -> "-64.8374228"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "29" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "29" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "29"
 Parameter: NPOS -> "25"
Evaluating: 29-25
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.127719814"
Evaluating: 62.3546605*(0.127719814-0.5)
 Parameter: XPOS <- "-23.2134046"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.467026102"
Evaluating: 62.3546605*(0.467026102-0.5)
 Parameter: YPOS <- "-2.05607622"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.984447883"
Evaluating: 125.033241*(0.984447883-0.5)+-2.9500243
 Parameter: ZPOS <- "57.6220646"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.6220646" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.6220646" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.2134046"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.2134046-0
 Parameter: XTRAN <- "-23.2134046"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.05607622"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.05607622-0
 Parameter: YTRAN <- "-2.05607622"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.6220646"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.6220646-0
 Parameter: ZTRAN <- "57.6220646"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.2134046"
 Parameter: YTRAN -> "-2.05607622"
 Parameter: ZTRAN -> "57.6220646"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -23.213405   -2.056076   57.622065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.991329549"
Evaluating: 0.991329549*360.0
 Parameter: XPHI <- "356.878638"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.858823033E-02"
Evaluating: 8.858823033E-02*360.0
 Parameter: YPHI <- "31.8917629"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.440993339"
Evaluating: 0.440993339*360.0
 Parameter: ZPHI <- "158.757602"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.2134046"
 Parameter: YPOS -> "-2.05607622"
 Parameter: ZPOS -> "57.6220646"
 Parameter: XPHI -> "356.878638"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998516   -0.054451
    0.000000    0.054451    0.998516

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    3.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.2134046"
 Parameter: YPOS -> "-2.05607622"
 Parameter: ZPOS -> "57.6220646"
 Parameter: YPHI -> "31.8917629"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.849048    0.000000   -0.528316
    0.000000    1.000000    0.000000
    0.528316    0.000000    0.849048

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.2134046"
 Parameter: YPOS -> "-2.05607622"
 Parameter: ZPOS -> "57.6220646"
 Parameter: ZPHI -> "158.757602"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.932056    0.362314    0.000000
   -0.362314   -0.932056    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.213405 XMAX =  -23.213405 XAVE =  -23.213405
    YMIN =   -2.056076 YMAX =   -2.056076 YAVE =   -2.056076
    ZMIN =   57.622065 ZMAX =   57.622065 ZAVE =   57.622065
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.2134046"
Evaluating: -23.2134046+3.5
 Parameter: XMAX <- "-19.7134046"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.05607622"
Evaluating: -2.05607622+3.5
 Parameter: YMAX <- "1.44392378"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.6220646"
Evaluating: 57.6220646+3.5
 Parameter: ZMAX <- "61.1220646"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.2134046"
Evaluating: -23.2134046-3.5
 Parameter: XMIN <- "-26.7134046"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.05607622"
Evaluating: -2.05607622-3.5
 Parameter: YMIN <- "-5.55607622"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.6220646"
Evaluating: 57.6220646-3.5
 Parameter: ZMIN <- "54.1220646"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.7134046"
 Parameter: XMIN -> "-26.7134046"
 Parameter: YMAX -> "1.44392378"
 Parameter: YMIN -> "-5.55607622"
 Parameter: ZMAX -> "61.1220646"
 Parameter: ZMIN -> "54.1220646"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "30" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "30" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "30"
 Parameter: NPOS -> "25"
Evaluating: 30-25
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.2926237"
Evaluating: 62.3546605*(0.2926237-0.5)
 Parameter: XPOS <- "-12.9308788"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.926170203"
Evaluating: 62.3546605*(0.926170203-0.5)
 Parameter: YPOS <- "26.5736983"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.36325007"
Evaluating: 125.033241*(0.36325007-0.5)+-2.9500243
 Parameter: ZPOS <- "-20.0483113"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.0483113" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.9308788"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.9308788-0
 Parameter: XTRAN <- "-12.9308788"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.5736983"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 26.5736983-0
 Parameter: YTRAN <- "26.5736983"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.0483113"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.0483113-0
 Parameter: ZTRAN <- "-20.0483113"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.9308788"
 Parameter: YTRAN -> "26.5736983"
 Parameter: ZTRAN -> "-20.0483113"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -12.930879   26.573698  -20.048311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.238643944"
Evaluating: 0.238643944*360.0
 Parameter: XPHI <- "85.9118198"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854973837"
Evaluating: 0.854973837*360.0
 Parameter: YPHI <- "307.790581"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360552145"
Evaluating: 0.360552145*360.0
 Parameter: ZPHI <- "129.798772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.9308788"
 Parameter: YPOS -> "26.5736983"
 Parameter: ZPOS -> "-20.0483113"
 Parameter: XPHI -> "85.9118198"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.071292    0.997456
    0.000000   -0.997456    0.071292

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   85.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.9308788"
 Parameter: YPOS -> "26.5736983"
 Parameter: ZPOS -> "-20.0483113"
 Parameter: YPHI -> "307.790581"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.612777    0.000000    0.790256
    0.000000    1.000000    0.000000
   -0.790256    0.000000    0.612777

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   52.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.9308788"
 Parameter: YPOS -> "26.5736983"
 Parameter: ZPOS -> "-20.0483113"
 Parameter: ZPHI -> "129.798772"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.640093    0.768297    0.000000
   -0.768297   -0.640093    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  129.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.930879 XMAX =  -12.930879 XAVE =  -12.930879
    YMIN =   26.573698 YMAX =   26.573698 YAVE =   26.573698
    ZMIN =  -20.048311 ZMAX =  -20.048311 ZAVE =  -20.048311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.9308788"
Evaluating: -12.9308788+3.5
 Parameter: XMAX <- "-9.4308788"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.5736983"
Evaluating: 26.5736983+3.5
 Parameter: YMAX <- "30.0736983"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.0483113"
Evaluating: -20.0483113+3.5
 Parameter: ZMAX <- "-16.5483113"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.9308788"
Evaluating: -12.9308788-3.5
 Parameter: XMIN <- "-16.4308788"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.5736983"
Evaluating: 26.5736983-3.5
 Parameter: YMIN <- "23.0736983"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.0483113"
Evaluating: -20.0483113-3.5
 Parameter: ZMIN <- "-23.5483113"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.4308788"
 Parameter: XMIN -> "-16.4308788"
 Parameter: YMAX -> "30.0736983"
 Parameter: YMIN -> "23.0736983"
 Parameter: ZMAX -> "-16.5483113"
 Parameter: ZMIN -> "-23.5483113"
 SELRPN>     13 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      5 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15583 NEG      CLA      5        CLA     -**** MEMB     POPC     65       N             3.8428
15583 NEG      CLA      5        CLA     -**** MEMB     POPC     65       C12           2.8650
15583 NEG      CLA      5        CLA     -**** MEMB     POPC     65       C14           3.6869
15583 NEG      CLA      5        CLA     -**** MEMB     POPC     65       C11           3.7579
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "30" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "30"
 Parameter: NPOS -> "25"
Evaluating: 30-25
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.67569096"
Evaluating: 62.3546605*(0.67569096-0.5)
 Parameter: XPOS <- "10.9551502"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.756359993"
Evaluating: 62.3546605*(0.756359993-0.5)
 Parameter: YPOS <- "15.9852403"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.973047369"
Evaluating: 125.033241*(0.973047369-0.5)+-2.9500243
 Parameter: ZPOS <- "56.1966214"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.1966214" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.1966214" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.930879 XMAX =  -12.930879 XAVE =  -12.930879
    YMIN =   26.573698 YMAX =   26.573698 YAVE =   26.573698
    ZMIN =  -20.048311 ZMAX =  -20.048311 ZAVE =  -20.048311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.9551502"
 RDCMND substituted energy or value "?XAVE" to "-12.9308788"
Evaluating: 10.9551502--12.9308788
 Parameter: XTRAN <- "23.886029"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.9852403"
 RDCMND substituted energy or value "?YAVE" to "26.5736983"
Evaluating: 15.9852403-26.5736983
 Parameter: YTRAN <- "-10.588458"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.1966214"
 RDCMND substituted energy or value "?ZAVE" to "-20.0483113"
Evaluating: 56.1966214--20.0483113
 Parameter: ZTRAN <- "76.2449327"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.886029"
 Parameter: YTRAN -> "-10.588458"
 Parameter: ZTRAN -> "76.2449327"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    23.886029  -10.588458   76.244933
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169349357"
Evaluating: 0.169349357*360.0
 Parameter: XPHI <- "60.9657685"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179247027"
Evaluating: 0.179247027*360.0
 Parameter: YPHI <- "64.5289297"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607988742"
Evaluating: 0.607988742*360.0
 Parameter: ZPHI <- "218.875947"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.9551502"
 Parameter: YPOS -> "15.9852403"
 Parameter: ZPOS -> "56.1966214"
 Parameter: XPHI -> "60.9657685"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.485332    0.874330
    0.000000   -0.874330    0.485332

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   60.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.9551502"
 Parameter: YPOS -> "15.9852403"
 Parameter: ZPOS -> "56.1966214"
 Parameter: YPHI -> "64.5289297"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.430055    0.000000   -0.902803
    0.000000    1.000000    0.000000
    0.902803    0.000000    0.430055

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.9551502"
 Parameter: YPOS -> "15.9852403"
 Parameter: ZPOS -> "56.1966214"
 Parameter: ZPHI -> "218.875947"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.778507   -0.627636    0.000000
    0.627636   -0.778507    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  141.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.955150 XMAX =   10.955150 XAVE =   10.955150
    YMIN =   15.985240 YMAX =   15.985240 YAVE =   15.985240
    ZMIN =   56.196621 ZMAX =   56.196621 ZAVE =   56.196621
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.9551502"
Evaluating: 10.9551502+3.5
 Parameter: XMAX <- "14.4551502"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.9852403"
Evaluating: 15.9852403+3.5
 Parameter: YMAX <- "19.4852403"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.1966214"
Evaluating: 56.1966214+3.5
 Parameter: ZMAX <- "59.6966214"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.9551502"
Evaluating: 10.9551502-3.5
 Parameter: XMIN <- "7.4551502"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.9852403"
Evaluating: 15.9852403-3.5
 Parameter: YMIN <- "12.4852403"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.1966214"
Evaluating: 56.1966214-3.5
 Parameter: ZMIN <- "52.6966214"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.4551502"
 Parameter: XMIN -> "7.4551502"
 Parameter: YMAX -> "19.4852403"
 Parameter: YMIN -> "12.4852403"
 Parameter: ZMAX -> "59.6966214"
 Parameter: ZMIN -> "52.6966214"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "31" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "31" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "31"
 Parameter: NPOS -> "25"
Evaluating: 31-25
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.978557189"
Evaluating: 62.3546605*(0.978557189-0.5)
 Parameter: XPOS <- "29.840271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.430556997"
Evaluating: 62.3546605*(0.430556997-0.5)
 Parameter: YPOS <- "-4.33009488"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.933876425"
Evaluating: 125.033241*(0.933876425-0.5)+-2.9500243
 Parameter: ZPOS <- "51.2989513"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.2989513" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.2989513" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.840271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.840271-0
 Parameter: XTRAN <- "29.840271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.33009488"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.33009488-0
 Parameter: YTRAN <- "-4.33009488"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.2989513"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.2989513-0
 Parameter: ZTRAN <- "51.2989513"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.840271"
 Parameter: YTRAN -> "-4.33009488"
 Parameter: ZTRAN -> "51.2989513"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    29.840271   -4.330095   51.298951
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668170847"
Evaluating: 0.668170847*360.0
 Parameter: XPHI <- "240.541505"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813612907"
Evaluating: 0.813612907*360.0
 Parameter: YPHI <- "292.900647"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8105553"
Evaluating: 0.8105553*360.0
 Parameter: ZPHI <- "291.799908"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.840271"
 Parameter: YPOS -> "-4.33009488"
 Parameter: ZPOS -> "51.2989513"
 Parameter: XPHI -> "240.541505"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.491793   -0.870712
    0.000000    0.870712   -0.491793

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.840271"
 Parameter: YPOS -> "-4.33009488"
 Parameter: ZPOS -> "51.2989513"
 Parameter: YPHI -> "292.900647"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.389134    0.000000    0.921181
    0.000000    1.000000    0.000000
   -0.921181    0.000000    0.389134

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.840271"
 Parameter: YPOS -> "-4.33009488"
 Parameter: ZPOS -> "51.2989513"
 Parameter: ZPHI -> "291.799908"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.371366   -0.928486    0.000000
    0.928486    0.371366    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.840271 XMAX =   29.840271 XAVE =   29.840271
    YMIN =   -4.330095 YMAX =   -4.330095 YAVE =   -4.330095
    ZMIN =   51.298951 ZMAX =   51.298951 ZAVE =   51.298951
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.840271"
Evaluating: 29.840271+3.5
 Parameter: XMAX <- "33.340271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.33009488"
Evaluating: -4.33009488+3.5
 Parameter: YMAX <- "-0.83009488"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.2989513"
Evaluating: 51.2989513+3.5
 Parameter: ZMAX <- "54.7989513"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.840271"
Evaluating: 29.840271-3.5
 Parameter: XMIN <- "26.340271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.33009488"
Evaluating: -4.33009488-3.5
 Parameter: YMIN <- "-7.83009488"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.2989513"
Evaluating: 51.2989513-3.5
 Parameter: ZMIN <- "47.7989513"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.340271"
 Parameter: XMIN -> "26.340271"
 Parameter: YMAX -> "-0.83009488"
 Parameter: YMIN -> "-7.83009488"
 Parameter: ZMAX -> "54.7989513"
 Parameter: ZMIN -> "47.7989513"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "32" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "32" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "32"
 Parameter: NPOS -> "25"
Evaluating: 32-25
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.957674847"
Evaluating: 62.3546605*(0.957674847-0.5)
 Parameter: XPOS <- "28.5381597"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.876972048"
Evaluating: 62.3546605*(0.876972048-0.5)
 Parameter: YPOS <- "23.5059641"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.296051298"
Evaluating: 125.033241*(0.296051298-0.5)+-2.9500243
 Parameter: ZPOS <- "-28.4503915"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.4503915" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.5381597"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.5381597-0
 Parameter: XTRAN <- "28.5381597"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.5059641"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.5059641-0
 Parameter: YTRAN <- "23.5059641"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.4503915"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.4503915-0
 Parameter: ZTRAN <- "-28.4503915"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.5381597"
 Parameter: YTRAN -> "23.5059641"
 Parameter: ZTRAN -> "-28.4503915"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    28.538160   23.505964  -28.450391
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.506840464"
Evaluating: 0.506840464*360.0
 Parameter: XPHI <- "182.462567"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.836458632E-03"
Evaluating: 6.836458632E-03*360.0
 Parameter: YPHI <- "2.46112511"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.316855603"
Evaluating: 0.316855603*360.0
 Parameter: ZPHI <- "114.068017"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.5381597"
 Parameter: YPOS -> "23.5059641"
 Parameter: ZPOS -> "-28.4503915"
 Parameter: XPHI -> "182.462567"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999077   -0.042967
    0.000000    0.042967   -0.999077

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.5381597"
 Parameter: YPOS -> "23.5059641"
 Parameter: ZPOS -> "-28.4503915"
 Parameter: YPHI -> "2.46112511"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.999078    0.000000   -0.042942
    0.000000    1.000000    0.000000
    0.042942    0.000000    0.999078

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.5381597"
 Parameter: YPOS -> "23.5059641"
 Parameter: ZPOS -> "-28.4503915"
 Parameter: ZPHI -> "114.068017"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.407821    0.913062    0.000000
   -0.913062   -0.407821    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.538160 XMAX =   28.538160 XAVE =   28.538160
    YMIN =   23.505964 YMAX =   23.505964 YAVE =   23.505964
    ZMIN =  -28.450391 ZMAX =  -28.450391 ZAVE =  -28.450391
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.5381597"
Evaluating: 28.5381597+3.5
 Parameter: XMAX <- "32.0381597"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.5059641"
Evaluating: 23.5059641+3.5
 Parameter: YMAX <- "27.0059641"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.4503915"
Evaluating: -28.4503915+3.5
 Parameter: ZMAX <- "-24.9503915"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.5381597"
Evaluating: 28.5381597-3.5
 Parameter: XMIN <- "25.0381597"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.5059641"
Evaluating: 23.5059641-3.5
 Parameter: YMIN <- "20.0059641"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.4503915"
Evaluating: -28.4503915-3.5
 Parameter: ZMIN <- "-31.9503915"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.0381597"
 Parameter: XMIN -> "25.0381597"
 Parameter: YMAX -> "27.0059641"
 Parameter: YMIN -> "20.0059641"
 Parameter: ZMAX -> "-24.9503915"
 Parameter: ZMIN -> "-31.9503915"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "33" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "33" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "33"
 Parameter: NPOS -> "25"
Evaluating: 33-25
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.504807314"
Evaluating: 62.3546605*(0.504807314-0.5)
 Parameter: XPOS <- "0.299758432"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.83222119"
Evaluating: 62.3546605*(0.83222119-0.5)
 Parameter: YPOS <- "20.7155395"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.589415174"
Evaluating: 125.033241*(0.589415174-0.5)+-2.9500243
 Parameter: ZPOS <- "8.2298447"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.2298447" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.2298447" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "33" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "33"
 Parameter: NPOS -> "25"
Evaluating: 33-25
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.643646899"
Evaluating: 62.3546605*(0.643646899-0.5)
 Parameter: XPOS <- "8.95705362"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.545470544"
Evaluating: 62.3546605*(0.545470544-0.5)
 Parameter: YPOS <- "2.83530033"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.467240376"
Evaluating: 125.033241*(0.467240376-0.5)+-2.9500243
 Parameter: ZPOS <- "-7.04606626"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.04606626" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.04606626" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "33" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "33"
 Parameter: NPOS -> "25"
Evaluating: 33-25
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.167672052"
Evaluating: 62.3546605*(0.167672052-0.5)
 Parameter: XPOS <- "-20.7221964"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.91567706"
Evaluating: 62.3546605*(0.91567706-0.5)
 Parameter: YPOS <- "25.919402"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.791463697"
Evaluating: 125.033241*(0.791463697-0.5)+-2.9500243
 Parameter: ZPOS <- "33.4926264"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.4926264" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.4926264" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.7221964"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.7221964-0
 Parameter: XTRAN <- "-20.7221964"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.919402"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.919402-0
 Parameter: YTRAN <- "25.919402"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.4926264"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.4926264-0
 Parameter: ZTRAN <- "33.4926264"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.7221964"
 Parameter: YTRAN -> "25.919402"
 Parameter: ZTRAN -> "33.4926264"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -20.722196   25.919402   33.492626
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.662296665"
Evaluating: 0.662296665*360.0
 Parameter: XPHI <- "238.426799"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567333395"
Evaluating: 0.567333395*360.0
 Parameter: YPHI <- "204.240022"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.948739999"
Evaluating: 0.948739999*360.0
 Parameter: ZPHI <- "341.5464"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.7221964"
 Parameter: YPOS -> "25.919402"
 Parameter: ZPOS -> "33.4926264"
 Parameter: XPHI -> "238.426799"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.523587   -0.851972
    0.000000    0.851972   -0.523587

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  121.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.7221964"
 Parameter: YPOS -> "25.919402"
 Parameter: ZPOS -> "33.4926264"
 Parameter: YPHI -> "204.240022"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.911834    0.000000    0.410560
    0.000000    1.000000    0.000000
   -0.410560    0.000000   -0.911834

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.7221964"
 Parameter: YPOS -> "25.919402"
 Parameter: ZPOS -> "33.4926264"
 Parameter: ZPHI -> "341.5464"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.948580   -0.316537    0.000000
    0.316537    0.948580    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   18.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.722196 XMAX =  -20.722196 XAVE =  -20.722196
    YMIN =   25.919402 YMAX =   25.919402 YAVE =   25.919402
    ZMIN =   33.492626 ZMAX =   33.492626 ZAVE =   33.492626
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.7221964"
Evaluating: -20.7221964+3.5
 Parameter: XMAX <- "-17.2221964"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.919402"
Evaluating: 25.919402+3.5
 Parameter: YMAX <- "29.419402"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.4926264"
Evaluating: 33.4926264+3.5
 Parameter: ZMAX <- "36.9926264"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.7221964"
Evaluating: -20.7221964-3.5
 Parameter: XMIN <- "-24.2221964"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.919402"
Evaluating: 25.919402-3.5
 Parameter: YMIN <- "22.419402"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.4926264"
Evaluating: 33.4926264-3.5
 Parameter: ZMIN <- "29.9926264"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.2221964"
 Parameter: XMIN -> "-24.2221964"
 Parameter: YMAX -> "29.419402"
 Parameter: YMIN -> "22.419402"
 Parameter: ZMAX -> "36.9926264"
 Parameter: ZMIN -> "29.9926264"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "34" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "34" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "34"
 Parameter: NPOS -> "25"
Evaluating: 34-25
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "3.235667762E-02"
Evaluating: 62.3546605*(3.235667762E-02-0.5)
 Parameter: XPOS <- "-29.1597406"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.655266388"
Evaluating: 62.3546605*(0.655266388-0.5)
 Parameter: YPOS <- "9.68158291"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.360844048"
Evaluating: 125.033241*(0.360844048-0.5)+-2.9500243
 Parameter: ZPOS <- "-20.349144"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.349144" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.1597406"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.1597406-0
 Parameter: XTRAN <- "-29.1597406"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.68158291"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.68158291-0
 Parameter: YTRAN <- "9.68158291"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.349144"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.349144-0
 Parameter: ZTRAN <- "-20.349144"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.1597406"
 Parameter: YTRAN -> "9.68158291"
 Parameter: ZTRAN -> "-20.349144"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -29.159741    9.681583  -20.349144
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.30494518"
Evaluating: 0.30494518*360.0
 Parameter: XPHI <- "109.780265"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.668579182E-02"
Evaluating: 8.668579182E-02*360.0
 Parameter: YPHI <- "31.2068851"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711309052"
Evaluating: 0.711309052*360.0
 Parameter: ZPHI <- "256.071259"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.1597406"
 Parameter: YPOS -> "9.68158291"
 Parameter: ZPOS -> "-20.349144"
 Parameter: XPHI -> "109.780265"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.338414    0.940997
    0.000000   -0.940997   -0.338414

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  109.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.1597406"
 Parameter: YPOS -> "9.68158291"
 Parameter: ZPOS -> "-20.349144"
 Parameter: YPHI -> "31.2068851"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.855302    0.000000   -0.518130
    0.000000    1.000000    0.000000
    0.518130    0.000000    0.855302

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.1597406"
 Parameter: YPOS -> "9.68158291"
 Parameter: ZPOS -> "-20.349144"
 Parameter: ZPHI -> "256.071259"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.240715   -0.970596    0.000000
    0.970596   -0.240715    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  103.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.159741 XMAX =  -29.159741 XAVE =  -29.159741
    YMIN =    9.681583 YMAX =    9.681583 YAVE =    9.681583
    ZMIN =  -20.349144 ZMAX =  -20.349144 ZAVE =  -20.349144
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.1597406"
Evaluating: -29.1597406+3.5
 Parameter: XMAX <- "-25.6597406"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.68158291"
Evaluating: 9.68158291+3.5
 Parameter: YMAX <- "13.1815829"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.349144"
Evaluating: -20.349144+3.5
 Parameter: ZMAX <- "-16.849144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.1597406"
Evaluating: -29.1597406-3.5
 Parameter: XMIN <- "-32.6597406"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.68158291"
Evaluating: 9.68158291-3.5
 Parameter: YMIN <- "6.18158291"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.349144"
Evaluating: -20.349144-3.5
 Parameter: ZMIN <- "-23.849144"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.6597406"
 Parameter: XMIN -> "-32.6597406"
 Parameter: YMAX -> "13.1815829"
 Parameter: YMIN -> "6.18158291"
 Parameter: ZMAX -> "-16.849144"
 Parameter: ZMIN -> "-23.849144"
 SELRPN>     18 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      8 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15587 NEG      CLA      9        CLA     -**** MEMB     POPC     59       N             3.0505
15587 NEG      CLA      9        CLA     -**** MEMB     POPC     59       C12           2.2955
15587 NEG      CLA      9        CLA     -**** MEMB     POPC     59       C13           3.0925
15587 NEG      CLA      9        CLA     -**** MEMB     POPC     59       C15           3.3409
15587 NEG      CLA      9        CLA     -**** MEMB     POPC     59       C11           3.1893
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "34" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "34"
 Parameter: NPOS -> "25"
Evaluating: 34-25
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.712926568"
Evaluating: 62.3546605*(0.712926568-0.5)
 Parameter: XPOS <- "13.2769639"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.958363274"
Evaluating: 62.3546605*(0.958363274-0.5)
 Parameter: YPOS <- "28.5810863"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "4.996090349E-02"
Evaluating: 125.033241*(4.996090349E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-59.2198711"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.2198711" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.159741 XMAX =  -29.159741 XAVE =  -29.159741
    YMIN =    9.681583 YMAX =    9.681583 YAVE =    9.681583
    ZMIN =  -20.349144 ZMAX =  -20.349144 ZAVE =  -20.349144
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.2769639"
 RDCMND substituted energy or value "?XAVE" to "-29.1597406"
Evaluating: 13.2769639--29.1597406
 Parameter: XTRAN <- "42.4367045"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.5810863"
 RDCMND substituted energy or value "?YAVE" to "9.68158291"
Evaluating: 28.5810863-9.68158291
 Parameter: YTRAN <- "18.8995034"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.2198711"
 RDCMND substituted energy or value "?ZAVE" to "-20.349144"
Evaluating: -59.2198711--20.349144
 Parameter: ZTRAN <- "-38.8707271"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.4367045"
 Parameter: YTRAN -> "18.8995034"
 Parameter: ZTRAN -> "-38.8707271"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    42.436704   18.899503  -38.870727
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.195558192"
Evaluating: 0.195558192*360.0
 Parameter: XPHI <- "70.4009491"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360001072"
Evaluating: 0.360001072*360.0
 Parameter: YPHI <- "129.600386"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.871055817"
Evaluating: 0.871055817*360.0
 Parameter: ZPHI <- "313.580094"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.2769639"
 Parameter: YPOS -> "28.5810863"
 Parameter: ZPOS -> "-59.2198711"
 Parameter: XPHI -> "70.4009491"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.335436    0.942063
    0.000000   -0.942063    0.335436

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   70.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.2769639"
 Parameter: YPOS -> "28.5810863"
 Parameter: ZPOS -> "-59.2198711"
 Parameter: YPHI -> "129.600386"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.637429    0.000000   -0.770509
    0.000000    1.000000    0.000000
    0.770509    0.000000   -0.637429

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.2769639"
 Parameter: YPOS -> "28.5810863"
 Parameter: ZPOS -> "-59.2198711"
 Parameter: ZPHI -> "313.580094"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.689368   -0.724411    0.000000
    0.724411    0.689368    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.276964 XMAX =   13.276964 XAVE =   13.276964
    YMIN =   28.581086 YMAX =   28.581086 YAVE =   28.581086
    ZMIN =  -59.219871 ZMAX =  -59.219871 ZAVE =  -59.219871
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.2769639"
Evaluating: 13.2769639+3.5
 Parameter: XMAX <- "16.7769639"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.5810863"
Evaluating: 28.5810863+3.5
 Parameter: YMAX <- "32.0810863"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.2198711"
Evaluating: -59.2198711+3.5
 Parameter: ZMAX <- "-55.7198711"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.2769639"
Evaluating: 13.2769639-3.5
 Parameter: XMIN <- "9.7769639"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.5810863"
Evaluating: 28.5810863-3.5
 Parameter: YMIN <- "25.0810863"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.2198711"
Evaluating: -59.2198711-3.5
 Parameter: ZMIN <- "-62.7198711"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.7769639"
 Parameter: XMIN -> "9.7769639"
 Parameter: YMAX -> "32.0810863"
 Parameter: YMIN -> "25.0810863"
 Parameter: ZMAX -> "-55.7198711"
 Parameter: ZMIN -> "-62.7198711"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "35" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "35" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "35"
 Parameter: NPOS -> "25"
Evaluating: 35-25
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.249725799"
Evaluating: 62.3546605*(0.249725799-0.5)
 Parameter: XPOS <- "-15.6057628"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.81666711"
Evaluating: 62.3546605*(0.81666711-0.5)
 Parameter: YPOS <- "19.7456701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.307805471"
Evaluating: 125.033241*(0.307805471-0.5)+-2.9500243
 Parameter: ZPOS <- "-26.9807292"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.9807292" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.6057628"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -15.6057628-0
 Parameter: XTRAN <- "-15.6057628"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.7456701"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.7456701-0
 Parameter: YTRAN <- "19.7456701"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.9807292"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.9807292-0
 Parameter: ZTRAN <- "-26.9807292"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.6057628"
 Parameter: YTRAN -> "19.7456701"
 Parameter: ZTRAN -> "-26.9807292"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -15.605763   19.745670  -26.980729
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938159772"
Evaluating: 0.938159772*360.0
 Parameter: XPHI <- "337.737518"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396389085"
Evaluating: 0.396389085*360.0
 Parameter: YPHI <- "142.700071"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.994184196"
Evaluating: 0.994184196*360.0
 Parameter: ZPHI <- "357.906311"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.6057628"
 Parameter: YPOS -> "19.7456701"
 Parameter: ZPOS -> "-26.9807292"
 Parameter: XPHI -> "337.737518"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.925458   -0.378850
    0.000000    0.378850    0.925458

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   22.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.6057628"
 Parameter: YPOS -> "19.7456701"
 Parameter: ZPOS -> "-26.9807292"
 Parameter: YPHI -> "142.700071"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.795474    0.000000   -0.605987
    0.000000    1.000000    0.000000
    0.605987    0.000000   -0.795474

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.6057628"
 Parameter: YPOS -> "19.7456701"
 Parameter: ZPOS -> "-26.9807292"
 Parameter: ZPHI -> "357.906311"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.999332   -0.036534    0.000000
    0.036534    0.999332    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    2.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.605763 XMAX =  -15.605763 XAVE =  -15.605763
    YMIN =   19.745670 YMAX =   19.745670 YAVE =   19.745670
    ZMIN =  -26.980729 ZMAX =  -26.980729 ZAVE =  -26.980729
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.6057628"
Evaluating: -15.6057628+3.5
 Parameter: XMAX <- "-12.1057628"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.7456701"
Evaluating: 19.7456701+3.5
 Parameter: YMAX <- "23.2456701"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.9807292"
Evaluating: -26.9807292+3.5
 Parameter: ZMAX <- "-23.4807292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.6057628"
Evaluating: -15.6057628-3.5
 Parameter: XMIN <- "-19.1057628"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.7456701"
Evaluating: 19.7456701-3.5
 Parameter: YMIN <- "16.2456701"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.9807292"
Evaluating: -26.9807292-3.5
 Parameter: ZMIN <- "-30.4807292"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.1057628"
 Parameter: XMIN -> "-19.1057628"
 Parameter: YMAX -> "23.2456701"
 Parameter: YMIN -> "16.2456701"
 Parameter: ZMAX -> "-23.4807292"
 Parameter: ZMIN -> "-30.4807292"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "36" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "36" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "36"
 Parameter: NPOS -> "25"
Evaluating: 36-25
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "9.335190491E-02"
Evaluating: 62.3546605*(9.335190491E-02-0.5)
 Parameter: XPOS <- "-25.3564039"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.965766573"
Evaluating: 62.3546605*(0.965766573-0.5)
 Parameter: YPOS <- "29.0427165"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.172861112"
Evaluating: 125.033241*(0.172861112-0.5)+-2.9500243
 Parameter: ZPOS <- "-43.8532597"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.8532597" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.3564039"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.3564039-0
 Parameter: XTRAN <- "-25.3564039"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.0427165"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.0427165-0
 Parameter: YTRAN <- "29.0427165"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.8532597"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.8532597-0
 Parameter: ZTRAN <- "-43.8532597"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.3564039"
 Parameter: YTRAN -> "29.0427165"
 Parameter: ZTRAN -> "-43.8532597"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -25.356404   29.042717  -43.853260
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567781903"
Evaluating: 0.567781903*360.0
 Parameter: XPHI <- "204.401485"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.727784796"
Evaluating: 0.727784796*360.0
 Parameter: YPHI <- "262.002527"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.826407242"
Evaluating: 0.826407242*360.0
 Parameter: ZPHI <- "297.506607"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.3564039"
 Parameter: YPOS -> "29.0427165"
 Parameter: ZPOS -> "-43.8532597"
 Parameter: XPHI -> "204.401485"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.910673   -0.413128
    0.000000    0.413128   -0.910673

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.3564039"
 Parameter: YPOS -> "29.0427165"
 Parameter: ZPOS -> "-43.8532597"
 Parameter: YPHI -> "262.002527"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.139129    0.000000    0.990274
    0.000000    1.000000    0.000000
   -0.990274    0.000000   -0.139129

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   98.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.3564039"
 Parameter: YPOS -> "29.0427165"
 Parameter: ZPOS -> "-43.8532597"
 Parameter: ZPHI -> "297.506607"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.461851   -0.886958    0.000000
    0.886958    0.461851    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   62.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.356404 XMAX =  -25.356404 XAVE =  -25.356404
    YMIN =   29.042717 YMAX =   29.042717 YAVE =   29.042717
    ZMIN =  -43.853260 ZMAX =  -43.853260 ZAVE =  -43.853260
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.3564039"
Evaluating: -25.3564039+3.5
 Parameter: XMAX <- "-21.8564039"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.0427165"
Evaluating: 29.0427165+3.5
 Parameter: YMAX <- "32.5427165"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.8532597"
Evaluating: -43.8532597+3.5
 Parameter: ZMAX <- "-40.3532597"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.3564039"
Evaluating: -25.3564039-3.5
 Parameter: XMIN <- "-28.8564039"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.0427165"
Evaluating: 29.0427165-3.5
 Parameter: YMIN <- "25.5427165"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.8532597"
Evaluating: -43.8532597-3.5
 Parameter: ZMIN <- "-47.3532597"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.8564039"
 Parameter: XMIN -> "-28.8564039"
 Parameter: YMAX -> "32.5427165"
 Parameter: YMIN -> "25.5427165"
 Parameter: ZMAX -> "-40.3532597"
 Parameter: ZMIN -> "-47.3532597"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "37" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "37" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "37"
 Parameter: NPOS -> "25"
Evaluating: 37-25
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.638691886"
Evaluating: 62.3546605*(0.638691886-0.5)
 Parameter: XPOS <- "8.64808547"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "9.234614595E-02"
Evaluating: 62.3546605*(9.234614595E-02-0.5)
 Parameter: YPOS <- "-25.4191177"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.781853301"
Evaluating: 125.033241*(0.781853301-0.5)+-2.9500243
 Parameter: ZPOS <- "32.2910074"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.2910074" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.2910074" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.64808547"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.64808547-0
 Parameter: XTRAN <- "8.64808547"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.4191177"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.4191177-0
 Parameter: YTRAN <- "-25.4191177"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.2910074"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.2910074-0
 Parameter: ZTRAN <- "32.2910074"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.64808547"
 Parameter: YTRAN -> "-25.4191177"
 Parameter: ZTRAN -> "32.2910074"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     8.648085  -25.419118   32.291007
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179561516"
Evaluating: 0.179561516*360.0
 Parameter: XPHI <- "64.6421458"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.808062515E-02"
Evaluating: 9.808062515E-02*360.0
 Parameter: YPHI <- "35.3090251"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762192537"
Evaluating: 0.762192537*360.0
 Parameter: ZPHI <- "274.389313"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.64808547"
 Parameter: YPOS -> "-25.4191177"
 Parameter: ZPOS -> "32.2910074"
 Parameter: XPHI -> "64.6421458"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.428271    0.903651
    0.000000   -0.903651    0.428271

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.64808547"
 Parameter: YPOS -> "-25.4191177"
 Parameter: ZPOS -> "32.2910074"
 Parameter: YPHI -> "35.3090251"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.816047    0.000000   -0.577986
    0.000000    1.000000    0.000000
    0.577986    0.000000    0.816047

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   35.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.64808547"
 Parameter: YPOS -> "-25.4191177"
 Parameter: ZPOS -> "32.2910074"
 Parameter: ZPHI -> "274.389313"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.076533   -0.997067    0.000000
    0.997067    0.076533    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   85.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.648085 XMAX =    8.648085 XAVE =    8.648085
    YMIN =  -25.419118 YMAX =  -25.419118 YAVE =  -25.419118
    ZMIN =   32.291007 ZMAX =   32.291007 ZAVE =   32.291007
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.64808547"
Evaluating: 8.64808547+3.5
 Parameter: XMAX <- "12.1480855"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.4191177"
Evaluating: -25.4191177+3.5
 Parameter: YMAX <- "-21.9191177"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.2910074"
Evaluating: 32.2910074+3.5
 Parameter: ZMAX <- "35.7910074"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.64808547"
Evaluating: 8.64808547-3.5
 Parameter: XMIN <- "5.14808547"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.4191177"
Evaluating: -25.4191177-3.5
 Parameter: YMIN <- "-28.9191177"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.2910074"
Evaluating: 32.2910074-3.5
 Parameter: ZMIN <- "28.7910074"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.1480855"
 Parameter: XMIN -> "5.14808547"
 Parameter: YMAX -> "-21.9191177"
 Parameter: YMIN -> "-28.9191177"
 Parameter: ZMAX -> "35.7910074"
 Parameter: ZMIN -> "28.7910074"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "38" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "38" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "38"
 Parameter: NPOS -> "25"
Evaluating: 38-25
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.361553343"
Evaluating: 62.3546605*(0.361553343-0.5)
 Parameter: XPOS <- "-8.63279429"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.577133165"
Evaluating: 62.3546605*(0.577133165-0.5)
 Parameter: YPOS <- "4.80961232"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.521303259"
Evaluating: 125.033241*(0.521303259-0.5)+-2.9500243
 Parameter: ZPOS <- "-0.286408783"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.286408783" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.286408783" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "38" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "38"
 Parameter: NPOS -> "25"
Evaluating: 38-25
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.739821725"
Evaluating: 62.3546605*(0.739821725-0.5)
 Parameter: XPOS <- "14.9540022"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.883179701"
Evaluating: 62.3546605*(0.883179701-0.5)
 Parameter: YPOS <- "23.8930402"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.703086799"
Evaluating: 125.033241*(0.703086799-0.5)+-2.9500243
 Parameter: ZPOS <- "22.4425764"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.4425764" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.4425764" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.9540022"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.9540022-0
 Parameter: XTRAN <- "14.9540022"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.8930402"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.8930402-0
 Parameter: YTRAN <- "23.8930402"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.4425764"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.4425764-0
 Parameter: ZTRAN <- "22.4425764"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.9540022"
 Parameter: YTRAN -> "23.8930402"
 Parameter: ZTRAN -> "22.4425764"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    14.954002   23.893040   22.442576
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.141326611"
Evaluating: 0.141326611*360.0
 Parameter: XPHI <- "50.87758"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745557849"
Evaluating: 0.745557849*360.0
 Parameter: YPHI <- "268.400826"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227591407"
Evaluating: 0.227591407*360.0
 Parameter: ZPHI <- "81.9329065"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.9540022"
 Parameter: YPOS -> "23.8930402"
 Parameter: ZPOS -> "22.4425764"
 Parameter: XPHI -> "50.87758"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.630979    0.775800
    0.000000   -0.775800    0.630979

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   50.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.9540022"
 Parameter: YPOS -> "23.8930402"
 Parameter: ZPOS -> "22.4425764"
 Parameter: YPHI -> "268.400826"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.027907    0.000000    0.999611
    0.000000    1.000000    0.000000
   -0.999611    0.000000   -0.027907

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.9540022"
 Parameter: YPOS -> "23.8930402"
 Parameter: ZPOS -> "22.4425764"
 Parameter: ZPHI -> "81.9329065"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.140333    0.990104    0.000000
   -0.990104    0.140333    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.954002 XMAX =   14.954002 XAVE =   14.954002
    YMIN =   23.893040 YMAX =   23.893040 YAVE =   23.893040
    ZMIN =   22.442576 ZMAX =   22.442576 ZAVE =   22.442576
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.9540022"
Evaluating: 14.9540022+3.5
 Parameter: XMAX <- "18.4540022"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.8930402"
Evaluating: 23.8930402+3.5
 Parameter: YMAX <- "27.3930402"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.4425764"
Evaluating: 22.4425764+3.5
 Parameter: ZMAX <- "25.9425764"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.9540022"
Evaluating: 14.9540022-3.5
 Parameter: XMIN <- "11.4540022"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.8930402"
Evaluating: 23.8930402-3.5
 Parameter: YMIN <- "20.3930402"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.4425764"
Evaluating: 22.4425764-3.5
 Parameter: ZMIN <- "18.9425764"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.4540022"
 Parameter: XMIN -> "11.4540022"
 Parameter: YMAX -> "27.3930402"
 Parameter: YMIN -> "20.3930402"
 Parameter: ZMAX -> "25.9425764"
 Parameter: ZMIN -> "18.9425764"
 SELRPN>     18 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      6 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15591 NEG      CLA      13       CLA     -6844 MEMB     POPC     16       N             2.2089
15591 NEG      CLA      13       CLA     -6845 MEMB     POPC     16       C12           2.6049
15591 NEG      CLA      13       CLA     -6848 MEMB     POPC     16       C13           1.5976
15591 NEG      CLA      13       CLA     -6852 MEMB     POPC     16       C14           3.6776
15591 NEG      CLA      13       CLA     -6856 MEMB     POPC     16       C15           2.5350
15591 NEG      CLA      13       CLA     -6860 MEMB     POPC     16       C11           3.8398
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "38" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "38"
 Parameter: NPOS -> "25"
Evaluating: 38-25
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.669449676"
Evaluating: 62.3546605*(0.669449676-0.5)
 Parameter: XPOS <- "10.565977"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.249571673"
Evaluating: 62.3546605*(0.249571673-0.5)
 Parameter: YPOS <- "-15.6153733"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.752574364"
Evaluating: 125.033241*(0.752574364-0.5)+-2.9500243
 Parameter: ZPOS <- "28.630167"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.630167" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.630167" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.954002 XMAX =   14.954002 XAVE =   14.954002
    YMIN =   23.893040 YMAX =   23.893040 YAVE =   23.893040
    ZMIN =   22.442576 ZMAX =   22.442576 ZAVE =   22.442576
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.565977"
 RDCMND substituted energy or value "?XAVE" to "14.9540022"
Evaluating: 10.565977-14.9540022
 Parameter: XTRAN <- "-4.3880252"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.6153733"
 RDCMND substituted energy or value "?YAVE" to "23.8930402"
Evaluating: -15.6153733-23.8930402
 Parameter: YTRAN <- "-39.5084135"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.630167"
 RDCMND substituted energy or value "?ZAVE" to "22.4425764"
Evaluating: 28.630167-22.4425764
 Parameter: ZTRAN <- "6.1875906"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.3880252"
 Parameter: YTRAN -> "-39.5084135"
 Parameter: ZTRAN -> "6.1875906"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -4.388025  -39.508414    6.187591
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331567586"
Evaluating: 0.331567586*360.0
 Parameter: XPHI <- "119.364331"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395169633"
Evaluating: 0.395169633*360.0
 Parameter: YPHI <- "142.261068"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.359350833"
Evaluating: 0.359350833*360.0
 Parameter: ZPHI <- "129.3663"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.565977"
 Parameter: YPOS -> "-15.6153733"
 Parameter: ZPOS -> "28.630167"
 Parameter: XPHI -> "119.364331"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.490361    0.871519
    0.000000   -0.871519   -0.490361

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  119.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.565977"
 Parameter: YPOS -> "-15.6153733"
 Parameter: ZPOS -> "28.630167"
 Parameter: YPHI -> "142.261068"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.790808    0.000000   -0.612065
    0.000000    1.000000    0.000000
    0.612065    0.000000   -0.790808

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.565977"
 Parameter: YPOS -> "-15.6153733"
 Parameter: ZPOS -> "28.630167"
 Parameter: ZPHI -> "129.3663"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.634276    0.773107    0.000000
   -0.773107   -0.634276    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  129.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.565977 XMAX =   10.565977 XAVE =   10.565977
    YMIN =  -15.615373 YMAX =  -15.615373 YAVE =  -15.615373
    ZMIN =   28.630167 ZMAX =   28.630167 ZAVE =   28.630167
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.565977"
Evaluating: 10.565977+3.5
 Parameter: XMAX <- "14.065977"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.6153733"
Evaluating: -15.6153733+3.5
 Parameter: YMAX <- "-12.1153733"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.630167"
Evaluating: 28.630167+3.5
 Parameter: ZMAX <- "32.130167"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.565977"
Evaluating: 10.565977-3.5
 Parameter: XMIN <- "7.065977"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.6153733"
Evaluating: -15.6153733-3.5
 Parameter: YMIN <- "-19.1153733"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.630167"
Evaluating: 28.630167-3.5
 Parameter: ZMIN <- "25.130167"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.065977"
 Parameter: XMIN -> "7.065977"
 Parameter: YMAX -> "-12.1153733"
 Parameter: YMIN -> "-19.1153733"
 Parameter: ZMAX -> "32.130167"
 Parameter: ZMIN -> "25.130167"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "39" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "39" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "39"
 Parameter: NPOS -> "25"
Evaluating: 39-25
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "5.807619909E-02"
Evaluating: 62.3546605*(5.807619909E-02-0.5)
 Parameter: XPOS <- "-27.5560086"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.860505065"
Evaluating: 62.3546605*(0.860505065-0.5)
 Parameter: YPOS <- "22.4791709"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "8.725087758E-02"
Evaluating: 125.033241*(8.725087758E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-54.5573848"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.5573848" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.5560086"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.5560086-0
 Parameter: XTRAN <- "-27.5560086"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.4791709"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.4791709-0
 Parameter: YTRAN <- "22.4791709"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.5573848"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.5573848-0
 Parameter: ZTRAN <- "-54.5573848"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.5560086"
 Parameter: YTRAN -> "22.4791709"
 Parameter: ZTRAN -> "-54.5573848"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -27.556009   22.479171  -54.557385
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.181436263"
Evaluating: 0.181436263*360.0
 Parameter: XPHI <- "65.3170547"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.978409325"
Evaluating: 0.978409325*360.0
 Parameter: YPHI <- "352.227357"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.228861409"
Evaluating: 0.228861409*360.0
 Parameter: ZPHI <- "82.3901072"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.5560086"
 Parameter: YPOS -> "22.4791709"
 Parameter: ZPOS -> "-54.5573848"
 Parameter: XPHI -> "65.3170547"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.417597    0.908633
    0.000000   -0.908633    0.417597

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   65.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.5560086"
 Parameter: YPOS -> "22.4791709"
 Parameter: ZPOS -> "-54.5573848"
 Parameter: YPHI -> "352.227357"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.990813    0.000000    0.135243
    0.000000    1.000000    0.000000
   -0.135243    0.000000    0.990813

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.5560086"
 Parameter: YPOS -> "22.4791709"
 Parameter: ZPOS -> "-54.5573848"
 Parameter: ZPHI -> "82.3901072"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.132428    0.991193    0.000000
   -0.991193    0.132428    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   82.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.556009 XMAX =  -27.556009 XAVE =  -27.556009
    YMIN =   22.479171 YMAX =   22.479171 YAVE =   22.479171
    ZMIN =  -54.557385 ZMAX =  -54.557385 ZAVE =  -54.557385
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.5560086"
Evaluating: -27.5560086+3.5
 Parameter: XMAX <- "-24.0560086"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.4791709"
Evaluating: 22.4791709+3.5
 Parameter: YMAX <- "25.9791709"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.5573848"
Evaluating: -54.5573848+3.5
 Parameter: ZMAX <- "-51.0573848"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.5560086"
Evaluating: -27.5560086-3.5
 Parameter: XMIN <- "-31.0560086"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.4791709"
Evaluating: 22.4791709-3.5
 Parameter: YMIN <- "18.9791709"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.5573848"
Evaluating: -54.5573848-3.5
 Parameter: ZMIN <- "-58.0573848"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.0560086"
 Parameter: XMIN -> "-31.0560086"
 Parameter: YMAX -> "25.9791709"
 Parameter: YMIN -> "18.9791709"
 Parameter: ZMAX -> "-51.0573848"
 Parameter: ZMIN -> "-58.0573848"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "40" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "40" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "40"
 Parameter: NPOS -> "25"
Evaluating: 40-25
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.909606081"
Evaluating: 62.3546605*(0.909606081-0.5)
 Parameter: XPOS <- "25.5408481"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "6.304333417E-02"
Evaluating: 62.3546605*(6.304333417E-02-0.5)
 Parameter: YPOS <- "-27.2462846"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.334519556"
Evaluating: 125.033241*(0.334519556-0.5)+-2.9500243
 Parameter: ZPOS <- "-23.6405805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.6405805" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.5408481"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.5408481-0
 Parameter: XTRAN <- "25.5408481"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.2462846"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.2462846-0
 Parameter: YTRAN <- "-27.2462846"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.6405805"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.6405805-0
 Parameter: ZTRAN <- "-23.6405805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.5408481"
 Parameter: YTRAN -> "-27.2462846"
 Parameter: ZTRAN -> "-23.6405805"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    25.540848  -27.246285  -23.640580
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.535254787"
Evaluating: 0.535254787*360.0
 Parameter: XPHI <- "192.691723"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406637571"
Evaluating: 0.406637571*360.0
 Parameter: YPHI <- "146.389526"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905892385"
Evaluating: 0.905892385*360.0
 Parameter: ZPHI <- "326.121259"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.5408481"
 Parameter: YPOS -> "-27.2462846"
 Parameter: ZPOS -> "-23.6405805"
 Parameter: XPHI -> "192.691723"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.975566   -0.219705
    0.000000    0.219705   -0.975566

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  167.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.5408481"
 Parameter: YPOS -> "-27.2462846"
 Parameter: ZPOS -> "-23.6405805"
 Parameter: YPHI -> "146.389526"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.832820    0.000000   -0.553544
    0.000000    1.000000    0.000000
    0.553544    0.000000   -0.832820

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.5408481"
 Parameter: YPOS -> "-27.2462846"
 Parameter: ZPOS -> "-23.6405805"
 Parameter: ZPHI -> "326.121259"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.830219   -0.557437    0.000000
    0.557437    0.830219    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   33.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.540848 XMAX =   25.540848 XAVE =   25.540848
    YMIN =  -27.246285 YMAX =  -27.246285 YAVE =  -27.246285
    ZMIN =  -23.640580 ZMAX =  -23.640580 ZAVE =  -23.640580
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.5408481"
Evaluating: 25.5408481+3.5
 Parameter: XMAX <- "29.0408481"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.2462846"
Evaluating: -27.2462846+3.5
 Parameter: YMAX <- "-23.7462846"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.6405805"
Evaluating: -23.6405805+3.5
 Parameter: ZMAX <- "-20.1405805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.5408481"
Evaluating: 25.5408481-3.5
 Parameter: XMIN <- "22.0408481"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.2462846"
Evaluating: -27.2462846-3.5
 Parameter: YMIN <- "-30.7462846"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.6405805"
Evaluating: -23.6405805-3.5
 Parameter: ZMIN <- "-27.1405805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.0408481"
 Parameter: XMIN -> "22.0408481"
 Parameter: YMAX -> "-23.7462846"
 Parameter: YMIN -> "-30.7462846"
 Parameter: ZMAX -> "-20.1405805"
 Parameter: ZMIN -> "-27.1405805"
 SELRPN>      3 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      1 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "41" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "41" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "41"
 Parameter: NPOS -> "25"
Evaluating: 41-25
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.844622722"
Evaluating: 62.3546605*(0.844622722-0.5)
 Parameter: XPOS <- "21.4888328"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.558173401"
Evaluating: 62.3546605*(0.558173401-0.5)
 Parameter: YPOS <- "3.62738267"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "2.429764639E-02"
Evaluating: 125.033241*(2.429764639E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-62.4286313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-62.4286313" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.4888328"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.4888328-0
 Parameter: XTRAN <- "21.4888328"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.62738267"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.62738267-0
 Parameter: YTRAN <- "3.62738267"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-62.4286313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -62.4286313-0
 Parameter: ZTRAN <- "-62.4286313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.4888328"
 Parameter: YTRAN -> "3.62738267"
 Parameter: ZTRAN -> "-62.4286313"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    21.488833    3.627383  -62.428631
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213656171"
Evaluating: 0.213656171*360.0
 Parameter: XPHI <- "76.9162216"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620856213"
Evaluating: 0.620856213*360.0
 Parameter: YPHI <- "223.508237"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882671326"
Evaluating: 0.882671326*360.0
 Parameter: ZPHI <- "317.761677"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.4888328"
 Parameter: YPOS -> "3.62738267"
 Parameter: ZPOS -> "-62.4286313"
 Parameter: XPHI -> "76.9162216"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.226376    0.974040
    0.000000   -0.974040    0.226376

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   76.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.4888328"
 Parameter: YPOS -> "3.62738267"
 Parameter: ZPOS -> "-62.4286313"
 Parameter: YPHI -> "223.508237"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.725275    0.000000    0.688459
    0.000000    1.000000    0.000000
   -0.688459    0.000000   -0.725275

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  136.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.4888328"
 Parameter: YPOS -> "3.62738267"
 Parameter: ZPOS -> "-62.4286313"
 Parameter: ZPHI -> "317.761677"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.740355   -0.672216    0.000000
    0.672216    0.740355    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.488833 XMAX =   21.488833 XAVE =   21.488833
    YMIN =    3.627383 YMAX =    3.627383 YAVE =    3.627383
    ZMIN =  -62.428631 ZMAX =  -62.428631 ZAVE =  -62.428631
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.4888328"
Evaluating: 21.4888328+3.5
 Parameter: XMAX <- "24.9888328"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.62738267"
Evaluating: 3.62738267+3.5
 Parameter: YMAX <- "7.12738267"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-62.4286313"
Evaluating: -62.4286313+3.5
 Parameter: ZMAX <- "-58.9286313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.4888328"
Evaluating: 21.4888328-3.5
 Parameter: XMIN <- "17.9888328"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.62738267"
Evaluating: 3.62738267-3.5
 Parameter: YMIN <- "0.12738267"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-62.4286313"
Evaluating: -62.4286313-3.5
 Parameter: ZMIN <- "-65.9286313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.9888328"
 Parameter: XMIN -> "17.9888328"
 Parameter: YMAX -> "7.12738267"
 Parameter: YMIN -> "0.12738267"
 Parameter: ZMAX -> "-58.9286313"
 Parameter: ZMIN -> "-65.9286313"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "42" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "42" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "25"
Evaluating: 42-25
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.261193316"
Evaluating: 62.3546605*(0.261193316-0.5)
 Parameter: XPOS <- "-14.8907097"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.128739801"
Evaluating: 62.3546605*(0.128739801-0.5)
 Parameter: YPOS <- "-23.1498037"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.291422086"
Evaluating: 125.033241*(0.291422086-0.5)+-2.9500243
 Parameter: ZPOS <- "-29.0291969"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.0291969" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.8907097"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.8907097-0
 Parameter: XTRAN <- "-14.8907097"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.1498037"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.1498037-0
 Parameter: YTRAN <- "-23.1498037"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.0291969"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.0291969-0
 Parameter: ZTRAN <- "-29.0291969"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.8907097"
 Parameter: YTRAN -> "-23.1498037"
 Parameter: ZTRAN -> "-29.0291969"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -14.890710  -23.149804  -29.029197
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.603490738"
Evaluating: 0.603490738*360.0
 Parameter: XPHI <- "217.256666"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.66682862E-02"
Evaluating: 7.66682862E-02*360.0
 Parameter: YPHI <- "27.600583"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.884170043"
Evaluating: 0.884170043*360.0
 Parameter: ZPHI <- "318.301215"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.8907097"
 Parameter: YPOS -> "-23.1498037"
 Parameter: ZPOS -> "-29.0291969"
 Parameter: XPHI -> "217.256666"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.795932   -0.605387
    0.000000    0.605387   -0.795932

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  142.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.8907097"
 Parameter: YPOS -> "-23.1498037"
 Parameter: ZPOS -> "-29.0291969"
 Parameter: YPHI -> "27.600583"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.886199    0.000000   -0.463305
    0.000000    1.000000    0.000000
    0.463305    0.000000    0.886199

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   27.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.8907097"
 Parameter: YPOS -> "-23.1498037"
 Parameter: ZPOS -> "-29.0291969"
 Parameter: ZPHI -> "318.301215"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.746652   -0.665215    0.000000
    0.665215    0.746652    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   41.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.890710 XMAX =  -14.890710 XAVE =  -14.890710
    YMIN =  -23.149804 YMAX =  -23.149804 YAVE =  -23.149804
    ZMIN =  -29.029197 ZMAX =  -29.029197 ZAVE =  -29.029197
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.8907097"
Evaluating: -14.8907097+3.5
 Parameter: XMAX <- "-11.3907097"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.1498037"
Evaluating: -23.1498037+3.5
 Parameter: YMAX <- "-19.6498037"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.0291969"
Evaluating: -29.0291969+3.5
 Parameter: ZMAX <- "-25.5291969"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.8907097"
Evaluating: -14.8907097-3.5
 Parameter: XMIN <- "-18.3907097"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.1498037"
Evaluating: -23.1498037-3.5
 Parameter: YMIN <- "-26.6498037"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.0291969"
Evaluating: -29.0291969-3.5
 Parameter: ZMIN <- "-32.5291969"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.3907097"
 Parameter: XMIN -> "-18.3907097"
 Parameter: YMAX -> "-19.6498037"
 Parameter: YMIN -> "-26.6498037"
 Parameter: ZMAX -> "-25.5291969"
 Parameter: ZMIN -> "-32.5291969"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "43" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "43" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "25"
Evaluating: 43-25
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.55065364"
Evaluating: 62.3546605*(0.55065364-0.5)
 Parameter: XPOS <- "3.15849053"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.113767355"
Evaluating: 62.3546605*(0.113767355-0.5)
 Parameter: YPOS <- "-24.0834055"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.984595036"
Evaluating: 125.033241*(0.984595036-0.5)+-2.9500243
 Parameter: ZPOS <- "57.6404636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.6404636" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.6404636" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.15849053"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.15849053-0
 Parameter: XTRAN <- "3.15849053"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.0834055"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.0834055-0
 Parameter: YTRAN <- "-24.0834055"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.6404636"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.6404636-0
 Parameter: ZTRAN <- "57.6404636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.15849053"
 Parameter: YTRAN -> "-24.0834055"
 Parameter: ZTRAN -> "57.6404636"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     3.158491  -24.083406   57.640464
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.459882328"
Evaluating: 0.459882328*360.0
 Parameter: XPHI <- "165.557638"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518227749"
Evaluating: 0.518227749*360.0
 Parameter: YPHI <- "186.56199"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878875367"
Evaluating: 0.878875367*360.0
 Parameter: ZPHI <- "316.395132"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.15849053"
 Parameter: YPOS -> "-24.0834055"
 Parameter: ZPOS -> "57.6404636"
 Parameter: XPHI -> "165.557638"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.968399    0.249406
    0.000000   -0.249406   -0.968399

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  165.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.15849053"
 Parameter: YPOS -> "-24.0834055"
 Parameter: ZPOS -> "57.6404636"
 Parameter: YPHI -> "186.56199"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.993449    0.000000    0.114278
    0.000000    1.000000    0.000000
   -0.114278    0.000000   -0.993449

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.15849053"
 Parameter: YPOS -> "-24.0834055"
 Parameter: ZPOS -> "57.6404636"
 Parameter: ZPHI -> "316.395132"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.724113   -0.689681    0.000000
    0.689681    0.724113    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   43.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.158491 XMAX =    3.158491 XAVE =    3.158491
    YMIN =  -24.083406 YMAX =  -24.083406 YAVE =  -24.083406
    ZMIN =   57.640464 ZMAX =   57.640464 ZAVE =   57.640464
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.15849053"
Evaluating: 3.15849053+3.5
 Parameter: XMAX <- "6.65849053"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.0834055"
Evaluating: -24.0834055+3.5
 Parameter: YMAX <- "-20.5834055"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.6404636"
Evaluating: 57.6404636+3.5
 Parameter: ZMAX <- "61.1404636"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.15849053"
Evaluating: 3.15849053-3.5
 Parameter: XMIN <- "-0.34150947"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.0834055"
Evaluating: -24.0834055-3.5
 Parameter: YMIN <- "-27.5834055"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.6404636"
Evaluating: 57.6404636-3.5
 Parameter: ZMIN <- "54.1404636"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.65849053"
 Parameter: XMIN -> "-0.34150947"
 Parameter: YMAX -> "-20.5834055"
 Parameter: YMIN -> "-27.5834055"
 Parameter: ZMAX -> "61.1404636"
 Parameter: ZMIN -> "54.1404636"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "44" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "44" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "25"
Evaluating: 44-25
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "1.353900843E-02"
Evaluating: 62.3546605*(1.353900843E-02-0.5)
 Parameter: XPOS <- "-30.33311"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.847394455"
Evaluating: 62.3546605*(0.847394455-0.5)
 Parameter: YPOS <- "21.6616633"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.594992725"
Evaluating: 125.033241*(0.594992725-0.5)+-2.9500243
 Parameter: ZPOS <- "8.92722398"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.92722398" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.92722398" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "44" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "25"
Evaluating: 44-25
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.908250362"
Evaluating: 62.3546605*(0.908250362-0.5)
 Parameter: XPOS <- "25.4563127"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "6.055544894E-02"
Evaluating: 62.3546605*(6.055544894E-02-0.5)
 Parameter: YPOS <- "-27.4014158"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.707933425"
Evaluating: 125.033241*(0.707933425-0.5)+-2.9500243
 Parameter: ZPOS <- "23.0485657"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.0485657" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.0485657" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.4563127"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.4563127-0
 Parameter: XTRAN <- "25.4563127"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.4014158"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.4014158-0
 Parameter: YTRAN <- "-27.4014158"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.0485657"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.0485657-0
 Parameter: ZTRAN <- "23.0485657"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.4563127"
 Parameter: YTRAN -> "-27.4014158"
 Parameter: ZTRAN -> "23.0485657"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    25.456313  -27.401416   23.048566
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.304722101"
Evaluating: 0.304722101*360.0
 Parameter: XPHI <- "109.699956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.754042654"
Evaluating: 0.754042654*360.0
 Parameter: YPHI <- "271.455355"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88395983"
Evaluating: 0.88395983*360.0
 Parameter: ZPHI <- "318.225539"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.4563127"
 Parameter: YPOS -> "-27.4014158"
 Parameter: ZPOS -> "23.0485657"
 Parameter: XPHI -> "109.699956"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.337095    0.941471
    0.000000   -0.941471   -0.337095

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  109.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.4563127"
 Parameter: YPOS -> "-27.4014158"
 Parameter: ZPOS -> "23.0485657"
 Parameter: YPHI -> "271.455355"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.025398    0.000000    0.999677
    0.000000    1.000000    0.000000
   -0.999677    0.000000    0.025398

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   88.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.4563127"
 Parameter: YPOS -> "-27.4014158"
 Parameter: ZPOS -> "23.0485657"
 Parameter: ZPHI -> "318.225539"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.745773   -0.666200    0.000000
    0.666200    0.745773    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   41.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.456313 XMAX =   25.456313 XAVE =   25.456313
    YMIN =  -27.401416 YMAX =  -27.401416 YAVE =  -27.401416
    ZMIN =   23.048566 ZMAX =   23.048566 ZAVE =   23.048566
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.4563127"
Evaluating: 25.4563127+3.5
 Parameter: XMAX <- "28.9563127"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.4014158"
Evaluating: -27.4014158+3.5
 Parameter: YMAX <- "-23.9014158"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.0485657"
Evaluating: 23.0485657+3.5
 Parameter: ZMAX <- "26.5485657"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.4563127"
Evaluating: 25.4563127-3.5
 Parameter: XMIN <- "21.9563127"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.4014158"
Evaluating: -27.4014158-3.5
 Parameter: YMIN <- "-30.9014158"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.0485657"
Evaluating: 23.0485657-3.5
 Parameter: ZMIN <- "19.5485657"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.9563127"
 Parameter: XMIN -> "21.9563127"
 Parameter: YMAX -> "-23.9014158"
 Parameter: YMIN -> "-30.9014158"
 Parameter: ZMAX -> "26.5485657"
 Parameter: ZMIN -> "19.5485657"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "45" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "45" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "45"
 Parameter: NPOS -> "25"
Evaluating: 45-25
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "5.85309958E-02"
Evaluating: 62.3546605*(5.85309958E-02-0.5)
 Parameter: XPOS <- "-27.5276499"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.211096571"
Evaluating: 62.3546605*(0.211096571-0.5)
 Parameter: YPOS <- "-18.0144752"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.393288286"
Evaluating: 125.033241*(0.393288286-0.5)+-2.9500243
 Parameter: ZPOS <- "-16.2925358"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.2925358" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.5276499"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.5276499-0
 Parameter: XTRAN <- "-27.5276499"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.0144752"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.0144752-0
 Parameter: YTRAN <- "-18.0144752"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.2925358"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.2925358-0
 Parameter: ZTRAN <- "-16.2925358"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.5276499"
 Parameter: YTRAN -> "-18.0144752"
 Parameter: ZTRAN -> "-16.2925358"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -27.527650  -18.014475  -16.292536
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376845302"
Evaluating: 0.376845302*360.0
 Parameter: XPHI <- "135.664309"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.760417279"
Evaluating: 0.760417279*360.0
 Parameter: YPHI <- "273.75022"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.485694155"
Evaluating: 0.485694155*360.0
 Parameter: ZPHI <- "174.849896"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.5276499"
 Parameter: YPOS -> "-18.0144752"
 Parameter: ZPOS -> "-16.2925358"
 Parameter: XPHI -> "135.664309"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.715258    0.698861
    0.000000   -0.698861   -0.715258

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  135.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.5276499"
 Parameter: YPOS -> "-18.0144752"
 Parameter: ZPOS -> "-16.2925358"
 Parameter: YPHI -> "273.75022"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.065407    0.000000    0.997859
    0.000000    1.000000    0.000000
   -0.997859    0.000000    0.065407

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   86.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.5276499"
 Parameter: YPOS -> "-18.0144752"
 Parameter: ZPOS -> "-16.2925358"
 Parameter: ZPHI -> "174.849896"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.995963    0.089765    0.000000
   -0.089765   -0.995963    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  174.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.527650 XMAX =  -27.527650 XAVE =  -27.527650
    YMIN =  -18.014475 YMAX =  -18.014475 YAVE =  -18.014475
    ZMIN =  -16.292536 ZMAX =  -16.292536 ZAVE =  -16.292536
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.5276499"
Evaluating: -27.5276499+3.5
 Parameter: XMAX <- "-24.0276499"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.0144752"
Evaluating: -18.0144752+3.5
 Parameter: YMAX <- "-14.5144752"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.2925358"
Evaluating: -16.2925358+3.5
 Parameter: ZMAX <- "-12.7925358"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.5276499"
Evaluating: -27.5276499-3.5
 Parameter: XMIN <- "-31.0276499"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.0144752"
Evaluating: -18.0144752-3.5
 Parameter: YMIN <- "-21.5144752"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.2925358"
Evaluating: -16.2925358-3.5
 Parameter: ZMIN <- "-19.7925358"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.0276499"
 Parameter: XMIN -> "-31.0276499"
 Parameter: YMAX -> "-14.5144752"
 Parameter: YMIN -> "-21.5144752"
 Parameter: ZMAX -> "-12.7925358"
 Parameter: ZMIN -> "-19.7925358"
 SELRPN>     16 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      9 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15598 NEG      CLA      20       CLA     -**** MEMB     POPC     64       C21           3.4589
15598 NEG      CLA      20       CLA     -**** MEMB     POPC     64       O22           2.2790
15598 NEG      CLA      20       CLA     -**** MEMB     POPC     78       P             3.0760
15598 NEG      CLA      20       CLA     -**** MEMB     POPC     78       O13           1.6206
15598 NEG      CLA      20       CLA     -**** MEMB     POPC     78       O11           3.9047
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "45" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "45"
 Parameter: NPOS -> "25"
Evaluating: 45-25
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.788507603"
Evaluating: 62.3546605*(0.788507603-0.5)
 Parameter: XPOS <- "17.9897936"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.864624522"
Evaluating: 62.3546605*(0.864624522-0.5)
 Parameter: YPOS <- "22.7360383"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.125029787"
Evaluating: 125.033241*(0.125029787-0.5)+-2.9500243
 Parameter: ZPOS <- "-49.8337653"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.8337653" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.527650 XMAX =  -27.527650 XAVE =  -27.527650
    YMIN =  -18.014475 YMAX =  -18.014475 YAVE =  -18.014475
    ZMIN =  -16.292536 ZMAX =  -16.292536 ZAVE =  -16.292536
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.9897936"
 RDCMND substituted energy or value "?XAVE" to "-27.5276499"
Evaluating: 17.9897936--27.5276499
 Parameter: XTRAN <- "45.5174435"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.7360383"
 RDCMND substituted energy or value "?YAVE" to "-18.0144752"
Evaluating: 22.7360383--18.0144752
 Parameter: YTRAN <- "40.7505135"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.8337653"
 RDCMND substituted energy or value "?ZAVE" to "-16.2925358"
Evaluating: -49.8337653--16.2925358
 Parameter: ZTRAN <- "-33.5412295"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.5174435"
 Parameter: YTRAN -> "40.7505135"
 Parameter: ZTRAN -> "-33.5412295"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    45.517443   40.750513  -33.541230
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.219237998"
Evaluating: 0.219237998*360.0
 Parameter: XPHI <- "78.9256793"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.351293557E-02"
Evaluating: 6.351293557E-02*360.0
 Parameter: YPHI <- "22.8646568"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.916959914"
Evaluating: 0.916959914*360.0
 Parameter: ZPHI <- "330.105569"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.9897936"
 Parameter: YPOS -> "22.7360383"
 Parameter: ZPOS -> "-49.8337653"
 Parameter: XPHI -> "78.9256793"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.192082    0.981379
    0.000000   -0.981379    0.192082

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   78.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.9897936"
 Parameter: YPOS -> "22.7360383"
 Parameter: ZPOS -> "-49.8337653"
 Parameter: YPHI -> "22.8646568"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.921425    0.000000   -0.388556
    0.000000    1.000000    0.000000
    0.388556    0.000000    0.921425

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.9897936"
 Parameter: YPOS -> "22.7360383"
 Parameter: ZPOS -> "-49.8337653"
 Parameter: ZPHI -> "330.105569"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.866945   -0.498403    0.000000
    0.498403    0.866945    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.989794 XMAX =   17.989794 XAVE =   17.989794
    YMIN =   22.736038 YMAX =   22.736038 YAVE =   22.736038
    ZMIN =  -49.833765 ZMAX =  -49.833765 ZAVE =  -49.833765
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.9897936"
Evaluating: 17.9897936+3.5
 Parameter: XMAX <- "21.4897936"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.7360383"
Evaluating: 22.7360383+3.5
 Parameter: YMAX <- "26.2360383"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.8337653"
Evaluating: -49.8337653+3.5
 Parameter: ZMAX <- "-46.3337653"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.9897936"
Evaluating: 17.9897936-3.5
 Parameter: XMIN <- "14.4897936"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.7360383"
Evaluating: 22.7360383-3.5
 Parameter: YMIN <- "19.2360383"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.8337653"
Evaluating: -49.8337653-3.5
 Parameter: ZMIN <- "-53.3337653"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.4897936"
 Parameter: XMIN -> "14.4897936"
 Parameter: YMAX -> "26.2360383"
 Parameter: YMIN -> "19.2360383"
 Parameter: ZMAX -> "-46.3337653"
 Parameter: ZMIN -> "-53.3337653"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "46" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "46" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "46"
 Parameter: NPOS -> "25"
Evaluating: 46-25
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.223807485"
Evaluating: 62.3546605*(0.223807485-0.5)
 Parameter: XPOS <- "-17.2218905"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.196966316"
Evaluating: 62.3546605*(0.196966316-0.5)
 Parameter: YPOS <- "-18.8955625"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.453935676"
Evaluating: 125.033241*(0.453935676-0.5)+-2.9500243
 Parameter: ZPOS <- "-8.70959602"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.70959602" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.70959602" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "46" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "46"
 Parameter: NPOS -> "25"
Evaluating: 46-25
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.615799712"
Evaluating: 62.3546605*(0.615799712-0.5)
 Parameter: XPOS <- "7.22065173"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.909944784"
Evaluating: 62.3546605*(0.909944784-0.5)
 Parameter: YPOS <- "25.5619678"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "1.965775866E-02"
Evaluating: 125.033241*(1.965775866E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-63.0087715"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-63.0087715" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.22065173"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.22065173-0
 Parameter: XTRAN <- "7.22065173"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.5619678"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.5619678-0
 Parameter: YTRAN <- "25.5619678"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.0087715"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -63.0087715-0
 Parameter: ZTRAN <- "-63.0087715"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.22065173"
 Parameter: YTRAN -> "25.5619678"
 Parameter: ZTRAN -> "-63.0087715"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     7.220652   25.561968  -63.008772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.11853823"
Evaluating: 0.11853823*360.0
 Parameter: XPHI <- "42.6737628"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.105249312"
Evaluating: 0.105249312*360.0
 Parameter: YPHI <- "37.8897523"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93231464"
Evaluating: 0.93231464*360.0
 Parameter: ZPHI <- "335.63327"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.22065173"
 Parameter: YPOS -> "25.5619678"
 Parameter: ZPOS -> "-63.0087715"
 Parameter: XPHI -> "42.6737628"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.735225    0.677823
    0.000000   -0.677823    0.735225

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   42.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.22065173"
 Parameter: YPOS -> "25.5619678"
 Parameter: ZPOS -> "-63.0087715"
 Parameter: YPHI -> "37.8897523"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.789194    0.000000   -0.614144
    0.000000    1.000000    0.000000
    0.614144    0.000000    0.789194

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   37.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.22065173"
 Parameter: YPOS -> "25.5619678"
 Parameter: ZPOS -> "-63.0087715"
 Parameter: ZPHI -> "335.63327"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.910923   -0.412576    0.000000
    0.412576    0.910923    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   24.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.220652 XMAX =    7.220652 XAVE =    7.220652
    YMIN =   25.561968 YMAX =   25.561968 YAVE =   25.561968
    ZMIN =  -63.008772 ZMAX =  -63.008772 ZAVE =  -63.008772
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.22065173"
Evaluating: 7.22065173+3.5
 Parameter: XMAX <- "10.7206517"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.5619678"
Evaluating: 25.5619678+3.5
 Parameter: YMAX <- "29.0619678"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.0087715"
Evaluating: -63.0087715+3.5
 Parameter: ZMAX <- "-59.5087715"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.22065173"
Evaluating: 7.22065173-3.5
 Parameter: XMIN <- "3.72065173"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.5619678"
Evaluating: 25.5619678-3.5
 Parameter: YMIN <- "22.0619678"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.0087715"
Evaluating: -63.0087715-3.5
 Parameter: ZMIN <- "-66.5087715"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.7206517"
 Parameter: XMIN -> "3.72065173"
 Parameter: YMAX -> "29.0619678"
 Parameter: YMIN -> "22.0619678"
 Parameter: ZMAX -> "-59.5087715"
 Parameter: ZMIN -> "-66.5087715"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "47" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "47" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "25"
Evaluating: 47-25
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.524522908"
Evaluating: 62.3546605*(0.524522908-0.5)
 Parameter: XPOS <- "1.5291176"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.768082521"
Evaluating: 62.3546605*(0.768082521-0.5)
 Parameter: YPOS <- "16.7161946"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.298660631"
Evaluating: 125.033241*(0.298660631-0.5)+-2.9500243
 Parameter: ZPOS <- "-28.1241381"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.1241381" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.5291176"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.5291176-0
 Parameter: XTRAN <- "1.5291176"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.7161946"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.7161946-0
 Parameter: YTRAN <- "16.7161946"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.1241381"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.1241381-0
 Parameter: ZTRAN <- "-28.1241381"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.5291176"
 Parameter: YTRAN -> "16.7161946"
 Parameter: ZTRAN -> "-28.1241381"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     1.529118   16.716195  -28.124138
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736769959"
Evaluating: 0.736769959*360.0
 Parameter: XPHI <- "265.237185"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571096552"
Evaluating: 0.571096552*360.0
 Parameter: YPHI <- "205.594759"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.579074267"
Evaluating: 0.579074267*360.0
 Parameter: ZPHI <- "208.466736"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.5291176"
 Parameter: YPOS -> "16.7161946"
 Parameter: ZPOS -> "-28.1241381"
 Parameter: XPHI -> "265.237185"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.083031   -0.996547
    0.000000    0.996547   -0.083031

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.5291176"
 Parameter: YPOS -> "16.7161946"
 Parameter: ZPOS -> "-28.1241381"
 Parameter: YPHI -> "205.594759"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.901872    0.000000    0.432003
    0.000000    1.000000    0.000000
   -0.432003    0.000000   -0.901872

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.5291176"
 Parameter: YPOS -> "16.7161946"
 Parameter: ZPOS -> "-28.1241381"
 Parameter: ZPHI -> "208.466736"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.879094   -0.476648    0.000000
    0.476648   -0.879094    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  151.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.529118 XMAX =    1.529118 XAVE =    1.529118
    YMIN =   16.716195 YMAX =   16.716195 YAVE =   16.716195
    ZMIN =  -28.124138 ZMAX =  -28.124138 ZAVE =  -28.124138
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.5291176"
Evaluating: 1.5291176+3.5
 Parameter: XMAX <- "5.0291176"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.7161946"
Evaluating: 16.7161946+3.5
 Parameter: YMAX <- "20.2161946"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.1241381"
Evaluating: -28.1241381+3.5
 Parameter: ZMAX <- "-24.6241381"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.5291176"
Evaluating: 1.5291176-3.5
 Parameter: XMIN <- "-1.9708824"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.7161946"
Evaluating: 16.7161946-3.5
 Parameter: YMIN <- "13.2161946"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.1241381"
Evaluating: -28.1241381-3.5
 Parameter: ZMIN <- "-31.6241381"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.0291176"
 Parameter: XMIN -> "-1.9708824"
 Parameter: YMAX -> "20.2161946"
 Parameter: YMIN -> "13.2161946"
 Parameter: ZMAX -> "-24.6241381"
 Parameter: ZMIN -> "-31.6241381"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "48" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "48" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "48"
 Parameter: NPOS -> "25"
Evaluating: 48-25
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.168827141"
Evaluating: 62.3546605*(0.168827141-0.5)
 Parameter: XPOS <- "-20.6501712"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.386937077"
Evaluating: 62.3546605*(0.386937077-0.5)
 Parameter: YPOS <- "-7.05000018"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.993332626"
Evaluating: 125.033241*(0.993332626-0.5)+-2.9500243
 Parameter: ZPOS <- "58.7329528"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.7329528" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.7329528" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.6501712"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.6501712-0
 Parameter: XTRAN <- "-20.6501712"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.05000018"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.05000018-0
 Parameter: YTRAN <- "-7.05000018"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.7329528"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 58.7329528-0
 Parameter: ZTRAN <- "58.7329528"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.6501712"
 Parameter: YTRAN -> "-7.05000018"
 Parameter: ZTRAN -> "58.7329528"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -20.650171   -7.050000   58.732953
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.982740729E-02"
Evaluating: 6.982740729E-02*360.0
 Parameter: XPHI <- "25.1378666"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.794945448"
Evaluating: 0.794945448*360.0
 Parameter: YPHI <- "286.180361"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917887258"
Evaluating: 0.917887258*360.0
 Parameter: ZPHI <- "330.439413"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.6501712"
 Parameter: YPOS -> "-7.05000018"
 Parameter: ZPOS -> "58.7329528"
 Parameter: XPHI -> "25.1378666"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.905288    0.424798
    0.000000   -0.424798    0.905288

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   25.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.6501712"
 Parameter: YPOS -> "-7.05000018"
 Parameter: ZPOS -> "58.7329528"
 Parameter: YPHI -> "286.180361"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.278662    0.000000    0.960389
    0.000000    1.000000    0.000000
   -0.960389    0.000000    0.278662

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   73.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.6501712"
 Parameter: YPOS -> "-7.05000018"
 Parameter: ZPOS -> "58.7329528"
 Parameter: ZPHI -> "330.439413"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.869834   -0.493344    0.000000
    0.493344    0.869834    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.650171 XMAX =  -20.650171 XAVE =  -20.650171
    YMIN =   -7.050000 YMAX =   -7.050000 YAVE =   -7.050000
    ZMIN =   58.732953 ZMAX =   58.732953 ZAVE =   58.732953
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.6501712"
Evaluating: -20.6501712+3.5
 Parameter: XMAX <- "-17.1501712"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.05000018"
Evaluating: -7.05000018+3.5
 Parameter: YMAX <- "-3.55000018"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.7329528"
Evaluating: 58.7329528+3.5
 Parameter: ZMAX <- "62.2329528"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.6501712"
Evaluating: -20.6501712-3.5
 Parameter: XMIN <- "-24.1501712"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.05000018"
Evaluating: -7.05000018-3.5
 Parameter: YMIN <- "-10.5500002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.7329528"
Evaluating: 58.7329528-3.5
 Parameter: ZMIN <- "55.2329528"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.1501712"
 Parameter: XMIN -> "-24.1501712"
 Parameter: YMAX -> "-3.55000018"
 Parameter: YMIN -> "-10.5500002"
 Parameter: ZMAX -> "62.2329528"
 Parameter: ZMIN -> "55.2329528"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "49" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "49" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "49"
 Parameter: NPOS -> "25"
Evaluating: 49-25
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.301477957"
Evaluating: 62.3546605*(0.301477957-0.5)
 Parameter: XPOS <- "-12.3787746"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.320559358"
Evaluating: 62.3546605*(0.320559358-0.5)
 Parameter: YPOS <- "-11.1889603"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.655966181"
Evaluating: 125.033241*(0.655966181-0.5)+-2.9500243
 Parameter: ZPOS <- "16.5509328"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.5509328" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.5509328" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.3787746"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.3787746-0
 Parameter: XTRAN <- "-12.3787746"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.1889603"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.1889603-0
 Parameter: YTRAN <- "-11.1889603"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.5509328"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.5509328-0
 Parameter: ZTRAN <- "16.5509328"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.3787746"
 Parameter: YTRAN -> "-11.1889603"
 Parameter: ZTRAN -> "16.5509328"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -12.378775  -11.188960   16.550933
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.068911851E-02"
Evaluating: 1.068911851E-02*360.0
 Parameter: XPHI <- "3.84808266"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102104779"
Evaluating: 0.102104779*360.0
 Parameter: YPHI <- "36.7577204"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.206455057"
Evaluating: 0.206455057*360.0
 Parameter: ZPHI <- "74.3238205"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.3787746"
 Parameter: YPOS -> "-11.1889603"
 Parameter: ZPOS -> "16.5509328"
 Parameter: XPHI -> "3.84808266"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997745    0.067111
    0.000000   -0.067111    0.997745

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.3787746"
 Parameter: YPOS -> "-11.1889603"
 Parameter: ZPOS -> "16.5509328"
 Parameter: YPHI -> "36.7577204"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.801173    0.000000   -0.598433
    0.000000    1.000000    0.000000
    0.598433    0.000000    0.801173

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.3787746"
 Parameter: YPOS -> "-11.1889603"
 Parameter: ZPOS -> "16.5509328"
 Parameter: ZPHI -> "74.3238205"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.270200    0.962804    0.000000
   -0.962804    0.270200    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   74.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.378775 XMAX =  -12.378775 XAVE =  -12.378775
    YMIN =  -11.188960 YMAX =  -11.188960 YAVE =  -11.188960
    ZMIN =   16.550933 ZMAX =   16.550933 ZAVE =   16.550933
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.3787746"
Evaluating: -12.3787746+3.5
 Parameter: XMAX <- "-8.8787746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.1889603"
Evaluating: -11.1889603+3.5
 Parameter: YMAX <- "-7.6889603"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.5509328"
Evaluating: 16.5509328+3.5
 Parameter: ZMAX <- "20.0509328"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.3787746"
Evaluating: -12.3787746-3.5
 Parameter: XMIN <- "-15.8787746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.1889603"
Evaluating: -11.1889603-3.5
 Parameter: YMIN <- "-14.6889603"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.5509328"
Evaluating: 16.5509328-3.5
 Parameter: ZMIN <- "13.0509328"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.8787746"
 Parameter: XMIN -> "-15.8787746"
 Parameter: YMAX -> "-7.6889603"
 Parameter: YMIN -> "-14.6889603"
 Parameter: ZMAX -> "20.0509328"
 Parameter: ZMIN -> "13.0509328"
 SELRPN>     34 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>     13 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15602 NEG      CLA      24       CLA     -5504 MEMB     POPC     6        N             2.8592
15602 NEG      CLA      24       CLA     -5505 MEMB     POPC     6        C12           3.3648
15602 NEG      CLA      24       CLA     -5508 MEMB     POPC     6        C13           1.8647
15602 NEG      CLA      24       CLA     -5516 MEMB     POPC     6        C15           3.1754
15602 NEG      CLA      24       CLA     -5520 MEMB     POPC     6        C11           3.0529
15602 NEG      CLA      24       CLA     -5526 MEMB     POPC     6        O12           3.1561
15602 NEG      CLA      24       CLA     -5534 MEMB     POPC     6        C21           3.8637
15602 NEG      CLA      24       CLA     -5536 MEMB     POPC     6        C22           2.5264
15602 NEG      CLA      24       CLA     -5548 MEMB     POPC     6        C23           3.1654
15602 NEG      CLA      24       CLA     -5551 MEMB     POPC     6        C24           3.5304
15602 NEG      CLA      24       CLA     -5554 MEMB     POPC     6        C25           3.2420
15602 NEG      CLA      24       CLA     -5557 MEMB     POPC     6        C26           3.9826
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "49" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "49"
 Parameter: NPOS -> "25"
Evaluating: 49-25
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.141126255"
Evaluating: 62.3546605*(0.141126255-0.5)
 Parameter: XPOS <- "-22.3774505"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.288344301"
Evaluating: 62.3546605*(0.288344301-0.5)
 Parameter: YPOS <- "-13.1977193"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.284915079"
Evaluating: 125.033241*(0.284915079-0.5)+-2.9500243
 Parameter: ZPOS <- "-29.8427891"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.8427891" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.378775 XMAX =  -12.378775 XAVE =  -12.378775
    YMIN =  -11.188960 YMAX =  -11.188960 YAVE =  -11.188960
    ZMIN =   16.550933 ZMAX =   16.550933 ZAVE =   16.550933
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.3774505"
 RDCMND substituted energy or value "?XAVE" to "-12.3787746"
Evaluating: -22.3774505--12.3787746
 Parameter: XTRAN <- "-9.9986759"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.1977193"
 RDCMND substituted energy or value "?YAVE" to "-11.1889603"
Evaluating: -13.1977193--11.1889603
 Parameter: YTRAN <- "-2.008759"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.8427891"
 RDCMND substituted energy or value "?ZAVE" to "16.5509328"
Evaluating: -29.8427891-16.5509328
 Parameter: ZTRAN <- "-46.3937219"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.9986759"
 Parameter: YTRAN -> "-2.008759"
 Parameter: ZTRAN -> "-46.3937219"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    -9.998676   -2.008759  -46.393722
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.952384605"
Evaluating: 0.952384605*360.0
 Parameter: XPHI <- "342.858458"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581562127"
Evaluating: 0.581562127*360.0
 Parameter: YPHI <- "209.362366"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.505455784"
Evaluating: 0.505455784*360.0
 Parameter: ZPHI <- "181.964082"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.3774505"
 Parameter: YPOS -> "-13.1977193"
 Parameter: ZPOS -> "-29.8427891"
 Parameter: XPHI -> "342.858458"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.955580   -0.294733
    0.000000    0.294733    0.955580

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.3774505"
 Parameter: YPOS -> "-13.1977193"
 Parameter: ZPOS -> "-29.8427891"
 Parameter: YPHI -> "209.362366"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.871536    0.000000    0.490331
    0.000000    1.000000    0.000000
   -0.490331    0.000000   -0.871536

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  150.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.3774505"
 Parameter: YPOS -> "-13.1977193"
 Parameter: ZPOS -> "-29.8427891"
 Parameter: ZPHI -> "181.964082"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.999413   -0.034273    0.000000
    0.034273   -0.999413    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  178.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.377450 XMAX =  -22.377450 XAVE =  -22.377450
    YMIN =  -13.197719 YMAX =  -13.197719 YAVE =  -13.197719
    ZMIN =  -29.842789 ZMAX =  -29.842789 ZAVE =  -29.842789
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.3774505"
Evaluating: -22.3774505+3.5
 Parameter: XMAX <- "-18.8774505"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.1977193"
Evaluating: -13.1977193+3.5
 Parameter: YMAX <- "-9.6977193"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.8427891"
Evaluating: -29.8427891+3.5
 Parameter: ZMAX <- "-26.3427891"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.3774505"
Evaluating: -22.3774505-3.5
 Parameter: XMIN <- "-25.8774505"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.1977193"
Evaluating: -13.1977193-3.5
 Parameter: YMIN <- "-16.6977193"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.8427891"
Evaluating: -29.8427891-3.5
 Parameter: ZMIN <- "-33.3427891"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.8774505"
 Parameter: XMIN -> "-25.8774505"
 Parameter: YMAX -> "-9.6977193"
 Parameter: YMIN -> "-16.6977193"
 Parameter: ZMAX -> "-26.3427891"
 Parameter: ZMIN -> "-33.3427891"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "50" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "50" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "50"
 Parameter: NPOS -> "25"
Evaluating: 50-25
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.797259851"
Evaluating: 62.3546605*(0.797259851-0.5)
 Parameter: XPOS <- "18.5355371"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.472417992"
Evaluating: 62.3546605*(0.472417992-0.5)
 Parameter: YPOS <- "-1.71986674"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.921549417"
Evaluating: 125.033241*(0.921549417-0.5)+-2.9500243
 Parameter: ZPOS <- "49.7576655"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.7576655" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.7576655" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.5355371"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.5355371-0
 Parameter: XTRAN <- "18.5355371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.71986674"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.71986674-0
 Parameter: YTRAN <- "-1.71986674"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.7576655"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.7576655-0
 Parameter: ZTRAN <- "49.7576655"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.5355371"
 Parameter: YTRAN -> "-1.71986674"
 Parameter: ZTRAN -> "49.7576655"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    18.535537   -1.719867   49.757666
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752466674"
Evaluating: 0.752466674*360.0
 Parameter: XPHI <- "270.888003"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.4556092"
Evaluating: 0.4556092*360.0
 Parameter: YPHI <- "164.019312"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943168028"
Evaluating: 0.943168028*360.0
 Parameter: ZPHI <- "339.54049"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.5355371"
 Parameter: YPOS -> "-1.71986674"
 Parameter: ZPOS -> "49.7576655"
 Parameter: XPHI -> "270.888003"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.015498   -0.999880
    0.000000    0.999880    0.015498

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.5355371"
 Parameter: YPOS -> "-1.71986674"
 Parameter: ZPOS -> "49.7576655"
 Parameter: YPHI -> "164.019312"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.961355    0.000000   -0.275313
    0.000000    1.000000    0.000000
    0.275313    0.000000   -0.961355

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.5355371"
 Parameter: YPOS -> "-1.71986674"
 Parameter: ZPOS -> "49.7576655"
 Parameter: ZPHI -> "339.54049"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.936919   -0.349545    0.000000
    0.349545    0.936919    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.535537 XMAX =   18.535537 XAVE =   18.535537
    YMIN =   -1.719867 YMAX =   -1.719867 YAVE =   -1.719867
    ZMIN =   49.757666 ZMAX =   49.757666 ZAVE =   49.757666
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.5355371"
Evaluating: 18.5355371+3.5
 Parameter: XMAX <- "22.0355371"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.71986674"
Evaluating: -1.71986674+3.5
 Parameter: YMAX <- "1.78013326"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.7576655"
Evaluating: 49.7576655+3.5
 Parameter: ZMAX <- "53.2576655"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.5355371"
Evaluating: 18.5355371-3.5
 Parameter: XMIN <- "15.0355371"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.71986674"
Evaluating: -1.71986674-3.5
 Parameter: YMIN <- "-5.21986674"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.7576655"
Evaluating: 49.7576655-3.5
 Parameter: ZMIN <- "46.2576655"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.0355371"
 Parameter: XMIN -> "15.0355371"
 Parameter: YMAX -> "1.78013326"
 Parameter: YMIN -> "-5.21986674"
 Parameter: ZMAX -> "53.2576655"
 Parameter: ZMIN -> "46.2576655"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "51" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "51" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "51"
 Parameter: NPOS -> "25"
Evaluating: 51-25
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.219326574"
Evaluating: 62.3546605*(0.219326574-0.5)
 Parameter: XPOS <- "-17.5012962"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.47167056"
Evaluating: 62.3546605*(0.47167056-0.5)
 Parameter: YPOS <- "-1.76647261"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.23195395"
Evaluating: 125.033241*(0.23195395-0.5)+-2.9500243
 Parameter: ZPOS <- "-36.4646907"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.4646907" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.5012962"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.5012962-0
 Parameter: XTRAN <- "-17.5012962"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.76647261"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.76647261-0
 Parameter: YTRAN <- "-1.76647261"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.4646907"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.4646907-0
 Parameter: ZTRAN <- "-36.4646907"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.5012962"
 Parameter: YTRAN -> "-1.76647261"
 Parameter: ZTRAN -> "-36.4646907"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -17.501296   -1.766473  -36.464691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.402431659"
Evaluating: 0.402431659*360.0
 Parameter: XPHI <- "144.875397"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101114446"
Evaluating: 0.101114446*360.0
 Parameter: YPHI <- "36.4012006"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.539210054"
Evaluating: 0.539210054*360.0
 Parameter: ZPHI <- "194.115619"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.5012962"
 Parameter: YPOS -> "-1.76647261"
 Parameter: ZPOS -> "-36.4646907"
 Parameter: XPHI -> "144.875397"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.817903    0.575357
    0.000000   -0.575357   -0.817903

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  144.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.5012962"
 Parameter: YPOS -> "-1.76647261"
 Parameter: ZPOS -> "-36.4646907"
 Parameter: YPHI -> "36.4012006"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.804881    0.000000   -0.593436
    0.000000    1.000000    0.000000
    0.593436    0.000000    0.804881

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.5012962"
 Parameter: YPOS -> "-1.76647261"
 Parameter: ZPOS -> "-36.4646907"
 Parameter: ZPHI -> "194.115619"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.969806   -0.243879    0.000000
    0.243879   -0.969806    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.501296 XMAX =  -17.501296 XAVE =  -17.501296
    YMIN =   -1.766473 YMAX =   -1.766473 YAVE =   -1.766473
    ZMIN =  -36.464691 ZMAX =  -36.464691 ZAVE =  -36.464691
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.5012962"
Evaluating: -17.5012962+3.5
 Parameter: XMAX <- "-14.0012962"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.76647261"
Evaluating: -1.76647261+3.5
 Parameter: YMAX <- "1.73352739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.4646907"
Evaluating: -36.4646907+3.5
 Parameter: ZMAX <- "-32.9646907"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.5012962"
Evaluating: -17.5012962-3.5
 Parameter: XMIN <- "-21.0012962"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.76647261"
Evaluating: -1.76647261-3.5
 Parameter: YMIN <- "-5.26647261"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.4646907"
Evaluating: -36.4646907-3.5
 Parameter: ZMIN <- "-39.9646907"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.0012962"
 Parameter: XMIN -> "-21.0012962"
 Parameter: YMAX -> "1.73352739"
 Parameter: YMIN -> "-5.26647261"
 Parameter: ZMAX -> "-32.9646907"
 Parameter: ZMIN -> "-39.9646907"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "52" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "52" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "25"
Evaluating: 52-25
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.292697918"
Evaluating: 62.3546605*(0.292697918-0.5)
 Parameter: XPOS <- "-12.9262509"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.58179612"
Evaluating: 62.3546605*(0.58179612-0.5)
 Parameter: YPOS <- "5.10036929"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.293296356"
Evaluating: 125.033241*(0.293296356-0.5)+-2.9500243
 Parameter: ZPOS <- "-28.7948508"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.7948508" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.9262509"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.9262509-0
 Parameter: XTRAN <- "-12.9262509"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.10036929"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.10036929-0
 Parameter: YTRAN <- "5.10036929"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.7948508"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.7948508-0
 Parameter: ZTRAN <- "-28.7948508"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.9262509"
 Parameter: YTRAN -> "5.10036929"
 Parameter: ZTRAN -> "-28.7948508"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -12.926251    5.100369  -28.794851
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.191724197"
Evaluating: 0.191724197*360.0
 Parameter: XPHI <- "69.0207109"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.508437426"
Evaluating: 0.508437426*360.0
 Parameter: YPHI <- "183.037473"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.743993488E-02"
Evaluating: 2.743993488E-02*360.0
 Parameter: ZPHI <- "9.87837656"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.9262509"
 Parameter: YPOS -> "5.10036929"
 Parameter: ZPOS -> "-28.7948508"
 Parameter: XPHI -> "69.0207109"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.358030    0.933710
    0.000000   -0.933710    0.358030

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.9262509"
 Parameter: YPOS -> "5.10036929"
 Parameter: ZPOS -> "-28.7948508"
 Parameter: YPHI -> "183.037473"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.998595    0.000000    0.052989
    0.000000    1.000000    0.000000
   -0.052989    0.000000   -0.998595

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  176.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.9262509"
 Parameter: YPOS -> "5.10036929"
 Parameter: ZPOS -> "-28.7948508"
 Parameter: ZPHI -> "9.87837656"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.985174    0.171557    0.000000
   -0.171557    0.985174    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    9.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.926251 XMAX =  -12.926251 XAVE =  -12.926251
    YMIN =    5.100369 YMAX =    5.100369 YAVE =    5.100369
    ZMIN =  -28.794851 ZMAX =  -28.794851 ZAVE =  -28.794851
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.9262509"
Evaluating: -12.9262509+3.5
 Parameter: XMAX <- "-9.4262509"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.10036929"
Evaluating: 5.10036929+3.5
 Parameter: YMAX <- "8.60036929"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.7948508"
Evaluating: -28.7948508+3.5
 Parameter: ZMAX <- "-25.2948508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.9262509"
Evaluating: -12.9262509-3.5
 Parameter: XMIN <- "-16.4262509"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.10036929"
Evaluating: 5.10036929-3.5
 Parameter: YMIN <- "1.60036929"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.7948508"
Evaluating: -28.7948508-3.5
 Parameter: ZMIN <- "-32.2948508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.4262509"
 Parameter: XMIN -> "-16.4262509"
 Parameter: YMAX -> "8.60036929"
 Parameter: YMIN -> "1.60036929"
 Parameter: ZMAX -> "-25.2948508"
 Parameter: ZMIN -> "-32.2948508"
 SELRPN>      5 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      2 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15605 NEG      CLA      27       CLA     -4673 PROA     GLN      297      CD            3.9274
15605 NEG      CLA      27       CLA     -4674 PROA     GLN      297      OE1           3.7035
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "52" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "25"
Evaluating: 52-25
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.838222691"
Evaluating: 62.3546605*(0.838222691-0.5)
 Parameter: XPOS <- "21.0897611"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.288775924"
Evaluating: 62.3546605*(0.288775924-0.5)
 Parameter: YPOS <- "-13.1708055"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "6.75035215E-02"
Evaluating: 125.033241*(6.75035215E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-57.0264607"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.0264607" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.926251 XMAX =  -12.926251 XAVE =  -12.926251
    YMIN =    5.100369 YMAX =    5.100369 YAVE =    5.100369
    ZMIN =  -28.794851 ZMAX =  -28.794851 ZAVE =  -28.794851
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.0897611"
 RDCMND substituted energy or value "?XAVE" to "-12.9262509"
Evaluating: 21.0897611--12.9262509
 Parameter: XTRAN <- "34.016012"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.1708055"
 RDCMND substituted energy or value "?YAVE" to "5.10036929"
Evaluating: -13.1708055-5.10036929
 Parameter: YTRAN <- "-18.2711748"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.0264607"
 RDCMND substituted energy or value "?ZAVE" to "-28.7948508"
Evaluating: -57.0264607--28.7948508
 Parameter: ZTRAN <- "-28.2316099"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.016012"
 Parameter: YTRAN -> "-18.2711748"
 Parameter: ZTRAN -> "-28.2316099"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    34.016012  -18.271175  -28.231610
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819396236"
Evaluating: 0.819396236*360.0
 Parameter: XPHI <- "294.982645"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.524430737"
Evaluating: 0.524430737*360.0
 Parameter: YPHI <- "188.795065"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548688149"
Evaluating: 0.548688149*360.0
 Parameter: ZPHI <- "197.527734"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.0897611"
 Parameter: YPOS -> "-13.1708055"
 Parameter: ZPOS -> "-57.0264607"
 Parameter: XPHI -> "294.982645"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.422344   -0.906436
    0.000000    0.906436    0.422344

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.0897611"
 Parameter: YPOS -> "-13.1708055"
 Parameter: ZPOS -> "-57.0264607"
 Parameter: YPHI -> "188.795065"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.988242    0.000000    0.152901
    0.000000    1.000000    0.000000
   -0.152901    0.000000   -0.988242

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  171.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.0897611"
 Parameter: YPOS -> "-13.1708055"
 Parameter: ZPOS -> "-57.0264607"
 Parameter: ZPHI -> "197.527734"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.953571   -0.301167    0.000000
    0.301167   -0.953571    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  162.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.089761 XMAX =   21.089761 XAVE =   21.089761
    YMIN =  -13.170805 YMAX =  -13.170805 YAVE =  -13.170805
    ZMIN =  -57.026461 ZMAX =  -57.026461 ZAVE =  -57.026461
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.0897611"
Evaluating: 21.0897611+3.5
 Parameter: XMAX <- "24.5897611"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.1708055"
Evaluating: -13.1708055+3.5
 Parameter: YMAX <- "-9.6708055"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.0264607"
Evaluating: -57.0264607+3.5
 Parameter: ZMAX <- "-53.5264607"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.0897611"
Evaluating: 21.0897611-3.5
 Parameter: XMIN <- "17.5897611"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.1708055"
Evaluating: -13.1708055-3.5
 Parameter: YMIN <- "-16.6708055"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.0264607"
Evaluating: -57.0264607-3.5
 Parameter: ZMIN <- "-60.5264607"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.5897611"
 Parameter: XMIN -> "17.5897611"
 Parameter: YMAX -> "-9.6708055"
 Parameter: YMIN -> "-16.6708055"
 Parameter: ZMAX -> "-53.5264607"
 Parameter: ZMIN -> "-60.5264607"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "53" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "53" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "53"
 Parameter: NPOS -> "25"
Evaluating: 53-25
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.950414426"
Evaluating: 62.3546605*(0.950414426-0.5)
 Parameter: XPOS <- "28.0854386"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.127585616"
Evaluating: 62.3546605*(0.127585616-0.5)
 Parameter: YPOS <- "-23.2217725"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.506225733"
Evaluating: 125.033241*(0.506225733-0.5)+-2.9500243
 Parameter: ZPOS <- "-2.17160073"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.17160073" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.17160073" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "53" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "53"
 Parameter: NPOS -> "25"
Evaluating: 53-25
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.848861302"
Evaluating: 62.3546605*(0.848861302-0.5)
 Parameter: XPOS <- "21.753128"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.991218583"
Evaluating: 62.3546605*(0.991218583-0.5)
 Parameter: YPOS <- "30.629768"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.808146018"
Evaluating: 125.033241*(0.808146018-0.5)+-2.9500243
 Parameter: ZPOS <- "35.578471"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.578471" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.578471" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.753128"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.753128-0
 Parameter: XTRAN <- "21.753128"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.629768"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.629768-0
 Parameter: YTRAN <- "30.629768"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.578471"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.578471-0
 Parameter: ZTRAN <- "35.578471"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.753128"
 Parameter: YTRAN -> "30.629768"
 Parameter: ZTRAN -> "35.578471"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    21.753128   30.629768   35.578471
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.922248348"
Evaluating: 0.922248348*360.0
 Parameter: XPHI <- "332.009405"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882075767"
Evaluating: 0.882075767*360.0
 Parameter: YPHI <- "317.547276"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540563477"
Evaluating: 0.540563477*360.0
 Parameter: ZPHI <- "194.602852"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.753128"
 Parameter: YPOS -> "30.629768"
 Parameter: ZPOS -> "35.578471"
 Parameter: XPHI -> "332.009405"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.883025   -0.469327
    0.000000    0.469327    0.883025

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.753128"
 Parameter: YPOS -> "30.629768"
 Parameter: ZPOS -> "35.578471"
 Parameter: YPHI -> "317.547276"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.737835    0.000000    0.674982
    0.000000    1.000000    0.000000
   -0.674982    0.000000    0.737835

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.753128"
 Parameter: YPOS -> "30.629768"
 Parameter: ZPOS -> "35.578471"
 Parameter: ZPHI -> "194.602852"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.967697   -0.252118    0.000000
    0.252118   -0.967697    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.753128 XMAX =   21.753128 XAVE =   21.753128
    YMIN =   30.629768 YMAX =   30.629768 YAVE =   30.629768
    ZMIN =   35.578471 ZMAX =   35.578471 ZAVE =   35.578471
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.753128"
Evaluating: 21.753128+3.5
 Parameter: XMAX <- "25.253128"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.629768"
Evaluating: 30.629768+3.5
 Parameter: YMAX <- "34.129768"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.578471"
Evaluating: 35.578471+3.5
 Parameter: ZMAX <- "39.078471"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.753128"
Evaluating: 21.753128-3.5
 Parameter: XMIN <- "18.253128"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.629768"
Evaluating: 30.629768-3.5
 Parameter: YMIN <- "27.129768"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.578471"
Evaluating: 35.578471-3.5
 Parameter: ZMIN <- "32.078471"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.253128"
 Parameter: XMIN -> "18.253128"
 Parameter: YMAX -> "34.129768"
 Parameter: YMIN -> "27.129768"
 Parameter: ZMAX -> "39.078471"
 Parameter: ZMIN -> "32.078471"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "54" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "54" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "54"
 Parameter: NPOS -> "25"
Evaluating: 54-25
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.938732231"
Evaluating: 62.3546605*(0.938732231-0.5)
 Parameter: XPOS <- "27.3569993"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.941942528"
Evaluating: 62.3546605*(0.941942528-0.5)
 Parameter: YPOS <- "27.5571763"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.902523314"
Evaluating: 125.033241*(0.902523314-0.5)+-2.9500243
 Parameter: ZPOS <- "47.3787702"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.3787702" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.3787702" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.3569993"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.3569993-0
 Parameter: XTRAN <- "27.3569993"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.5571763"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.5571763-0
 Parameter: YTRAN <- "27.5571763"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.3787702"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.3787702-0
 Parameter: ZTRAN <- "47.3787702"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.3569993"
 Parameter: YTRAN -> "27.5571763"
 Parameter: ZTRAN -> "47.3787702"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    27.356999   27.557176   47.378770
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.018109294E-02"
Evaluating: 8.018109294E-02*360.0
 Parameter: XPHI <- "28.8651935"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.847524224"
Evaluating: 0.847524224*360.0
 Parameter: YPHI <- "305.108721"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592622443"
Evaluating: 0.592622443*360.0
 Parameter: ZPHI <- "213.344079"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.3569993"
 Parameter: YPOS -> "27.5571763"
 Parameter: ZPOS -> "47.3787702"
 Parameter: XPHI -> "28.8651935"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.875758    0.482750
    0.000000   -0.482750    0.875758

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.3569993"
 Parameter: YPOS -> "27.5571763"
 Parameter: ZPOS -> "47.3787702"
 Parameter: YPHI -> "305.108721"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.575130    0.000000    0.818062
    0.000000    1.000000    0.000000
   -0.818062    0.000000    0.575130

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.3569993"
 Parameter: YPOS -> "27.5571763"
 Parameter: ZPOS -> "47.3787702"
 Parameter: ZPHI -> "213.344079"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.835385   -0.549666    0.000000
    0.549666   -0.835385    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.356999 XMAX =   27.356999 XAVE =   27.356999
    YMIN =   27.557176 YMAX =   27.557176 YAVE =   27.557176
    ZMIN =   47.378770 ZMAX =   47.378770 ZAVE =   47.378770
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.3569993"
Evaluating: 27.3569993+3.5
 Parameter: XMAX <- "30.8569993"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.5571763"
Evaluating: 27.5571763+3.5
 Parameter: YMAX <- "31.0571763"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.3787702"
Evaluating: 47.3787702+3.5
 Parameter: ZMAX <- "50.8787702"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.3569993"
Evaluating: 27.3569993-3.5
 Parameter: XMIN <- "23.8569993"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.5571763"
Evaluating: 27.5571763-3.5
 Parameter: YMIN <- "24.0571763"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.3787702"
Evaluating: 47.3787702-3.5
 Parameter: ZMIN <- "43.8787702"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.8569993"
 Parameter: XMIN -> "23.8569993"
 Parameter: YMAX -> "31.0571763"
 Parameter: YMIN -> "24.0571763"
 Parameter: ZMAX -> "50.8787702"
 Parameter: ZMIN -> "43.8787702"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "55" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "55" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "25"
Evaluating: 55-25
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.709658929"
Evaluating: 62.3546605*(0.709658929-0.5)
 Parameter: XPOS <- "13.0732113"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.630480633"
Evaluating: 62.3546605*(0.630480633-0.5)
 Parameter: YPOS <- "8.13607557"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.982033272"
Evaluating: 125.033241*(0.982033272-0.5)+-2.9500243
 Parameter: ZPOS <- "57.320158"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.320158" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.320158" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0732113"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.0732113-0
 Parameter: XTRAN <- "13.0732113"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.13607557"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.13607557-0
 Parameter: YTRAN <- "8.13607557"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.320158"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.320158-0
 Parameter: ZTRAN <- "57.320158"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.0732113"
 Parameter: YTRAN -> "8.13607557"
 Parameter: ZTRAN -> "57.320158"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    13.073211    8.136076   57.320158
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.916844379"
Evaluating: 0.916844379*360.0
 Parameter: XPHI <- "330.063976"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973460505"
Evaluating: 0.973460505*360.0
 Parameter: YPHI <- "350.445782"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.719047812E-02"
Evaluating: 1.719047812E-02*360.0
 Parameter: ZPHI <- "6.18857212"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0732113"
 Parameter: YPOS -> "8.13607557"
 Parameter: ZPOS -> "57.320158"
 Parameter: XPHI -> "330.063976"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.866583   -0.499033
    0.000000    0.499033    0.866583

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0732113"
 Parameter: YPOS -> "8.13607557"
 Parameter: ZPOS -> "57.320158"
 Parameter: YPHI -> "350.445782"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.986129    0.000000    0.165981
    0.000000    1.000000    0.000000
   -0.165981    0.000000    0.986129

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0732113"
 Parameter: YPOS -> "8.13607557"
 Parameter: ZPOS -> "57.320158"
 Parameter: ZPHI -> "6.18857212"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.994172    0.107801    0.000000
   -0.107801    0.994172    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.073211 XMAX =   13.073211 XAVE =   13.073211
    YMIN =    8.136076 YMAX =    8.136076 YAVE =    8.136076
    ZMIN =   57.320158 ZMAX =   57.320158 ZAVE =   57.320158
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0732113"
Evaluating: 13.0732113+3.5
 Parameter: XMAX <- "16.5732113"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.13607557"
Evaluating: 8.13607557+3.5
 Parameter: YMAX <- "11.6360756"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.320158"
Evaluating: 57.320158+3.5
 Parameter: ZMAX <- "60.820158"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0732113"
Evaluating: 13.0732113-3.5
 Parameter: XMIN <- "9.5732113"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.13607557"
Evaluating: 8.13607557-3.5
 Parameter: YMIN <- "4.63607557"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.320158"
Evaluating: 57.320158-3.5
 Parameter: ZMIN <- "53.820158"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5732113"
 Parameter: XMIN -> "9.5732113"
 Parameter: YMAX -> "11.6360756"
 Parameter: YMIN -> "4.63607557"
 Parameter: ZMAX -> "60.820158"
 Parameter: ZMIN -> "53.820158"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "56" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "56" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "25"
Evaluating: 56-25
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.619905563"
Evaluating: 62.3546605*(0.619905563-0.5)
 Parameter: XPOS <- "7.47667067"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.713167524"
Evaluating: 62.3546605*(0.713167524-0.5)
 Parameter: YPOS <- "13.2919886"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "3.515512432E-02"
Evaluating: 125.033241*(3.515512432E-02-0.5)+-2.9500243
 Parameter: ZPOS <- "-61.0710857"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.0710857" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.47667067"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.47667067-0
 Parameter: XTRAN <- "7.47667067"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.2919886"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.2919886-0
 Parameter: YTRAN <- "13.2919886"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.0710857"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.0710857-0
 Parameter: ZTRAN <- "-61.0710857"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.47667067"
 Parameter: YTRAN -> "13.2919886"
 Parameter: ZTRAN -> "-61.0710857"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     7.476671   13.291989  -61.071086
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.184249091"
Evaluating: 0.184249091*360.0
 Parameter: XPHI <- "66.3296728"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.856730746"
Evaluating: 0.856730746*360.0
 Parameter: YPHI <- "308.423069"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.241940237"
Evaluating: 0.241940237*360.0
 Parameter: ZPHI <- "87.0984853"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.47667067"
 Parameter: YPOS -> "13.2919886"
 Parameter: ZPOS -> "-61.0710857"
 Parameter: XPHI -> "66.3296728"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.401474    0.915871
    0.000000   -0.915871    0.401474

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.47667067"
 Parameter: YPOS -> "13.2919886"
 Parameter: ZPOS -> "-61.0710857"
 Parameter: YPHI -> "308.423069"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.621463    0.000000    0.783443
    0.000000    1.000000    0.000000
   -0.783443    0.000000    0.621463

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   51.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.47667067"
 Parameter: YPOS -> "13.2919886"
 Parameter: ZPOS -> "-61.0710857"
 Parameter: ZPHI -> "87.0984853"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.050619    0.998718    0.000000
   -0.998718    0.050619    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   87.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.476671 XMAX =    7.476671 XAVE =    7.476671
    YMIN =   13.291989 YMAX =   13.291989 YAVE =   13.291989
    ZMIN =  -61.071086 ZMAX =  -61.071086 ZAVE =  -61.071086
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.47667067"
Evaluating: 7.47667067+3.5
 Parameter: XMAX <- "10.9766707"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.2919886"
Evaluating: 13.2919886+3.5
 Parameter: YMAX <- "16.7919886"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.0710857"
Evaluating: -61.0710857+3.5
 Parameter: ZMAX <- "-57.5710857"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.47667067"
Evaluating: 7.47667067-3.5
 Parameter: XMIN <- "3.97667067"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.2919886"
Evaluating: 13.2919886-3.5
 Parameter: YMIN <- "9.7919886"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.0710857"
Evaluating: -61.0710857-3.5
 Parameter: ZMIN <- "-64.5710857"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.9766707"
 Parameter: XMIN -> "3.97667067"
 Parameter: YMAX -> "16.7919886"
 Parameter: YMIN -> "9.7919886"
 Parameter: ZMAX -> "-57.5710857"
 Parameter: ZMIN -> "-64.5710857"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "57" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "57" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "57"
 Parameter: NPOS -> "25"
Evaluating: 57-25
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.27038762"
Evaluating: 62.3546605*(0.27038762-0.5)
 Parameter: XPOS <- "-14.317402"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.998894651"
Evaluating: 62.3546605*(0.998894651-0.5)
 Parameter: YPOS <- "31.1084066"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.522803065"
Evaluating: 125.033241*(0.522803065-0.5)+-2.9500243
 Parameter: ZPOS <- "-9.888317832E-02"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.888317832E-02" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.888317832E-02" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "57" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "57"
 Parameter: NPOS -> "25"
Evaluating: 57-25
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.515298224"
Evaluating: 62.3546605*(0.515298224-0.5)
 Parameter: XPOS <- "0.953915564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.577203047"
Evaluating: 62.3546605*(0.577203047-0.5)
 Parameter: YPOS <- "4.81396979"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.971003401"
Evaluating: 125.033241*(0.971003401-0.5)+-2.9500243
 Parameter: ZPOS <- "55.9410574"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.9410574" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.9410574" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.953915564"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.953915564-0
 Parameter: XTRAN <- "0.953915564"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.81396979"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.81396979-0
 Parameter: YTRAN <- "4.81396979"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.9410574"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 55.9410574-0
 Parameter: ZTRAN <- "55.9410574"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.953915564"
 Parameter: YTRAN -> "4.81396979"
 Parameter: ZTRAN -> "55.9410574"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     0.953916    4.813970   55.941057
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.963377792"
Evaluating: 0.963377792*360.0
 Parameter: XPHI <- "346.816005"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666184675"
Evaluating: 0.666184675*360.0
 Parameter: YPHI <- "239.826483"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.83882846E-02"
Evaluating: 7.83882846E-02*360.0
 Parameter: ZPHI <- "28.2197825"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.953915564"
 Parameter: YPOS -> "4.81396979"
 Parameter: ZPOS -> "55.9410574"
 Parameter: XPHI -> "346.816005"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.973643   -0.228079
    0.000000    0.228079    0.973643

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.953915564"
 Parameter: YPOS -> "4.81396979"
 Parameter: ZPOS -> "55.9410574"
 Parameter: YPHI -> "239.826483"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.502620    0.000000    0.864507
    0.000000    1.000000    0.000000
   -0.864507    0.000000   -0.502620

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.953915564"
 Parameter: YPOS -> "4.81396979"
 Parameter: ZPOS -> "55.9410574"
 Parameter: ZPHI -> "28.2197825"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.881140    0.472855    0.000000
   -0.472855    0.881140    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   28.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.953916 XMAX =    0.953916 XAVE =    0.953916
    YMIN =    4.813970 YMAX =    4.813970 YAVE =    4.813970
    ZMIN =   55.941057 ZMAX =   55.941057 ZAVE =   55.941057
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.953915564"
Evaluating: 0.953915564+3.5
 Parameter: XMAX <- "4.45391556"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.81396979"
Evaluating: 4.81396979+3.5
 Parameter: YMAX <- "8.31396979"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.9410574"
Evaluating: 55.9410574+3.5
 Parameter: ZMAX <- "59.4410574"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.953915564"
Evaluating: 0.953915564-3.5
 Parameter: XMIN <- "-2.54608444"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.81396979"
Evaluating: 4.81396979-3.5
 Parameter: YMIN <- "1.31396979"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.9410574"
Evaluating: 55.9410574-3.5
 Parameter: ZMIN <- "52.4410574"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.45391556"
 Parameter: XMIN -> "-2.54608444"
 Parameter: YMAX -> "8.31396979"
 Parameter: YMIN -> "1.31396979"
 Parameter: ZMAX -> "59.4410574"
 Parameter: ZMIN -> "52.4410574"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "58" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "58" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "25"
Evaluating: 58-25
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.201036258"
Evaluating: 62.3546605*(0.201036258-0.5)
 Parameter: XPOS <- "-18.6417826"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.792803057"
Evaluating: 62.3546605*(0.792803057-0.5)
 Parameter: YPOS <- "18.2576352"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.40244477"
Evaluating: 125.033241*(0.40244477-0.5)+-2.9500243
 Parameter: ZPOS <- "-15.1476709"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.1476709" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.6417826"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.6417826-0
 Parameter: XTRAN <- "-18.6417826"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.2576352"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.2576352-0
 Parameter: YTRAN <- "18.2576352"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.1476709"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.1476709-0
 Parameter: ZTRAN <- "-15.1476709"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.6417826"
 Parameter: YTRAN -> "18.2576352"
 Parameter: ZTRAN -> "-15.1476709"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -18.641783   18.257635  -15.147671
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112994799"
Evaluating: 0.112994799*360.0
 Parameter: XPHI <- "40.6781276"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111912662"
Evaluating: 0.111912662*360.0
 Parameter: YPHI <- "40.2885583"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137611549"
Evaluating: 0.137611549*360.0
 Parameter: ZPHI <- "49.5401576"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.6417826"
 Parameter: YPOS -> "18.2576352"
 Parameter: ZPOS -> "-15.1476709"
 Parameter: XPHI -> "40.6781276"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.758383    0.651809
    0.000000   -0.651809    0.758383

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.6417826"
 Parameter: YPOS -> "18.2576352"
 Parameter: ZPOS -> "-15.1476709"
 Parameter: YPHI -> "40.2885583"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.762797    0.000000   -0.646637
    0.000000    1.000000    0.000000
    0.646637    0.000000    0.762797

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.6417826"
 Parameter: YPOS -> "18.2576352"
 Parameter: ZPOS -> "-15.1476709"
 Parameter: ZPHI -> "49.5401576"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.648915    0.760861    0.000000
   -0.760861    0.648915    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.641783 XMAX =  -18.641783 XAVE =  -18.641783
    YMIN =   18.257635 YMAX =   18.257635 YAVE =   18.257635
    ZMIN =  -15.147671 ZMAX =  -15.147671 ZAVE =  -15.147671
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.6417826"
Evaluating: -18.6417826+3.5
 Parameter: XMAX <- "-15.1417826"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.2576352"
Evaluating: 18.2576352+3.5
 Parameter: YMAX <- "21.7576352"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.1476709"
Evaluating: -15.1476709+3.5
 Parameter: ZMAX <- "-11.6476709"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.6417826"
Evaluating: -18.6417826-3.5
 Parameter: XMIN <- "-22.1417826"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.2576352"
Evaluating: 18.2576352-3.5
 Parameter: YMIN <- "14.7576352"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.1476709"
Evaluating: -15.1476709-3.5
 Parameter: ZMIN <- "-18.6476709"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.1417826"
 Parameter: XMIN -> "-22.1417826"
 Parameter: YMAX -> "21.7576352"
 Parameter: YMIN -> "14.7576352"
 Parameter: ZMAX -> "-11.6476709"
 Parameter: ZMIN -> "-18.6476709"
 SELRPN>     20 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>     10 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15611 NEG      CLA      33       CLA     -**** MEMB     POPC     44       O13           2.8660
15611 NEG      CLA      33       CLA     -**** MEMB     POPC     73       C23           3.7593
15611 NEG      CLA      33       CLA     -**** MEMB     POPC     73       C24           3.2934
15611 NEG      CLA      33       CLA     -**** MEMB     POPC     73       C25           2.4748
15611 NEG      CLA      33       CLA     -**** MEMB     POPC     73       C26           2.4260
15611 NEG      CLA      33       CLA     -**** MEMB     POPC     73       C27           3.9947
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "58" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "25"
Evaluating: 58-25
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.507128852"
Evaluating: 62.3546605*(0.507128852-0.5)
 Parameter: XPOS <- "0.444517146"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.875677701"
Evaluating: 62.3546605*(0.875677701-0.5)
 Parameter: YPOS <- "23.4252555"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.929859833"
Evaluating: 125.033241*(0.929859833-0.5)+-2.9500243
 Parameter: ZPOS <- "50.7967438"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.7967438" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.7967438" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.641783 XMAX =  -18.641783 XAVE =  -18.641783
    YMIN =   18.257635 YMAX =   18.257635 YAVE =   18.257635
    ZMIN =  -15.147671 ZMAX =  -15.147671 ZAVE =  -15.147671
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.444517146"
 RDCMND substituted energy or value "?XAVE" to "-18.6417826"
Evaluating: 0.444517146--18.6417826
 Parameter: XTRAN <- "19.0862997"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.4252555"
 RDCMND substituted energy or value "?YAVE" to "18.2576352"
Evaluating: 23.4252555-18.2576352
 Parameter: YTRAN <- "5.1676203"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.7967438"
 RDCMND substituted energy or value "?ZAVE" to "-15.1476709"
Evaluating: 50.7967438--15.1476709
 Parameter: ZTRAN <- "65.9444147"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.0862997"
 Parameter: YTRAN -> "5.1676203"
 Parameter: ZTRAN -> "65.9444147"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    19.086300    5.167620   65.944415
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670353466"
Evaluating: 0.670353466*360.0
 Parameter: XPHI <- "241.327248"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.596147975E-02"
Evaluating: 9.596147975E-02*360.0
 Parameter: YPHI <- "34.5461327"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.151092721"
Evaluating: 0.151092721*360.0
 Parameter: ZPHI <- "54.3933796"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.444517146"
 Parameter: YPOS -> "23.4252555"
 Parameter: ZPOS -> "50.7967438"
 Parameter: XPHI -> "241.327248"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.479806   -0.877374
    0.000000    0.877374   -0.479806

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.444517146"
 Parameter: YPOS -> "23.4252555"
 Parameter: ZPOS -> "50.7967438"
 Parameter: YPHI -> "34.5461327"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.823670    0.000000   -0.567070
    0.000000    1.000000    0.000000
    0.567070    0.000000    0.823670

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   34.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.444517146"
 Parameter: YPOS -> "23.4252555"
 Parameter: ZPOS -> "50.7967438"
 Parameter: ZPHI -> "54.3933796"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.582217    0.813033    0.000000
   -0.813033    0.582217    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   54.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.444517 XMAX =    0.444517 XAVE =    0.444517
    YMIN =   23.425256 YMAX =   23.425256 YAVE =   23.425256
    ZMIN =   50.796744 ZMAX =   50.796744 ZAVE =   50.796744
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.444517124"
Evaluating: 0.444517124+3.5
 Parameter: XMAX <- "3.94451712"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.4252555"
Evaluating: 23.4252555+3.5
 Parameter: YMAX <- "26.9252555"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.7967438"
Evaluating: 50.7967438+3.5
 Parameter: ZMAX <- "54.2967438"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.444517124"
Evaluating: 0.444517124-3.5
 Parameter: XMIN <- "-3.05548288"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.4252555"
Evaluating: 23.4252555-3.5
 Parameter: YMIN <- "19.9252555"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.7967438"
Evaluating: 50.7967438-3.5
 Parameter: ZMIN <- "47.2967438"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.94451712"
 Parameter: XMIN -> "-3.05548288"
 Parameter: YMAX -> "26.9252555"
 Parameter: YMIN -> "19.9252555"
 Parameter: ZMAX -> "54.2967438"
 Parameter: ZMIN -> "47.2967438"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "59" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "59" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "59"
 Parameter: NPOS -> "25"
Evaluating: 59-25
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.701193646"
Evaluating: 62.3546605*(0.701193646-0.5)
 Parameter: XPOS <- "12.5453615"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.783432884"
Evaluating: 62.3546605*(0.783432884-0.5)
 Parameter: YPOS <- "17.6733613"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.914801656"
Evaluating: 125.033241*(0.914801656-0.5)+-2.9500243
 Parameter: ZPOS <- "48.9139711"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.9139711" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.9139711" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.5453615"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.5453615-0
 Parameter: XTRAN <- "12.5453615"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.6733613"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.6733613-0
 Parameter: YTRAN <- "17.6733613"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.9139711"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.9139711-0
 Parameter: ZTRAN <- "48.9139711"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.5453615"
 Parameter: YTRAN -> "17.6733613"
 Parameter: ZTRAN -> "48.9139711"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    12.545362   17.673361   48.913971
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977917812"
Evaluating: 0.977917812*360.0
 Parameter: XPHI <- "352.050412"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.269350999E-02"
Evaluating: 3.269350999E-02*360.0
 Parameter: YPHI <- "11.7696636"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956285722"
Evaluating: 0.956285722*360.0
 Parameter: ZPHI <- "344.26286"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.5453615"
 Parameter: YPOS -> "17.6733613"
 Parameter: ZPOS -> "48.9139711"
 Parameter: XPHI -> "352.050412"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.990390   -0.138302
    0.000000    0.138302    0.990390

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    7.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.5453615"
 Parameter: YPOS -> "17.6733613"
 Parameter: ZPOS -> "48.9139711"
 Parameter: YPHI -> "11.7696636"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.978976    0.000000   -0.203978
    0.000000    1.000000    0.000000
    0.203978    0.000000    0.978976

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.5453615"
 Parameter: YPOS -> "17.6733613"
 Parameter: ZPOS -> "48.9139711"
 Parameter: ZPHI -> "344.26286"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.962516   -0.271224    0.000000
    0.271224    0.962516    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.545362 XMAX =   12.545362 XAVE =   12.545362
    YMIN =   17.673361 YMAX =   17.673361 YAVE =   17.673361
    ZMIN =   48.913971 ZMAX =   48.913971 ZAVE =   48.913971
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.5453615"
Evaluating: 12.5453615+3.5
 Parameter: XMAX <- "16.0453615"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.6733613"
Evaluating: 17.6733613+3.5
 Parameter: YMAX <- "21.1733613"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.9139711"
Evaluating: 48.9139711+3.5
 Parameter: ZMAX <- "52.4139711"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.5453615"
Evaluating: 12.5453615-3.5
 Parameter: XMIN <- "9.0453615"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.6733613"
Evaluating: 17.6733613-3.5
 Parameter: YMIN <- "14.1733613"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.9139711"
Evaluating: 48.9139711-3.5
 Parameter: ZMIN <- "45.4139711"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.0453615"
 Parameter: XMIN -> "9.0453615"
 Parameter: YMAX -> "21.1733613"
 Parameter: YMIN -> "14.1733613"
 Parameter: ZMAX -> "52.4139711"
 Parameter: ZMIN -> "45.4139711"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "60" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "60" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "25"
Evaluating: 60-25
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.265533095"
Evaluating: 62.3546605*(0.265533095-0.5)
 Parameter: XPOS <- "-14.6201043"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.127338366"
Evaluating: 62.3546605*(0.127338366-0.5)
 Parameter: YPOS <- "-23.2371897"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.890166225"
Evaluating: 125.033241*(0.890166225-0.5)+-2.9500243
 Parameter: ZPOS <- "45.8337233"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.8337233" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.8337233" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.6201043"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.6201043-0
 Parameter: XTRAN <- "-14.6201043"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.2371897"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.2371897-0
 Parameter: YTRAN <- "-23.2371897"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.8337233"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.8337233-0
 Parameter: ZTRAN <- "45.8337233"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.6201043"
 Parameter: YTRAN -> "-23.2371897"
 Parameter: ZTRAN -> "45.8337233"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR   -14.620104  -23.237190   45.833723
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950201956"
Evaluating: 0.950201956*360.0
 Parameter: XPHI <- "342.072704"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513402848"
Evaluating: 0.513402848*360.0
 Parameter: YPHI <- "184.825025"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.517370164"
Evaluating: 0.517370164*360.0
 Parameter: ZPHI <- "186.253259"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.6201043"
 Parameter: YPOS -> "-23.2371897"
 Parameter: ZPOS -> "45.8337233"
 Parameter: XPHI -> "342.072704"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.951448   -0.307810
    0.000000    0.307810    0.951448

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.6201043"
 Parameter: YPOS -> "-23.2371897"
 Parameter: ZPOS -> "45.8337233"
 Parameter: YPHI -> "184.825025"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.996456    0.000000    0.084113
    0.000000    1.000000    0.000000
   -0.084113    0.000000   -0.996456

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  175.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.6201043"
 Parameter: YPOS -> "-23.2371897"
 Parameter: ZPOS -> "45.8337233"
 Parameter: ZPHI -> "186.253259"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.994050   -0.108923    0.000000
    0.108923   -0.994050    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  173.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.620104 XMAX =  -14.620104 XAVE =  -14.620104
    YMIN =  -23.237190 YMAX =  -23.237190 YAVE =  -23.237190
    ZMIN =   45.833723 ZMAX =   45.833723 ZAVE =   45.833723
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.6201043"
Evaluating: -14.6201043+3.5
 Parameter: XMAX <- "-11.1201043"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.2371897"
Evaluating: -23.2371897+3.5
 Parameter: YMAX <- "-19.7371897"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.8337233"
Evaluating: 45.8337233+3.5
 Parameter: ZMAX <- "49.3337233"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.6201043"
Evaluating: -14.6201043-3.5
 Parameter: XMIN <- "-18.1201043"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.2371897"
Evaluating: -23.2371897-3.5
 Parameter: YMIN <- "-26.7371897"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.8337233"
Evaluating: 45.8337233-3.5
 Parameter: ZMIN <- "42.3337233"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.1201043"
 Parameter: XMIN -> "-18.1201043"
 Parameter: YMAX -> "-19.7371897"
 Parameter: YMIN -> "-26.7371897"
 Parameter: ZMAX -> "49.3337233"
 Parameter: ZMIN -> "42.3337233"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "61" and "61".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "61" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "25"
Evaluating: 61-25
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.926140746"
Evaluating: 62.3546605*(0.926140746-0.5)
 Parameter: XPOS <- "26.5718615"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.18753474"
Evaluating: 62.3546605*(0.18753474-0.5)
 Parameter: YPOS <- "-19.4836652"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.465501637"
Evaluating: 125.033241*(0.465501637-0.5)+-2.9500243
 Parameter: ZPOS <- "-7.26346644"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.26346644" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.26346644" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "61" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "25"
Evaluating: 61-25
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.956498226"
Evaluating: 62.3546605*(0.956498226-0.5)
 Parameter: XPOS <- "28.4647919"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.948692118"
Evaluating: 62.3546605*(0.948692118-0.5)
 Parameter: YPOS <- "27.9780447"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.599280394"
Evaluating: 125.033241*(0.599280394-0.5)+-2.9500243
 Parameter: ZPOS <- "9.46332513"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.46332513" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.46332513" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "61" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "25"
Evaluating: 61-25
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "5.936188546E-03"
Evaluating: 62.3546605*(5.936188546E-03-0.5)
 Parameter: XPOS <- "-30.8071812"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.294920663"
Evaluating: 62.3546605*(0.294920663-0.5)
 Parameter: YPOS <- "-12.7876524"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.610620298"
Evaluating: 125.033241*(0.610620298-0.5)+-2.9500243
 Parameter: ZPOS <- "10.8811901"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.8811901" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.8811901" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "61" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "25"
Evaluating: 61-25
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.703705822"
Evaluating: 62.3546605*(0.703705822-0.5)
 Parameter: XPOS <- "12.7020074"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.369597753"
Evaluating: 62.3546605*(0.369597753-0.5)
 Parameter: YPOS <- "-8.13118784"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.446276619"
Evaluating: 125.033241*(0.446276619-0.5)+-2.9500243
 Parameter: ZPOS <- "-9.66723274"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.66723274" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.66723274" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "61" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "25"
Evaluating: 61-25
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.724691287"
Evaluating: 62.3546605*(0.724691287-0.5)
 Parameter: XPOS <- "14.0105489"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.498052624"
Evaluating: 62.3546605*(0.498052624-0.5)
 Parameter: YPOS <- "-0.121427969"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.684886156"
Evaluating: 125.033241*(0.684886156-0.5)+-2.9500243
 Parameter: ZPOS <- "20.166891"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.166891" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.166891" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.0105489"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.0105489-0
 Parameter: XTRAN <- "14.0105489"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.121427969"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.121427969-0
 Parameter: YTRAN <- "-0.121427969"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.166891"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.166891-0
 Parameter: ZTRAN <- "20.166891"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.0105489"
 Parameter: YTRAN -> "-0.121427969"
 Parameter: ZTRAN -> "20.166891"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR    14.010549   -0.121428   20.166891
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.411832953"
Evaluating: 0.411832953*360.0
 Parameter: XPHI <- "148.259863"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866135771"
Evaluating: 0.866135771*360.0
 Parameter: YPHI <- "311.808878"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.725645814"
Evaluating: 0.725645814*360.0
 Parameter: ZPHI <- "261.232493"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.0105489"
 Parameter: YPOS -> "-0.121427969"
 Parameter: ZPOS -> "20.166891"
 Parameter: XPHI -> "148.259863"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.850443    0.526068
    0.000000   -0.526068   -0.850443

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.0105489"
 Parameter: YPOS -> "-0.121427969"
 Parameter: ZPOS -> "20.166891"
 Parameter: YPHI -> "311.808878"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.666648    0.000000    0.745373
    0.000000    1.000000    0.000000
   -0.745373    0.000000    0.666648

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.0105489"
 Parameter: YPOS -> "-0.121427969"
 Parameter: ZPOS -> "20.166891"
 Parameter: ZPHI -> "261.232493"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.152425   -0.988315    0.000000
    0.988315   -0.152425    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.010549 XMAX =   14.010549 XAVE =   14.010549
    YMIN =   -0.121428 YMAX =   -0.121428 YAVE =   -0.121428
    ZMIN =   20.166891 ZMAX =   20.166891 ZAVE =   20.166891
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.0105489"
Evaluating: 14.0105489+3.5
 Parameter: XMAX <- "17.5105489"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.121427969"
Evaluating: -0.121427969+3.5
 Parameter: YMAX <- "3.37857203"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.166891"
Evaluating: 20.166891+3.5
 Parameter: ZMAX <- "23.666891"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.0105489"
Evaluating: 14.0105489-3.5
 Parameter: XMIN <- "10.5105489"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.121427969"
Evaluating: -0.121427969-3.5
 Parameter: YMIN <- "-3.62142797"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.166891"
Evaluating: 20.166891-3.5
 Parameter: ZMIN <- "16.666891"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.5105489"
 Parameter: XMIN -> "10.5105489"
 Parameter: YMAX -> "3.37857203"
 Parameter: YMIN -> "-3.62142797"
 Parameter: ZMAX -> "23.666891"
 Parameter: ZMIN -> "16.666891"
 SELRPN>      5 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      2 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
15614 NEG      CLA      36       CLA     -2642 PROA     ASN      175      CG            3.4386
15614 NEG      CLA      36       CLA     -2644 PROA     ASN      175      ND2           2.6685
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "25"
 Comparing "61" and "25".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "25"
Evaluating: 61-25
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "0.813136502"
Evaluating: 62.3546605*(0.813136502-0.5)
 Parameter: XPOS <- "19.5255203"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "62.3546605"
 RDCMND substituted energy or value "?RANDOM" to "9.004753938E-02"
Evaluating: 62.3546605*(9.004753938E-02-0.5)
 Parameter: YPOS <- "-25.5624465"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "125.033241"
 Parameter: ZCEN -> "-2.9500243"
 RDCMND substituted energy or value "?RANDOM" to "0.773997088"
Evaluating: 125.033241*(0.773997088-0.5)+-2.9500243
 Parameter: ZPOS <- "31.3087196"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.3087196" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.3087196" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.010549 XMAX =   14.010549 XAVE =   14.010549
    YMIN =   -0.121428 YMAX =   -0.121428 YAVE =   -0.121428
    ZMIN =   20.166891 ZMAX =   20.166891 ZAVE =   20.166891
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.5255203"
 RDCMND substituted energy or value "?XAVE" to "14.0105489"
Evaluating: 19.5255203-14.0105489
 Parameter: XTRAN <- "5.5149714"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.5624465"
 RDCMND substituted energy or value "?YAVE" to "-0.121427969"
Evaluating: -25.5624465--0.121427969
 Parameter: YTRAN <- "-25.4410185"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.3087196"
 RDCMND substituted energy or value "?ZAVE" to "20.166891"
Evaluating: 31.3087196-20.166891
 Parameter: ZTRAN <- "11.1418286"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.5149714"
 Parameter: YTRAN -> "-25.4410185"
 Parameter: ZTRAN -> "11.1418286"
 SELRPN>      1 atoms have been selected out of  15614
 TRANSLATION VECTOR     5.514971  -25.441018   11.141829
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.385819876"
Evaluating: 0.385819876*360.0
 Parameter: XPHI <- "138.895155"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.330920888E-02"
Evaluating: 7.330920888E-02*360.0
 Parameter: YPHI <- "26.3913152"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.493632661"
Evaluating: 0.493632661*360.0
 Parameter: ZPHI <- "177.707758"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.5255203"
 Parameter: YPOS -> "-25.5624465"
 Parameter: ZPOS -> "31.3087196"
 Parameter: XPHI -> "138.895155"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.753508    0.657439
    0.000000   -0.657439   -0.753508

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.5255203"
 Parameter: YPOS -> "-25.5624465"
 Parameter: ZPOS -> "31.3087196"
 Parameter: YPHI -> "26.3913152"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
    0.895779    0.000000   -0.444499
    0.000000    1.000000    0.000000
    0.444499    0.000000    0.895779

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   26.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.5255203"
 Parameter: YPOS -> "-25.5624465"
 Parameter: ZPOS -> "31.3087196"
 Parameter: ZPHI -> "177.707758"
 SELRPN>      1 atoms have been selected out of  15614
 ROTATION MATRIX
   -0.999200    0.039996    0.000000
   -0.039996   -0.999200    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  177.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  15614
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.525520 XMAX =   19.525520 XAVE =   19.525520
    YMIN =  -25.562446 YMAX =  -25.562446 YAVE =  -25.562446
    ZMIN =   31.308720 ZMAX =   31.308720 ZAVE =   31.308720
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.5255203"
Evaluating: 19.5255203+3.5
 Parameter: XMAX <- "23.0255203"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.5624465"
Evaluating: -25.5624465+3.5
 Parameter: YMAX <- "-22.0624465"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.3087196"
Evaluating: 31.3087196+3.5
 Parameter: ZMAX <- "34.8087196"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.5255203"
Evaluating: 19.5255203-3.5
 Parameter: XMIN <- "16.0255203"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.5624465"
Evaluating: -25.5624465-3.5
 Parameter: YMIN <- "-29.0624465"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.3087196"
Evaluating: 31.3087196-3.5
 Parameter: ZMIN <- "27.8087196"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.0255203"
 Parameter: XMIN -> "16.0255203"
 Parameter: YMAX -> "-22.0624465"
 Parameter: YMIN -> "-29.0624465"
 Parameter: ZMAX -> "34.8087196"
 Parameter: ZMIN -> "27.8087196"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4833 atoms have been selected out of  15614
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4833"
 Comparing "4833" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  24643
 SELRPN>      0 atoms have been selected out of  24643

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "61"
 Comparing "62" and "61".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "POT"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "25"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "36"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     25 atoms have been selected out of  15614
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "15554"
 Parameter: POSAT <- "15554"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     36 atoms have been selected out of  15614
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "15579"
 Parameter: NEGAT <- "15579"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "15579" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "15579"
 Comparing "15554" and "15579".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  15614
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     25 atoms have been selected out of  15614
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "25"
 Parameter: NPOSATOMS <- "25"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     36 atoms have been selected out of  15614
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "36"
 Parameter: NNEGATOMS <- "36"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     25 atoms have been selected out of  15614
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     25 atoms have been selected out of  15614
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "25"
 Parameter: NIONATOMS <- "25"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "25" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "36" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      446
         Number of atoms         =    15614   Number of groups     =     4267
         Number of bonds         =    15532   Number of angles     =    29337
         Number of dihedrals     =    41440   Number of impropers  =      953
         Number of cross-terms   =      303   Number of autogens   =        0
         Number of HB acceptors  =      398   Number of HB donors  =      500
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON DEC, 04. 2024. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:    12/ 4/24     17:55: 8      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 15553 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-1.634248292E-13"
Evaluating: -1.634248292E-13
 Parameter: CGTOTINIT <- "-1.634248292E-13"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-1.634248292E-13"
Evaluating: INT(-1.634248292E-13)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-1.634248292E-13"
Evaluating: ABS(0--1.634248292E-13)
 Parameter: CGDIFF <- "1.634248292E-13"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "1.634248292E-13" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  15553 atoms have been selected out of  15614

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        385 residues deleted.

 Message from MAPIC:          2 segments deleted.
 DELTIC:     15532 bonds deleted
 DELTIC:     29337 angles deleted
 DELTIC:     41440 dihedrals deleted
 DELTIC:       953 improper dihedrals deleted
 DELTIC:       303 crossterm maps deleted
 DELTIC:       500 donors deleted
 DELTIC:       398 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =       61
         Number of atoms         =       61   Number of groups     =       61
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  -11.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 25
 RDTITL> * SET NNEGTOT = 36
 RDTITL> * SET NIONTOT = 61
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     15.85 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    15.85  SECONDS 
                         CPU TIME:    13.84  SECONDS 
